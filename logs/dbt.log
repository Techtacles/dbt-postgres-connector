2022-10-05 03:48:19.172174 (MainThread): Running with dbt=0.21.1
2022-10-05 03:48:19.241457 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 03:48:19.243461 (MainThread): Tracking: tracking
2022-10-05 03:48:19.268950 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bac5eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bac54f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bac542b0>]}
2022-10-05 03:48:19.277953 (MainThread): Partial parsing not enabled
2022-10-05 03:48:19.287666 (MainThread): Parsing macros/catalog.sql
2022-10-05 03:48:19.290410 (MainThread): Parsing macros/relations.sql
2022-10-05 03:48:19.291482 (MainThread): Parsing macros/adapters.sql
2022-10-05 03:48:19.308391 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 03:48:19.309558 (MainThread): Parsing macros/core.sql
2022-10-05 03:48:19.312086 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 03:48:19.316898 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 03:48:19.324107 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 03:48:19.325306 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 03:48:19.337465 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 03:48:19.366466 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 03:48:19.383721 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 03:48:19.384911 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 03:48:19.392585 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 03:48:19.408375 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 03:48:19.419038 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 03:48:19.425370 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 03:48:19.431159 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 03:48:19.433772 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 03:48:19.434758 (MainThread): Parsing macros/etc/query.sql
2022-10-05 03:48:19.435378 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 03:48:19.436409 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 03:48:19.442582 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 03:48:19.443798 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 03:48:19.445421 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 03:48:19.446473 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 03:48:19.489072 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 03:48:19.490245 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 03:48:19.491003 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 03:48:19.491870 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 03:48:19.605643 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 03:48:19.613993 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 03:48:19.631857 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 03:48:19.633056 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 03:48:19.634258 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 03:48:19.635330 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 03:48:19.646055 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dfc9de5-128d-4e38-ae1a-9a83da09d356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bac5e250>]}
2022-10-05 03:48:19.648814 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 03:48:19.649081 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dfc9de5-128d-4e38-ae1a-9a83da09d356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bacd5e50>]}
2022-10-05 03:48:19.649241 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 03:48:19.650089 (MainThread): 
2022-10-05 03:48:19.650298 (MainThread): Acquiring new postgres connection "master".
2022-10-05 03:48:19.650903 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 03:48:19.657841 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 03:48:19.658015 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 03:48:19.658118 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 03:48:19.726244 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.07 seconds
2022-10-05 03:48:19.727921 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 03:48:19.728749 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 03:48:19.733477 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 03:48:19.733608 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 03:48:19.733715 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 03:48:19.743833 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 03:48:19.743956 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 03:48:19.744051 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 03:48:19.757525 (ThreadPoolExecutor-1_0): SQL status: SELECT 0 in 0.01 seconds
2022-10-05 03:48:19.758401 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 03:48:19.758721 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 03:48:19.761728 (MainThread): Using postgres connection "master".
2022-10-05 03:48:19.761858 (MainThread): On master: BEGIN
2022-10-05 03:48:19.761971 (MainThread): Opening a new connection, currently in state init
2022-10-05 03:48:19.772203 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 03:48:19.772319 (MainThread): Using postgres connection "master".
2022-10-05 03:48:19.772413 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 03:48:19.783469 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2022-10-05 03:48:19.784315 (MainThread): On master: ROLLBACK
2022-10-05 03:48:19.784673 (MainThread): Using postgres connection "master".
2022-10-05 03:48:19.784779 (MainThread): On master: BEGIN
2022-10-05 03:48:19.785199 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 03:48:19.785312 (MainThread): On master: COMMIT
2022-10-05 03:48:19.785412 (MainThread): Using postgres connection "master".
2022-10-05 03:48:19.785505 (MainThread): On master: COMMIT
2022-10-05 03:48:19.785751 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 03:48:19.785863 (MainThread): On master: Close
2022-10-05 03:48:19.786093 (MainThread): 04:48:19 | Concurrency: 5 threads (target='dev')
2022-10-05 03:48:19.786224 (MainThread): 04:48:19 | 
2022-10-05 03:48:19.788906 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 03:48:19.789176 (Thread-1): 04:48:19 | 1 of 2 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 03:48:19.789453 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 03:48:19.789597 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 03:48:19.791535 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 03:48:19.792151 (Thread-1): finished collecting timing info
2022-10-05 03:48:19.810885 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 03:48:19.811404 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 03:48:19.811500 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 03:48:19.811593 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 03:48:19.820456 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 03:48:19.820620 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 03:48:19.820716 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 03:48:19.848761 (Thread-1): SQL status: SELECT 2 in 0.03 seconds
2022-10-05 03:48:19.852720 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 03:48:19.852841 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 03:48:19.853843 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 03:48:19.860365 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 03:48:19.860470 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 03:48:19.860551 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 03:48:19.862727 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-05 03:48:19.865443 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 03:48:19.865546 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 03:48:19.865899 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 03:48:19.866671 (Thread-1): finished collecting timing info
2022-10-05 03:48:19.866792 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 03:48:19.867042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfc9de5-128d-4e38-ae1a-9a83da09d356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd898293040>]}
2022-10-05 03:48:19.867264 (Thread-1): 04:48:19 | 1 of 2 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-05 03:48:19.867374 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 03:48:19.867825 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 03:48:19.868012 (Thread-3): 04:48:19 | 2 of 2 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 03:48:19.868227 (Thread-3): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 03:48:19.868331 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 03:48:19.869694 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 03:48:19.870003 (Thread-3): finished collecting timing info
2022-10-05 03:48:19.881860 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 03:48:19.882220 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 03:48:19.882307 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 03:48:19.882392 (Thread-3): Opening a new connection, currently in state init
2022-10-05 03:48:19.890323 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-05 03:48:19.890440 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 03:48:19.890534 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 03:48:19.894365 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 03:48:19.896081 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 03:48:19.896205 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 03:48:19.897422 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 03:48:19.898212 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 03:48:19.898318 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 03:48:19.898406 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 03:48:19.899102 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-05 03:48:19.899966 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 03:48:19.900066 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 03:48:19.900326 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 03:48:19.901118 (Thread-3): finished collecting timing info
2022-10-05 03:48:19.901243 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 03:48:19.901492 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dfc9de5-128d-4e38-ae1a-9a83da09d356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8982f8fa0>]}
2022-10-05 03:48:19.901721 (Thread-3): 04:48:19 | 2 of 2 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-05 03:48:19.901841 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 03:48:19.902683 (MainThread): Acquiring new postgres connection "master".
2022-10-05 03:48:19.902879 (MainThread): Using postgres connection "master".
2022-10-05 03:48:19.902975 (MainThread): On master: BEGIN
2022-10-05 03:48:19.903067 (MainThread): Opening a new connection, currently in state closed
2022-10-05 03:48:19.912664 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 03:48:19.912858 (MainThread): On master: COMMIT
2022-10-05 03:48:19.912955 (MainThread): Using postgres connection "master".
2022-10-05 03:48:19.913042 (MainThread): On master: COMMIT
2022-10-05 03:48:19.913314 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 03:48:19.913415 (MainThread): On master: Close
2022-10-05 03:48:19.913676 (MainThread): 04:48:19 | 
2022-10-05 03:48:19.913795 (MainThread): 04:48:19 | Finished running 1 table model, 1 view model in 0.26s.
2022-10-05 03:48:19.913894 (MainThread): Connection 'master' was properly closed.
2022-10-05 03:48:19.913975 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 03:48:19.914052 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 03:48:19.917298 (MainThread): 
2022-10-05 03:48:19.917447 (MainThread): Completed successfully
2022-10-05 03:48:19.917548 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-10-05 03:48:19.917712 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bacd3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bacd3a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8bacd3520>]}
2022-10-05 03:48:19.917873 (MainThread): Flushing usage events
2022-10-05 04:14:42.910182 (MainThread): Running with dbt=0.21.1
2022-10-05 04:14:42.980528 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:14:42.981725 (MainThread): Tracking: tracking
2022-10-05 04:14:43.008742 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e92b0fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e92b06fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e92b06bb0>]}
2022-10-05 04:14:43.017507 (MainThread): Partial parsing not enabled
2022-10-05 04:14:43.027434 (MainThread): Parsing macros/create_tables.sql
2022-10-05 04:14:43.027623 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:14:43.030140 (MainThread): Parsing macros/relations.sql
2022-10-05 04:14:43.031125 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:14:43.047107 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:14:43.048232 (MainThread): Parsing macros/core.sql
2022-10-05 04:14:43.050700 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:14:43.055353 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:14:43.062076 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:14:43.063186 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:14:43.074861 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:14:43.101121 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:14:43.117439 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:14:43.118594 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:14:43.125859 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:14:43.140650 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:14:43.150791 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:14:43.156622 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:14:43.162045 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:14:43.164586 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:14:43.165537 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:14:43.166135 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:14:43.167129 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:14:43.173039 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:14:43.174209 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:14:43.175789 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:14:43.176798 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:14:43.216846 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:14:43.217925 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:14:43.218665 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:14:43.219517 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:14:43.331547 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.339782 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:14:43.357352 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:14:43.358559 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:14:43.359758 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:14:43.360819 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:14:43.370558 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14bd3d74-029a-4080-95eb-9481ba81c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e92b575e0>]}
2022-10-05 04:14:43.373365 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:14:43.374610 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14bd3d74-029a-4080-95eb-9481ba81c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e80450b80>]}
2022-10-05 04:14:43.374793 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:14:43.375658 (MainThread): 
2022-10-05 04:14:43.375876 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:14:43.376508 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:14:43.383145 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:14:43.383310 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:14:43.383411 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:14:43.432417 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.05 seconds
2022-10-05 04:14:43.433886 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:14:43.434620 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:14:43.438686 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:14:43.439081 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:14:43.439203 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:14:43.447133 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:14:43.447262 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:14:43.447359 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:14:43.452279 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:14:43.453148 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:14:43.453440 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:14:43.456221 (MainThread): Using postgres connection "master".
2022-10-05 04:14:43.456331 (MainThread): On master: BEGIN
2022-10-05 04:14:43.456431 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:14:43.466550 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:14:43.466666 (MainThread): Using postgres connection "master".
2022-10-05 04:14:43.466758 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:14:43.481322 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:14:43.482280 (MainThread): On master: ROLLBACK
2022-10-05 04:14:43.482588 (MainThread): Using postgres connection "master".
2022-10-05 04:14:43.482699 (MainThread): On master: BEGIN
2022-10-05 04:14:43.483109 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:14:43.483227 (MainThread): On master: COMMIT
2022-10-05 04:14:43.483332 (MainThread): Using postgres connection "master".
2022-10-05 04:14:43.483424 (MainThread): On master: COMMIT
2022-10-05 04:14:43.483668 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:14:43.483786 (MainThread): On master: Close
2022-10-05 04:14:43.484014 (MainThread): 05:14:43 | Concurrency: 5 threads (target='dev')
2022-10-05 04:14:43.484147 (MainThread): 05:14:43 | 
2022-10-05 04:14:43.486711 (Thread-1): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:14:43.486984 (Thread-1): 05:14:43 | 1 of 2 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:14:43.487260 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.487416 (Thread-1): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:14:43.489239 (Thread-1): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:14:43.490014 (Thread-1): finished collecting timing info
2022-10-05 04:14:43.508652 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:14:43.509089 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.509191 (Thread-1): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:14:43.509284 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:14:43.517059 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:14:43.517232 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.517322 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:14:43.521999 (Thread-1): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:14:43.526303 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.526422 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:14:43.526929 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:14:43.528332 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.528464 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:14:43.529030 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:14:43.536644 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:14:43.536769 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.536856 (Thread-1): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:14:43.538425 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:14:43.541507 (Thread-1): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:14:43.541618 (Thread-1): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:14:43.547845 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2022-10-05 04:14:43.548669 (Thread-1): finished collecting timing info
2022-10-05 04:14:43.548799 (Thread-1): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:14:43.549065 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14bd3d74-029a-4080-95eb-9481ba81c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e804b9ca0>]}
2022-10-05 04:14:43.549316 (Thread-1): 05:14:43 | 1 of 2 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.06s]
2022-10-05 04:14:43.549447 (Thread-1): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:14:43.549909 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:14:43.550087 (Thread-3): 05:14:43 | 2 of 2 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:14:43.550306 (Thread-3): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:14:43.550469 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:14:43.552116 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:14:43.552487 (Thread-3): finished collecting timing info
2022-10-05 04:14:43.565121 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:14:43.565516 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:14:43.565608 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:14:43.565699 (Thread-3): Opening a new connection, currently in state init
2022-10-05 04:14:43.573794 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:14:43.573913 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:14:43.574001 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:14:43.577083 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:14:43.578667 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:14:43.578801 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:14:43.579254 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:14:43.580145 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:14:43.580261 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:14:43.580352 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:14:43.581409 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:14:43.582401 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:14:43.582497 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:14:43.582878 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:14:43.583555 (Thread-3): finished collecting timing info
2022-10-05 04:14:43.583681 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:14:43.583932 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14bd3d74-029a-4080-95eb-9481ba81c56c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e80520100>]}
2022-10-05 04:14:43.584158 (Thread-3): 05:14:43 | 2 of 2 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-05 04:14:43.584275 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:14:43.585091 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:14:43.585232 (MainThread): Using postgres connection "master".
2022-10-05 04:14:43.585322 (MainThread): On master: BEGIN
2022-10-05 04:14:43.585413 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:14:43.594767 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:14:43.594918 (MainThread): On master: COMMIT
2022-10-05 04:14:43.595009 (MainThread): Using postgres connection "master".
2022-10-05 04:14:43.595093 (MainThread): On master: COMMIT
2022-10-05 04:14:43.595318 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:14:43.595432 (MainThread): On master: Close
2022-10-05 04:14:43.595679 (MainThread): 05:14:43 | 
2022-10-05 04:14:43.595799 (MainThread): 05:14:43 | Finished running 1 table model, 1 view model in 0.22s.
2022-10-05 04:14:43.595907 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:14:43.595991 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:14:43.596073 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:14:43.599698 (MainThread): 
2022-10-05 04:14:43.599876 (MainThread): Completed successfully
2022-10-05 04:14:43.599990 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-10-05 04:14:43.600161 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e8049e2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e804df070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e804dffd0>]}
2022-10-05 04:14:43.600339 (MainThread): Flushing usage events
2022-10-05 04:15:47.880028 (MainThread): Running with dbt=0.21.1
2022-10-05 04:15:47.952628 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:15:47.953639 (MainThread): Tracking: tracking
2022-10-05 04:15:47.977603 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae2674be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae2735f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdae2735820>]}
2022-10-05 04:15:47.986476 (MainThread): Partial parsing not enabled
2022-10-05 04:15:47.995435 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:15:47.998054 (MainThread): Parsing macros/relations.sql
2022-10-05 04:15:47.999063 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:15:48.014901 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:15:48.016063 (MainThread): Parsing macros/core.sql
2022-10-05 04:15:48.018548 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:15:48.023144 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:15:48.029952 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:15:48.031086 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:15:48.042817 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:15:48.067784 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:15:48.083900 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:15:48.085057 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:15:48.092243 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:15:48.106662 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:15:48.116525 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:15:48.122127 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:15:48.127315 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:15:48.129902 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:15:48.130859 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:15:48.131489 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:15:48.132482 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:15:48.138393 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:15:48.139578 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:15:48.141173 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:15:48.142190 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:15:48.181589 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:15:48.182683 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:15:48.183428 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:15:48.184280 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:15:48.299160 (MainThread): Acquiring new postgres connection "model.my_new_project.create_tables".
2022-10-05 04:15:48.307006 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.309509 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:15:48.327293 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:15:48.328474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:15:48.329610 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:15:48.330831 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:15:48.340487 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba80b7ce-d717-49d8-987a-fb12810aaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab00e7b80>]}
2022-10-05 04:15:48.343503 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:15:48.343809 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba80b7ce-d717-49d8-987a-fb12810aaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab00e7eb0>]}
2022-10-05 04:15:48.343967 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:15:48.344880 (MainThread): 
2022-10-05 04:15:48.345098 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:15:48.345729 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:15:48.351788 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:15:48.351911 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:15:48.352013 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:15:48.405961 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.05 seconds
2022-10-05 04:15:48.407423 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:15:48.408210 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:15:48.412362 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:15:48.412556 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:15:48.412663 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:15:48.421235 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:15:48.421390 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:15:48.421482 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:15:48.424366 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:15:48.425257 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:15:48.425533 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:15:48.428399 (MainThread): Using postgres connection "master".
2022-10-05 04:15:48.428526 (MainThread): On master: BEGIN
2022-10-05 04:15:48.428623 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:15:48.437932 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:15:48.438050 (MainThread): Using postgres connection "master".
2022-10-05 04:15:48.438137 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:15:48.445925 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:15:48.446865 (MainThread): On master: ROLLBACK
2022-10-05 04:15:48.447172 (MainThread): Using postgres connection "master".
2022-10-05 04:15:48.447274 (MainThread): On master: BEGIN
2022-10-05 04:15:48.447686 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:15:48.447800 (MainThread): On master: COMMIT
2022-10-05 04:15:48.447893 (MainThread): Using postgres connection "master".
2022-10-05 04:15:48.447979 (MainThread): On master: COMMIT
2022-10-05 04:15:48.448215 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:15:48.448329 (MainThread): On master: Close
2022-10-05 04:15:48.448563 (MainThread): 05:15:48 | Concurrency: 5 threads (target='dev')
2022-10-05 04:15:48.448685 (MainThread): 05:15:48 | 
2022-10-05 04:15:48.450825 (Thread-1): Began running node model.my_new_project.create_tables
2022-10-05 04:15:48.450987 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:15:48.451200 (Thread-1): 05:15:48 | 1 of 3 START view model public.create_tables......................... [RUN]
2022-10-05 04:15:48.451372 (Thread-2): 05:15:48 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:15:48.451627 (Thread-1): Acquiring new postgres connection "model.my_new_project.create_tables".
2022-10-05 04:15:48.451841 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.451979 (Thread-1): Compiling model.my_new_project.create_tables
2022-10-05 04:15:48.452082 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:15:48.453016 (Thread-1): Writing injected SQL for node "model.my_new_project.create_tables"
2022-10-05 04:15:48.454548 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:15:48.454928 (Thread-2): finished collecting timing info
2022-10-05 04:15:48.455051 (Thread-1): finished collecting timing info
2022-10-05 04:15:48.472949 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:15:48.484545 (Thread-1): Writing runtime SQL for node "model.my_new_project.create_tables"
2022-10-05 04:15:48.484923 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.485016 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:15:48.485106 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:15:48.485327 (Thread-1): Using postgres connection "model.my_new_project.create_tables".
2022-10-05 04:15:48.485423 (Thread-1): On model.my_new_project.create_tables: BEGIN
2022-10-05 04:15:48.485507 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:15:48.496217 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:15:48.496429 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:15:48.496541 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.496639 (Thread-1): Using postgres connection "model.my_new_project.create_tables".
2022-10-05 04:15:48.496727 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:15:48.496842 (Thread-1): On model.my_new_project.create_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.create_tables"} */

  create view "postgres"."public"."create_tables__dbt_tmp" as (
    create table customers(
    id int,
    first_name varchar(20),
    last_name varchar(20),
    email varchar(50),
    date_of_birth date,
    current_job varchat(20)

)
  );

2022-10-05 04:15:48.497191 (Thread-1): Postgres error: syntax error at or near "create"
LINE 4:     create table customers(
            ^

2022-10-05 04:15:48.497302 (Thread-1): On model.my_new_project.create_tables: ROLLBACK
2022-10-05 04:15:48.497684 (Thread-1): finished collecting timing info
2022-10-05 04:15:48.497812 (Thread-1): On model.my_new_project.create_tables: Close
2022-10-05 04:15:48.498069 (Thread-1): Database Error in model create_tables (models/create_tables.sql)
  syntax error at or near "create"
  LINE 4:     create table customers(
              ^
  compiled SQL at target/run/my_new_project/models/create_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "create"
LINE 4:     create table customers(
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model create_tables (models/create_tables.sql)
  syntax error at or near "create"
  LINE 4:     create table customers(
              ^
  compiled SQL at target/run/my_new_project/models/create_tables.sql
2022-10-05 04:15:48.501585 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba80b7ce-d717-49d8-987a-fb12810aaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab00e7820>]}
2022-10-05 04:15:48.501846 (Thread-1): 05:15:48 | 1 of 3 ERROR creating view model public.create_tables................ [ERROR in 0.05s]
2022-10-05 04:15:48.501962 (Thread-1): Finished running node model.my_new_project.create_tables
2022-10-05 04:15:48.507141 (Thread-2): SQL status: SELECT 2 in 0.01 seconds
2022-10-05 04:15:48.511520 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.511666 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:15:48.512245 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:15:48.513687 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.513797 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:15:48.514356 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:15:48.522112 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:15:48.522272 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.522375 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:15:48.522901 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:15:48.525795 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:15:48.525900 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:15:48.528537 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:15:48.529442 (Thread-2): finished collecting timing info
2022-10-05 04:15:48.529606 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:15:48.529896 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba80b7ce-d717-49d8-987a-fb12810aaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdab009cb80>]}
2022-10-05 04:15:48.530132 (Thread-2): 05:15:48 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-05 04:15:48.530249 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:15:48.530737 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:15:48.530983 (Thread-4): 05:15:48 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:15:48.531213 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:15:48.531317 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:15:48.532735 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:15:48.533050 (Thread-4): finished collecting timing info
2022-10-05 04:15:48.534365 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:15:48.534600 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:15:48.534686 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:15:48.534772 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:15:48.542575 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:15:48.542698 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:15:48.542781 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:15:48.545735 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:15:48.547386 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:15:48.547550 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:15:48.548260 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:15:48.549173 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:15:48.549277 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:15:48.549360 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:15:48.550137 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:15:48.551135 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:15:48.551237 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:15:48.551485 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:15:48.552169 (Thread-4): finished collecting timing info
2022-10-05 04:15:48.552293 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:15:48.552528 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba80b7ce-d717-49d8-987a-fb12810aaf9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad076d820>]}
2022-10-05 04:15:48.552750 (Thread-4): 05:15:48 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:15:48.552858 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:15:48.553573 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:15:48.553692 (MainThread): Using postgres connection "master".
2022-10-05 04:15:48.553771 (MainThread): On master: BEGIN
2022-10-05 04:15:48.553854 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:15:48.563742 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:15:48.563950 (MainThread): On master: COMMIT
2022-10-05 04:15:48.564039 (MainThread): Using postgres connection "master".
2022-10-05 04:15:48.564121 (MainThread): On master: COMMIT
2022-10-05 04:15:48.564591 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:15:48.564724 (MainThread): On master: Close
2022-10-05 04:15:48.564987 (MainThread): 05:15:48 | 
2022-10-05 04:15:48.565111 (MainThread): 05:15:48 | Finished running 2 view models, 1 table model in 0.22s.
2022-10-05 04:15:48.565225 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:15:48.565304 (MainThread): Connection 'model.my_new_project.create_tables' was properly closed.
2022-10-05 04:15:48.565476 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:15:48.565570 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:15:48.568435 (MainThread): 
2022-10-05 04:15:48.568569 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:15:48.568673 (MainThread): 
2022-10-05 04:15:48.568769 (MainThread): Database Error in model create_tables (models/create_tables.sql)
2022-10-05 04:15:48.568861 (MainThread):   syntax error at or near "create"
2022-10-05 04:15:48.568944 (MainThread):   LINE 4:     create table customers(
2022-10-05 04:15:48.569026 (MainThread):               ^
2022-10-05 04:15:48.569109 (MainThread):   compiled SQL at target/run/my_new_project/models/create_tables.sql
2022-10-05 04:15:48.569203 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:15:48.569353 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad07b9eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad07b4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdad077e250>]}
2022-10-05 04:15:48.569505 (MainThread): Flushing usage events
2022-10-05 04:18:43.995762 (MainThread): Running with dbt=0.21.1
2022-10-05 04:18:44.065612 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:18:44.066969 (MainThread): Tracking: tracking
2022-10-05 04:18:44.092974 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f880296eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88028767f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88029642b0>]}
2022-10-05 04:18:44.101887 (MainThread): Partial parsing not enabled
2022-10-05 04:18:44.111511 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:18:44.114230 (MainThread): Parsing macros/relations.sql
2022-10-05 04:18:44.115277 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:18:44.131973 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:18:44.133128 (MainThread): Parsing macros/core.sql
2022-10-05 04:18:44.135664 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:18:44.140444 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:18:44.147436 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:18:44.148566 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:18:44.160584 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:18:44.188103 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:18:44.205139 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:18:44.206341 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:18:44.213853 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:18:44.229347 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:18:44.239874 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:18:44.245906 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:18:44.251451 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:18:44.254051 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:18:44.255018 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:18:44.255632 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:18:44.256671 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:18:44.262775 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:18:44.263978 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:18:44.265634 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:18:44.266672 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:18:44.308771 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:18:44.309876 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:18:44.310625 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:18:44.311486 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:18:44.423917 (MainThread): Acquiring new postgres connection "model.my_new_project.create_tables".
2022-10-05 04:18:44.432914 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.435423 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:18:44.452960 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:18:44.454116 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:18:44.455223 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:18:44.456424 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:18:44.466127 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1673c3b-f1b0-4dc5-88ca-878dd1100d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f021c0d0>]}
2022-10-05 04:18:44.469667 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:18:44.470425 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1673c3b-f1b0-4dc5-88ca-878dd1100d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f021c580>]}
2022-10-05 04:18:44.470587 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:18:44.471463 (MainThread): 
2022-10-05 04:18:44.471676 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:18:44.472332 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:18:44.479041 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:18:44.479206 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:18:44.479304 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:18:44.525435 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.05 seconds
2022-10-05 04:18:44.527050 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:18:44.527838 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:18:44.532005 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:18:44.532122 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:18:44.532223 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:18:44.540162 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:18:44.540279 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:18:44.540370 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:18:44.543890 (ThreadPoolExecutor-1_0): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:18:44.544785 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:18:44.545089 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:18:44.547980 (MainThread): Using postgres connection "master".
2022-10-05 04:18:44.548102 (MainThread): On master: BEGIN
2022-10-05 04:18:44.548204 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:18:44.557979 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:18:44.558099 (MainThread): Using postgres connection "master".
2022-10-05 04:18:44.558188 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:18:44.565768 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:18:44.566624 (MainThread): On master: ROLLBACK
2022-10-05 04:18:44.566930 (MainThread): Using postgres connection "master".
2022-10-05 04:18:44.567032 (MainThread): On master: BEGIN
2022-10-05 04:18:44.567429 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:18:44.567544 (MainThread): On master: COMMIT
2022-10-05 04:18:44.567640 (MainThread): Using postgres connection "master".
2022-10-05 04:18:44.567729 (MainThread): On master: COMMIT
2022-10-05 04:18:44.567970 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:18:44.568077 (MainThread): On master: Close
2022-10-05 04:18:44.568288 (MainThread): 05:18:44 | Concurrency: 5 threads (target='dev')
2022-10-05 04:18:44.568412 (MainThread): 05:18:44 | 
2022-10-05 04:18:44.570683 (Thread-1): Began running node model.my_new_project.create_tables
2022-10-05 04:18:44.570853 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:18:44.571099 (Thread-1): 05:18:44 | 1 of 3 START view model public.create_tables......................... [RUN]
2022-10-05 04:18:44.571287 (Thread-2): 05:18:44 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:18:44.571588 (Thread-1): Acquiring new postgres connection "model.my_new_project.create_tables".
2022-10-05 04:18:44.571848 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.572012 (Thread-1): Compiling model.my_new_project.create_tables
2022-10-05 04:18:44.572239 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:18:44.573301 (Thread-1): Writing injected SQL for node "model.my_new_project.create_tables"
2022-10-05 04:18:44.575115 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:18:44.575751 (Thread-1): finished collecting timing info
2022-10-05 04:18:44.575912 (Thread-2): finished collecting timing info
2022-10-05 04:18:44.598444 (Thread-1): Writing runtime SQL for node "model.my_new_project.create_tables"
2022-10-05 04:18:44.606010 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:18:44.606398 (Thread-1): Using postgres connection "model.my_new_project.create_tables".
2022-10-05 04:18:44.606502 (Thread-1): On model.my_new_project.create_tables: BEGIN
2022-10-05 04:18:44.606597 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:18:44.606790 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.606884 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:18:44.606969 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:18:44.615043 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:18:44.615156 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:18:44.615249 (Thread-1): Using postgres connection "model.my_new_project.create_tables".
2022-10-05 04:18:44.615342 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.615428 (Thread-1): On model.my_new_project.create_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.create_tables"} */

  create view "postgres"."public"."create_tables__dbt_tmp" as (
    create table customers(
    id int,
    first_name varchar(20),
    last_name varchar(20),
    email varchar(50),
    date_of_birth date,
    current_job varchar(20)

)
  );

2022-10-05 04:18:44.615516 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:18:44.615875 (Thread-1): Postgres error: syntax error at or near "create"
LINE 4:     create table customers(
            ^

2022-10-05 04:18:44.615969 (Thread-1): On model.my_new_project.create_tables: ROLLBACK
2022-10-05 04:18:44.616368 (Thread-1): finished collecting timing info
2022-10-05 04:18:44.616496 (Thread-1): On model.my_new_project.create_tables: Close
2022-10-05 04:18:44.616719 (Thread-1): Database Error in model create_tables (models/create_tables.sql)
  syntax error at or near "create"
  LINE 4:     create table customers(
              ^
  compiled SQL at target/run/my_new_project/models/create_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "create"
LINE 4:     create table customers(
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model create_tables (models/create_tables.sql)
  syntax error at or near "create"
  LINE 4:     create table customers(
              ^
  compiled SQL at target/run/my_new_project/models/create_tables.sql
2022-10-05 04:18:44.626101 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1673c3b-f1b0-4dc5-88ca-878dd1100d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e04f8790>]}
2022-10-05 04:18:44.626383 (Thread-1): 05:18:44 | 1 of 3 ERROR creating view model public.create_tables................ [ERROR in 0.05s]
2022-10-05 04:18:44.626509 (Thread-1): Finished running node model.my_new_project.create_tables
2022-10-05 04:18:44.632487 (Thread-2): SQL status: SELECT 2 in 0.02 seconds
2022-10-05 04:18:44.637111 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.637292 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:18:44.637942 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:18:44.639624 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.639780 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:18:44.640293 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:18:44.647586 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:18:44.647701 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.647789 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:18:44.648896 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:18:44.651776 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:18:44.651881 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:18:44.655619 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:18:44.656527 (Thread-2): finished collecting timing info
2022-10-05 04:18:44.656665 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:18:44.656928 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1673c3b-f1b0-4dc5-88ca-878dd1100d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f0210d00>]}
2022-10-05 04:18:44.657148 (Thread-2): 05:18:44 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-05 04:18:44.657261 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:18:44.657698 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:18:44.657907 (Thread-4): 05:18:44 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:18:44.658109 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:18:44.658208 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:18:44.659633 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:18:44.659917 (Thread-4): finished collecting timing info
2022-10-05 04:18:44.661220 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:18:44.661457 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:18:44.661545 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:18:44.661634 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:18:44.670210 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:18:44.670379 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:18:44.670471 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:18:44.673749 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:18:44.675408 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:18:44.675527 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:18:44.675897 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:18:44.676644 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:18:44.676747 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:18:44.676832 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:18:44.677522 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:18:44.678398 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:18:44.678496 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:18:44.678805 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:18:44.679450 (Thread-4): finished collecting timing info
2022-10-05 04:18:44.679570 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:18:44.679806 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1673c3b-f1b0-4dc5-88ca-878dd1100d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e04e8c40>]}
2022-10-05 04:18:44.680021 (Thread-4): 05:18:44 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:18:44.680134 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:18:44.680894 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:18:44.681022 (MainThread): Using postgres connection "master".
2022-10-05 04:18:44.681106 (MainThread): On master: BEGIN
2022-10-05 04:18:44.681191 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:18:44.689985 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:18:44.690259 (MainThread): On master: COMMIT
2022-10-05 04:18:44.690349 (MainThread): Using postgres connection "master".
2022-10-05 04:18:44.690431 (MainThread): On master: COMMIT
2022-10-05 04:18:44.690626 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:18:44.690722 (MainThread): On master: Close
2022-10-05 04:18:44.690978 (MainThread): 05:18:44 | 
2022-10-05 04:18:44.691087 (MainThread): 05:18:44 | Finished running 2 view models, 1 table model in 0.22s.
2022-10-05 04:18:44.691183 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:18:44.691264 (MainThread): Connection 'model.my_new_project.create_tables' was properly closed.
2022-10-05 04:18:44.691338 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:18:44.691414 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:18:44.694378 (MainThread): 
2022-10-05 04:18:44.694499 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:18:44.694597 (MainThread): 
2022-10-05 04:18:44.694693 (MainThread): Database Error in model create_tables (models/create_tables.sql)
2022-10-05 04:18:44.694787 (MainThread):   syntax error at or near "create"
2022-10-05 04:18:44.694869 (MainThread):   LINE 4:     create table customers(
2022-10-05 04:18:44.694952 (MainThread):               ^
2022-10-05 04:18:44.695034 (MainThread):   compiled SQL at target/run/my_new_project/models/create_tables.sql
2022-10-05 04:18:44.695128 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:18:44.695269 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e049f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e049fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e049fd60>]}
2022-10-05 04:18:44.695427 (MainThread): Flushing usage events
2022-10-05 04:20:24.727681 (MainThread): Running with dbt=0.21.1
2022-10-05 04:20:24.798523 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:20:24.799613 (MainThread): Tracking: tracking
2022-10-05 04:20:24.820668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45a8e0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45a8dc5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb45a8dcd60>]}
2022-10-05 04:20:24.829512 (MainThread): Partial parsing not enabled
2022-10-05 04:20:24.838165 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:20:24.840933 (MainThread): Parsing macros/relations.sql
2022-10-05 04:20:24.842081 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:20:24.859027 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:20:24.860189 (MainThread): Parsing macros/core.sql
2022-10-05 04:20:24.862724 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:20:24.867531 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:20:24.874533 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:20:24.875662 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:20:24.887623 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:20:24.915309 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:20:24.932342 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:20:24.933528 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:20:24.941047 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:20:24.956510 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:20:24.967036 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:20:24.973051 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:20:24.978625 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:20:24.981220 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:20:24.982196 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:20:24.982807 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:20:24.983818 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:20:24.989957 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:20:24.991157 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:20:24.992793 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:20:24.993862 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:20:25.035963 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:20:25.037127 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:20:25.037917 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:20:25.038780 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:20:25.151885 (MainThread): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:20:25.159721 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.162212 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:20:25.179814 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:20:25.180958 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:20:25.182071 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:20:25.183257 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:20:25.192765 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75d0e95a-7e41-4521-bdc5-a5b06c559d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44860e0d0>]}
2022-10-05 04:20:25.195674 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:20:25.195972 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75d0e95a-7e41-4521-bdc5-a5b06c559d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44860e5b0>]}
2022-10-05 04:20:25.196136 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:20:25.197040 (MainThread): 
2022-10-05 04:20:25.197258 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:20:25.197960 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:20:25.205079 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:20:25.205241 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:20:25.205341 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:20:25.269556 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-05 04:20:25.271179 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:20:25.271993 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:20:25.276352 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:20:25.276488 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:20:25.276597 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:20:25.286195 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:20:25.286322 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:20:25.286424 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:20:25.292123 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:20:25.293011 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:20:25.293302 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:20:25.296195 (MainThread): Using postgres connection "master".
2022-10-05 04:20:25.296314 (MainThread): On master: BEGIN
2022-10-05 04:20:25.296422 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:20:25.305897 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:20:25.306023 (MainThread): Using postgres connection "master".
2022-10-05 04:20:25.306119 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:20:25.315342 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:20:25.316271 (MainThread): On master: ROLLBACK
2022-10-05 04:20:25.316574 (MainThread): Using postgres connection "master".
2022-10-05 04:20:25.316684 (MainThread): On master: BEGIN
2022-10-05 04:20:25.317103 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:20:25.317231 (MainThread): On master: COMMIT
2022-10-05 04:20:25.317338 (MainThread): Using postgres connection "master".
2022-10-05 04:20:25.317436 (MainThread): On master: COMMIT
2022-10-05 04:20:25.317689 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:20:25.317807 (MainThread): On master: Close
2022-10-05 04:20:25.318035 (MainThread): 05:20:25 | Concurrency: 5 threads (target='dev')
2022-10-05 04:20:25.318170 (MainThread): 05:20:25 | 
2022-10-05 04:20:25.320360 (Thread-1): Began running node model.my_new_project.insert_tables
2022-10-05 04:20:25.320549 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:20:25.320754 (Thread-1): 05:20:25 | 1 of 3 START view model public.insert_tables......................... [RUN]
2022-10-05 04:20:25.320923 (Thread-2): 05:20:25 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:20:25.321260 (Thread-1): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:20:25.321524 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.321685 (Thread-1): Compiling model.my_new_project.insert_tables
2022-10-05 04:20:25.321825 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:20:25.322899 (Thread-1): Writing injected SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:20:25.324802 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:20:25.325285 (Thread-1): finished collecting timing info
2022-10-05 04:20:25.325436 (Thread-2): finished collecting timing info
2022-10-05 04:20:25.348717 (Thread-1): Writing runtime SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:20:25.355395 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:20:25.355736 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:20:25.355865 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.355954 (Thread-1): On model.my_new_project.insert_tables: BEGIN
2022-10-05 04:20:25.356048 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:20:25.356141 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:20:25.356221 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:20:25.364541 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:20:25.364661 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:20:25.364753 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:20:25.364844 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.364929 (Thread-1): On model.my_new_project.insert_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.insert_tables"} */

  create view "postgres"."public"."insert_tables__dbt_tmp" as (
    insert into customers(1,"Emmanuel","Offisong","eo@yahoo.com",2022-03-05,"data engineer"),
(2,"Oduguwa","Damilola","dami@gmail.com",2022-01-01,"ml expert")
  );

2022-10-05 04:20:25.365015 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:20:25.365372 (Thread-1): Postgres error: syntax error at or near "insert"
LINE 4:     insert into customers(1,"Emmanuel","Offisong","eo@yahoo....
            ^

2022-10-05 04:20:25.365472 (Thread-1): On model.my_new_project.insert_tables: ROLLBACK
2022-10-05 04:20:25.365914 (Thread-1): finished collecting timing info
2022-10-05 04:20:25.366040 (Thread-1): On model.my_new_project.insert_tables: Close
2022-10-05 04:20:25.368228 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:20:25.372594 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.372810 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:20:25.373658 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:20:25.375073 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.375185 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:20:25.366267 (Thread-1): Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers(1,"Emmanuel","Offisong","eo@yahoo....
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "insert"
LINE 4:     insert into customers(1,"Emmanuel","Offisong","eo@yahoo....
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers(1,"Emmanuel","Offisong","eo@yahoo....
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:20:25.375739 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0e95a-7e41-4521-bdc5-a5b06c559d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb448626d90>]}
2022-10-05 04:20:25.375973 (Thread-1): 05:20:25 | 1 of 3 ERROR creating view model public.insert_tables................ [ERROR in 0.05s]
2022-10-05 04:20:25.376070 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:20:25.382778 (Thread-1): Finished running node model.my_new_project.insert_tables
2022-10-05 04:20:25.382965 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:20:25.383125 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.383295 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:20:25.384121 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:20:25.387090 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:20:25.387234 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:20:25.390037 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:20:25.390898 (Thread-2): finished collecting timing info
2022-10-05 04:20:25.391032 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:20:25.391284 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0e95a-7e41-4521-bdc5-a5b06c559d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44860efa0>]}
2022-10-05 04:20:25.391497 (Thread-2): 05:20:25 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 04:20:25.391605 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:20:25.392042 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:20:25.392266 (Thread-4): 05:20:25 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:20:25.392466 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:20:25.392568 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:20:25.393941 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:20:25.394245 (Thread-4): finished collecting timing info
2022-10-05 04:20:25.395508 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:20:25.395749 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:20:25.395834 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:20:25.395917 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:20:25.403617 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:20:25.403814 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:20:25.403903 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:20:25.407210 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:20:25.408737 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:20:25.408849 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:20:25.409422 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:20:25.410088 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:20:25.410182 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:20:25.410262 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:20:25.410870 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:20:25.411707 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:20:25.411799 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:20:25.412110 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:20:25.412786 (Thread-4): finished collecting timing info
2022-10-05 04:20:25.412910 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:20:25.413146 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75d0e95a-7e41-4521-bdc5-a5b06c559d80', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4487014f0>]}
2022-10-05 04:20:25.413355 (Thread-4): 05:20:25 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:20:25.413463 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:20:25.414206 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:20:25.414344 (MainThread): Using postgres connection "master".
2022-10-05 04:20:25.414430 (MainThread): On master: BEGIN
2022-10-05 04:20:25.414514 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:20:25.423608 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:20:25.423798 (MainThread): On master: COMMIT
2022-10-05 04:20:25.423885 (MainThread): Using postgres connection "master".
2022-10-05 04:20:25.423968 (MainThread): On master: COMMIT
2022-10-05 04:20:25.424151 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:20:25.424256 (MainThread): On master: Close
2022-10-05 04:20:25.424519 (MainThread): 05:20:25 | 
2022-10-05 04:20:25.424631 (MainThread): 05:20:25 | Finished running 2 view models, 1 table model in 0.23s.
2022-10-05 04:20:25.424730 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:20:25.424809 (MainThread): Connection 'model.my_new_project.insert_tables' was properly closed.
2022-10-05 04:20:25.424888 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:20:25.424965 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:20:25.427882 (MainThread): 
2022-10-05 04:20:25.428017 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:20:25.428114 (MainThread): 
2022-10-05 04:20:25.428206 (MainThread): Database Error in model insert_tables (models/insert_tables.sql)
2022-10-05 04:20:25.428293 (MainThread):   syntax error at or near "insert"
2022-10-05 04:20:25.428375 (MainThread):   LINE 4:     insert into customers(1,"Emmanuel","Offisong","eo@yahoo....
2022-10-05 04:20:25.428457 (MainThread):               ^
2022-10-05 04:20:25.428539 (MainThread):   compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:20:25.428631 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:20:25.428775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb448636100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4486367c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb448636dc0>]}
2022-10-05 04:20:25.428932 (MainThread): Flushing usage events
2022-10-05 04:21:52.875922 (MainThread): Running with dbt=0.21.1
2022-10-05 04:21:52.948072 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:21:52.949789 (MainThread): Tracking: tracking
2022-10-05 04:21:52.974170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9927fde80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99280b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99280b0d0>]}
2022-10-05 04:21:52.983131 (MainThread): Partial parsing not enabled
2022-10-05 04:21:52.992533 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:21:52.995162 (MainThread): Parsing macros/relations.sql
2022-10-05 04:21:52.996199 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:21:53.012064 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:21:53.013192 (MainThread): Parsing macros/core.sql
2022-10-05 04:21:53.015694 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:21:53.020287 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:21:53.027003 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:21:53.028105 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:21:53.039943 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:21:53.064601 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:21:53.080674 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:21:53.081837 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:21:53.088956 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:21:53.103304 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:21:53.113156 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:21:53.118755 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:21:53.123912 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:21:53.126463 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:21:53.127428 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:21:53.128042 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:21:53.129037 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:21:53.134909 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:21:53.136090 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:21:53.137680 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:21:53.138702 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:21:53.177583 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:21:53.178663 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:21:53.179405 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:21:53.180259 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:21:53.293043 (MainThread): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:21:53.300773 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.303229 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:21:53.320616 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:21:53.321762 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:21:53.322861 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:21:53.324050 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:21:53.334444 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bc1abc1-5c41-4dbf-aa12-c9cffa6e4789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97072e9d0>]}
2022-10-05 04:21:53.337782 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:21:53.338108 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bc1abc1-5c41-4dbf-aa12-c9cffa6e4789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97072eb50>]}
2022-10-05 04:21:53.338272 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:21:53.339219 (MainThread): 
2022-10-05 04:21:53.339429 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:21:53.340079 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:21:53.346691 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:21:53.346855 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:21:53.346952 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:21:53.409513 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-05 04:21:53.410978 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:21:53.411782 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:21:53.416076 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:21:53.416205 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:21:53.416314 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:21:53.425827 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:21:53.425962 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:21:53.426064 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:21:53.431476 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:21:53.432359 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:21:53.432651 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:21:53.435488 (MainThread): Using postgres connection "master".
2022-10-05 04:21:53.435607 (MainThread): On master: BEGIN
2022-10-05 04:21:53.435710 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:21:53.445015 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:21:53.445125 (MainThread): Using postgres connection "master".
2022-10-05 04:21:53.445212 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:21:53.453471 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:21:53.454391 (MainThread): On master: ROLLBACK
2022-10-05 04:21:53.454652 (MainThread): Using postgres connection "master".
2022-10-05 04:21:53.454760 (MainThread): On master: BEGIN
2022-10-05 04:21:53.455112 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:21:53.455225 (MainThread): On master: COMMIT
2022-10-05 04:21:53.455325 (MainThread): Using postgres connection "master".
2022-10-05 04:21:53.455423 (MainThread): On master: COMMIT
2022-10-05 04:21:53.455639 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:21:53.455759 (MainThread): On master: Close
2022-10-05 04:21:53.455991 (MainThread): 05:21:53 | Concurrency: 5 threads (target='dev')
2022-10-05 04:21:53.456122 (MainThread): 05:21:53 | 
2022-10-05 04:21:53.458396 (Thread-1): Began running node model.my_new_project.insert_tables
2022-10-05 04:21:53.458560 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:21:53.458787 (Thread-1): 05:21:53 | 1 of 3 START view model public.insert_tables......................... [RUN]
2022-10-05 04:21:53.458979 (Thread-2): 05:21:53 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:21:53.459276 (Thread-1): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:21:53.459520 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.459680 (Thread-1): Compiling model.my_new_project.insert_tables
2022-10-05 04:21:53.459813 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:21:53.460848 (Thread-1): Writing injected SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:21:53.462642 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:21:53.463176 (Thread-1): finished collecting timing info
2022-10-05 04:21:53.463318 (Thread-2): finished collecting timing info
2022-10-05 04:21:53.491332 (Thread-1): Writing runtime SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:21:53.496156 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:21:53.496517 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:21:53.496610 (Thread-1): On model.my_new_project.insert_tables: BEGIN
2022-10-05 04:21:53.496705 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:21:53.496896 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.496987 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:21:53.497071 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:21:53.505092 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:21:53.505235 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:21:53.505347 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.505439 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:21:53.505530 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:21:53.505618 (Thread-1): On model.my_new_project.insert_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.insert_tables"} */

  create view "postgres"."public"."insert_tables__dbt_tmp" as (
    insert into public.customers(1,"Emmanuel","Offisong","eo@yahoo.com",2022-03-05,"data engineer"),
(2,"Oduguwa","Damilola","dami@gmail.com",2022-01-01,"ml expert")
  );

2022-10-05 04:21:53.505863 (Thread-1): Postgres error: syntax error at or near "insert"
LINE 4:     insert into public.customers(1,"Emmanuel","Offisong","eo...
            ^

2022-10-05 04:21:53.505952 (Thread-1): On model.my_new_project.insert_tables: ROLLBACK
2022-10-05 04:21:53.506296 (Thread-1): finished collecting timing info
2022-10-05 04:21:53.506414 (Thread-1): On model.my_new_project.insert_tables: Close
2022-10-05 04:21:53.507758 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:21:53.511708 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.511846 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:21:53.512358 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:21:53.513540 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.513632 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:21:53.514335 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:21:53.521000 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:21:53.521125 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.521217 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:21:53.506652 (Thread-1): Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into public.customers(1,"Emmanuel","Offisong","eo...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "insert"
LINE 4:     insert into public.customers(1,"Emmanuel","Offisong","eo...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into public.customers(1,"Emmanuel","Offisong","eo...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:21:53.522207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bc1abc1-5c41-4dbf-aa12-c9cffa6e4789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99287c550>]}
2022-10-05 04:21:53.522439 (Thread-1): 05:21:53 | 1 of 3 ERROR creating view model public.insert_tables................ [ERROR in 0.06s]
2022-10-05 04:21:53.522554 (Thread-1): Finished running node model.my_new_project.insert_tables
2022-10-05 04:21:53.528528 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-10-05 04:21:53.531789 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:21:53.531900 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:21:53.534268 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:21:53.535258 (Thread-2): finished collecting timing info
2022-10-05 04:21:53.535426 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:21:53.535715 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bc1abc1-5c41-4dbf-aa12-c9cffa6e4789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97064cd60>]}
2022-10-05 04:21:53.536006 (Thread-2): 05:21:53 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-05 04:21:53.536125 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:21:53.536582 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:21:53.536784 (Thread-4): 05:21:53 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:21:53.537044 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:21:53.537150 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:21:53.538519 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:21:53.538802 (Thread-4): finished collecting timing info
2022-10-05 04:21:53.540059 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:21:53.540279 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:21:53.540362 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:21:53.540446 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:21:53.548081 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:21:53.548184 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:21:53.548266 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:21:53.550127 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:21:53.551479 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:21:53.551590 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:21:53.552179 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:21:53.552996 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:21:53.553122 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:21:53.553206 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:21:53.553684 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:21:53.554715 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:21:53.554867 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:21:53.555177 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:21:53.556039 (Thread-4): finished collecting timing info
2022-10-05 04:21:53.556175 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:21:53.556434 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bc1abc1-5c41-4dbf-aa12-c9cffa6e4789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd99287cc40>]}
2022-10-05 04:21:53.556660 (Thread-4): 05:21:53 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:21:53.556770 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:21:53.557592 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:21:53.557739 (MainThread): Using postgres connection "master".
2022-10-05 04:21:53.557827 (MainThread): On master: BEGIN
2022-10-05 04:21:53.557916 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:21:53.566350 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:21:53.566488 (MainThread): On master: COMMIT
2022-10-05 04:21:53.566579 (MainThread): Using postgres connection "master".
2022-10-05 04:21:53.566665 (MainThread): On master: COMMIT
2022-10-05 04:21:53.566900 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:21:53.567020 (MainThread): On master: Close
2022-10-05 04:21:53.567270 (MainThread): 05:21:53 | 
2022-10-05 04:21:53.567386 (MainThread): 05:21:53 | Finished running 2 view models, 1 table model in 0.23s.
2022-10-05 04:21:53.567490 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:21:53.567574 (MainThread): Connection 'model.my_new_project.insert_tables' was properly closed.
2022-10-05 04:21:53.567656 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:21:53.567737 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:21:53.571037 (MainThread): 
2022-10-05 04:21:53.571213 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:21:53.571312 (MainThread): 
2022-10-05 04:21:53.571411 (MainThread): Database Error in model insert_tables (models/insert_tables.sql)
2022-10-05 04:21:53.571500 (MainThread):   syntax error at or near "insert"
2022-10-05 04:21:53.571581 (MainThread):   LINE 4:     insert into public.customers(1,"Emmanuel","Offisong","eo...
2022-10-05 04:21:53.571661 (MainThread):               ^
2022-10-05 04:21:53.571741 (MainThread):   compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:21:53.571832 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:21:53.571987 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9928f4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97072e130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd97072ebb0>]}
2022-10-05 04:21:53.572142 (MainThread): Flushing usage events
2022-10-05 04:29:27.847273 (MainThread): Running with dbt=0.21.1
2022-10-05 04:29:27.920034 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:29:27.921785 (MainThread): Tracking: tracking
2022-10-05 04:29:27.956172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37aaafc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37aaa5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37aaa5070>]}
2022-10-05 04:29:27.965441 (MainThread): Partial parsing not enabled
2022-10-05 04:29:27.974469 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:29:27.976984 (MainThread): Parsing macros/relations.sql
2022-10-05 04:29:27.977979 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:29:27.993905 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:29:27.995023 (MainThread): Parsing macros/core.sql
2022-10-05 04:29:27.997492 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:29:28.002119 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:29:28.008838 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:29:28.009933 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:29:28.021555 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:29:28.047726 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:29:28.063951 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:29:28.065103 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:29:28.072357 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:29:28.087075 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:29:28.097088 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:29:28.102903 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:29:28.108252 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:29:28.110766 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:29:28.111722 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:29:28.112324 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:29:28.113316 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:29:28.119204 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:29:28.120372 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:29:28.121943 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:29:28.122957 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:29:28.162824 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:29:28.163901 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:29:28.164638 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:29:28.165483 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:29:28.276264 (MainThread): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:29:28.283881 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.286345 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:29:28.303659 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:29:28.304809 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:29:28.305942 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:29:28.307138 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:29:28.317615 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd7f202-c804-4c75-926e-fdd7bcc2c0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37abbc070>]}
2022-10-05 04:29:28.321150 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:29:28.321610 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd7f202-c804-4c75-926e-fdd7bcc2c0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37abbc550>]}
2022-10-05 04:29:28.321771 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:29:28.322652 (MainThread): 
2022-10-05 04:29:28.322867 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:29:28.323499 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:29:28.330266 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:29:28.330466 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:29:28.330569 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:29:28.394104 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-05 04:29:28.395665 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:29:28.396535 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:29:28.400801 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:29:28.400924 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:29:28.401033 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:29:28.411801 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:29:28.411930 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:29:28.412034 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:29:28.417413 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:29:28.418302 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:29:28.418599 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:29:28.421434 (MainThread): Using postgres connection "master".
2022-10-05 04:29:28.421554 (MainThread): On master: BEGIN
2022-10-05 04:29:28.421658 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:29:28.430915 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:29:28.431033 (MainThread): Using postgres connection "master".
2022-10-05 04:29:28.431139 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:29:28.440547 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:29:28.441462 (MainThread): On master: ROLLBACK
2022-10-05 04:29:28.441768 (MainThread): Using postgres connection "master".
2022-10-05 04:29:28.441880 (MainThread): On master: BEGIN
2022-10-05 04:29:28.442288 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:29:28.442413 (MainThread): On master: COMMIT
2022-10-05 04:29:28.442518 (MainThread): Using postgres connection "master".
2022-10-05 04:29:28.442613 (MainThread): On master: COMMIT
2022-10-05 04:29:28.442851 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:29:28.442960 (MainThread): On master: Close
2022-10-05 04:29:28.443172 (MainThread): 05:29:28 | Concurrency: 5 threads (target='dev')
2022-10-05 04:29:28.443297 (MainThread): 05:29:28 | 
2022-10-05 04:29:28.445577 (Thread-1): Began running node model.my_new_project.insert_tables
2022-10-05 04:29:28.445752 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:29:28.445958 (Thread-1): 05:29:28 | 1 of 3 START view model public.insert_tables......................... [RUN]
2022-10-05 04:29:28.446120 (Thread-2): 05:29:28 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:29:28.446377 (Thread-1): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:29:28.446598 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.446745 (Thread-1): Compiling model.my_new_project.insert_tables
2022-10-05 04:29:28.446873 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:29:28.447925 (Thread-1): Writing injected SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:29:28.449834 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:29:28.450632 (Thread-2): finished collecting timing info
2022-10-05 04:29:28.450862 (Thread-1): finished collecting timing info
2022-10-05 04:29:28.476267 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:29:28.480996 (Thread-1): Writing runtime SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:29:28.481574 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:29:28.481717 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.481814 (Thread-1): On model.my_new_project.insert_tables: BEGIN
2022-10-05 04:29:28.481912 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:29:28.482012 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:29:28.482131 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:29:28.490770 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:29:28.490927 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:29:28.491060 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.491166 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:29:28.491265 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:29:28.491364 (Thread-1): On model.my_new_project.insert_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.insert_tables"} */

  create view "postgres"."public"."insert_tables__dbt_tmp" as (
    insert into customers values (1,"Emmanuel","Offisong","eo@yahoo.com",2022-03-05,"data engineer"),
(2,"Oduguwa","Damilola","dami@gmail.com",2022-01-01,"ml expert")
  );

2022-10-05 04:29:28.491624 (Thread-1): Postgres error: syntax error at or near "insert"
LINE 4:     insert into customers values (1,"Emmanuel","Offisong","e...
            ^

2022-10-05 04:29:28.491723 (Thread-1): On model.my_new_project.insert_tables: ROLLBACK
2022-10-05 04:29:28.492064 (Thread-1): finished collecting timing info
2022-10-05 04:29:28.492186 (Thread-1): On model.my_new_project.insert_tables: Close
2022-10-05 04:29:28.493729 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:29:28.497933 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.498133 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:29:28.498756 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:29:28.500431 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.500602 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:29:28.501211 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:29:28.507973 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:29:28.508114 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.508224 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:29:28.492441 (Thread-1): Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers values (1,"Emmanuel","Offisong","e...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "insert"
LINE 4:     insert into customers values (1,"Emmanuel","Offisong","e...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers values (1,"Emmanuel","Offisong","e...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:29:28.508642 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd7f202-c804-4c75-926e-fdd7bcc2c0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37abbca90>]}
2022-10-05 04:29:28.508873 (Thread-1): 05:29:28 | 1 of 3 ERROR creating view model public.insert_tables................ [ERROR in 0.06s]
2022-10-05 04:29:28.508983 (Thread-1): Finished running node model.my_new_project.insert_tables
2022-10-05 04:29:28.514240 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-10-05 04:29:28.517809 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:29:28.517978 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:29:28.520861 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:29:28.521819 (Thread-2): finished collecting timing info
2022-10-05 04:29:28.521970 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:29:28.522240 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd7f202-c804-4c75-926e-fdd7bcc2c0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37ab4dee0>]}
2022-10-05 04:29:28.522464 (Thread-2): 05:29:28 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-05 04:29:28.522578 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:29:28.522936 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:29:28.523140 (Thread-4): 05:29:28 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:29:28.523435 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:29:28.523592 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:29:28.525083 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:29:28.525396 (Thread-4): finished collecting timing info
2022-10-05 04:29:28.526737 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:29:28.526981 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:29:28.527071 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:29:28.527161 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:29:28.536362 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:29:28.536585 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:29:28.536676 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:29:28.539564 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:29:28.541169 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:29:28.541289 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:29:28.541805 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:29:28.542527 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:29:28.542634 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:29:28.542723 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:29:28.543646 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:29:28.544567 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:29:28.544675 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:29:28.544981 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:29:28.545653 (Thread-4): finished collecting timing info
2022-10-05 04:29:28.545789 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:29:28.546043 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd7f202-c804-4c75-926e-fdd7bcc2c0c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37ab4dee0>]}
2022-10-05 04:29:28.546272 (Thread-4): 05:29:28 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:29:28.546393 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:29:28.547140 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:29:28.547275 (MainThread): Using postgres connection "master".
2022-10-05 04:29:28.547373 (MainThread): On master: BEGIN
2022-10-05 04:29:28.547466 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:29:28.555435 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:29:28.555627 (MainThread): On master: COMMIT
2022-10-05 04:29:28.555713 (MainThread): Using postgres connection "master".
2022-10-05 04:29:28.555796 (MainThread): On master: COMMIT
2022-10-05 04:29:28.555981 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:29:28.556089 (MainThread): On master: Close
2022-10-05 04:29:28.556335 (MainThread): 05:29:28 | 
2022-10-05 04:29:28.556445 (MainThread): 05:29:28 | Finished running 2 view models, 1 table model in 0.23s.
2022-10-05 04:29:28.556542 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:29:28.556623 (MainThread): Connection 'model.my_new_project.insert_tables' was properly closed.
2022-10-05 04:29:28.556702 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:29:28.556779 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:29:28.559656 (MainThread): 
2022-10-05 04:29:28.559780 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:29:28.559878 (MainThread): 
2022-10-05 04:29:28.559973 (MainThread): Database Error in model insert_tables (models/insert_tables.sql)
2022-10-05 04:29:28.560060 (MainThread):   syntax error at or near "insert"
2022-10-05 04:29:28.560143 (MainThread):   LINE 4:     insert into customers values (1,"Emmanuel","Offisong","e...
2022-10-05 04:29:28.560227 (MainThread):               ^
2022-10-05 04:29:28.560310 (MainThread):   compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:29:28.560400 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:29:28.560553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3683de700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc3683d4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37abd2340>]}
2022-10-05 04:29:28.560710 (MainThread): Flushing usage events
2022-10-05 04:31:41.317264 (MainThread): Running with dbt=0.21.1
2022-10-05 04:31:41.395407 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:31:41.396478 (MainThread): Tracking: tracking
2022-10-05 04:31:41.422744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe938235e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe938243790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe938243880>]}
2022-10-05 04:31:41.431553 (MainThread): Partial parsing not enabled
2022-10-05 04:31:41.440608 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:31:41.443299 (MainThread): Parsing macros/relations.sql
2022-10-05 04:31:41.444308 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:31:41.460342 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:31:41.461466 (MainThread): Parsing macros/core.sql
2022-10-05 04:31:41.463948 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:31:41.468633 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:31:41.475374 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:31:41.476481 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:31:41.488249 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:31:41.514508 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:31:41.530850 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:31:41.532019 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:31:41.539350 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:31:41.554223 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:31:41.564387 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:31:41.570235 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:31:41.575627 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:31:41.578172 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:31:41.579127 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:31:41.579737 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:31:41.580744 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:31:41.586694 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:31:41.587886 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:31:41.589471 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:31:41.590494 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:31:41.630469 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:31:41.631549 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:31:41.632298 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:31:41.633152 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:31:41.744788 (MainThread): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:31:41.752431 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.754893 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:31:41.772238 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:31:41.773388 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:31:41.774496 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:31:41.775698 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:31:41.786544 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e5045bd-e947-45ad-841b-5a66929d552c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9383100d0>]}
2022-10-05 04:31:41.789794 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:31:41.790281 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e5045bd-e947-45ad-841b-5a66929d552c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9383104f0>]}
2022-10-05 04:31:41.790457 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:31:41.791388 (MainThread): 
2022-10-05 04:31:41.791607 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:31:41.792280 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:31:41.798912 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:31:41.799083 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:31:41.799184 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:31:41.849885 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.05 seconds
2022-10-05 04:31:41.851346 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:31:41.852123 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:31:41.856310 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:31:41.856426 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:31:41.856525 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:31:41.864592 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:31:41.864742 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:31:41.864842 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:31:41.870091 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:31:41.871038 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:31:41.871337 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:31:41.874315 (MainThread): Using postgres connection "master".
2022-10-05 04:31:41.874446 (MainThread): On master: BEGIN
2022-10-05 04:31:41.874554 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:31:41.883968 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:31:41.884086 (MainThread): Using postgres connection "master".
2022-10-05 04:31:41.884179 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:31:41.893329 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:31:41.894260 (MainThread): On master: ROLLBACK
2022-10-05 04:31:41.894572 (MainThread): Using postgres connection "master".
2022-10-05 04:31:41.894683 (MainThread): On master: BEGIN
2022-10-05 04:31:41.895090 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:31:41.895214 (MainThread): On master: COMMIT
2022-10-05 04:31:41.895318 (MainThread): Using postgres connection "master".
2022-10-05 04:31:41.895413 (MainThread): On master: COMMIT
2022-10-05 04:31:41.895658 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:31:41.895778 (MainThread): On master: Close
2022-10-05 04:31:41.896005 (MainThread): 05:31:41 | Concurrency: 5 threads (target='dev')
2022-10-05 04:31:41.896138 (MainThread): 05:31:41 | 
2022-10-05 04:31:41.898504 (Thread-1): Began running node model.my_new_project.insert_tables
2022-10-05 04:31:41.898687 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:31:41.898956 (Thread-1): 05:31:41 | 1 of 3 START view model public.insert_tables......................... [RUN]
2022-10-05 04:31:41.899159 (Thread-2): 05:31:41 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:31:41.899442 (Thread-1): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:31:41.899629 (Thread-1): Compiling model.my_new_project.insert_tables
2022-10-05 04:31:41.899878 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.900925 (Thread-1): Writing injected SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:31:41.901087 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:31:41.902931 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:31:41.903325 (Thread-1): finished collecting timing info
2022-10-05 04:31:41.920872 (Thread-1): Writing runtime SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:31:41.921179 (Thread-2): finished collecting timing info
2022-10-05 04:31:41.933525 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:31:41.933762 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:31:41.933884 (Thread-1): On model.my_new_project.insert_tables: BEGIN
2022-10-05 04:31:41.934037 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:31:41.934289 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.934384 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:31:41.934469 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:31:41.941884 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:31:41.942076 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:31:41.942196 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:31:41.942315 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.942437 (Thread-1): On model.my_new_project.insert_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.insert_tables"} */

  create view "postgres"."public"."insert_tables__dbt_tmp" as (
    insert into customers(id,first_name,last_name,email,date_of_birth,current_job) values (1,"Emmanuel","Offisong","eo@yahoo.com",2022-03-05,"data engineer"),
(2,"Oduguwa","Damilola","dami@gmail.com",2022-01-01,"ml expert")
  );

2022-10-05 04:31:41.942545 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:31:41.942867 (Thread-1): Postgres error: syntax error at or near "insert"
LINE 4:     insert into customers(id,first_name,last_name,email,date...
            ^

2022-10-05 04:31:41.942988 (Thread-1): On model.my_new_project.insert_tables: ROLLBACK
2022-10-05 04:31:41.943350 (Thread-1): finished collecting timing info
2022-10-05 04:31:41.943466 (Thread-1): On model.my_new_project.insert_tables: Close
2022-10-05 04:31:41.944737 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:31:41.948705 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.948849 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:31:41.949334 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:31:41.950581 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.950682 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:31:41.951429 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:31:41.957793 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:31:41.957933 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.958046 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:31:41.943700 (Thread-1): Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers(id,first_name,last_name,email,date...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "insert"
LINE 4:     insert into customers(id,first_name,last_name,email,date...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers(id,first_name,last_name,email,date...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:31:41.959083 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5045bd-e947-45ad-841b-5a66929d552c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9383c0790>]}
2022-10-05 04:31:41.959302 (Thread-1): 05:31:41 | 1 of 3 ERROR creating view model public.insert_tables................ [ERROR in 0.06s]
2022-10-05 04:31:41.959410 (Thread-1): Finished running node model.my_new_project.insert_tables
2022-10-05 04:31:41.965493 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-10-05 04:31:41.969097 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:31:41.969219 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:31:41.971483 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:31:41.972168 (Thread-2): finished collecting timing info
2022-10-05 04:31:41.972287 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:31:41.972517 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5045bd-e947-45ad-841b-5a66929d552c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9382c6790>]}
2022-10-05 04:31:41.972723 (Thread-2): 05:31:41 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 04:31:41.972829 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:31:41.973252 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:31:41.973476 (Thread-4): 05:31:41 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:31:41.973735 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:31:41.973841 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:31:41.975216 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:31:41.975555 (Thread-4): finished collecting timing info
2022-10-05 04:31:41.977114 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:31:41.977430 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:31:41.977515 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:31:41.977600 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:31:41.984991 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:31:41.985090 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:31:41.985168 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:31:41.988030 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:31:41.989506 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:31:41.989613 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:31:41.990183 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:31:41.990919 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:31:41.991022 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:31:41.991107 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:31:41.991688 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:31:41.992673 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:31:41.992798 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:31:41.993028 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:31:41.993744 (Thread-4): finished collecting timing info
2022-10-05 04:31:41.993881 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:31:41.994160 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e5045bd-e947-45ad-841b-5a66929d552c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93833e970>]}
2022-10-05 04:31:41.994405 (Thread-4): 05:31:41 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:31:41.994540 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:31:41.995450 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:31:41.995604 (MainThread): Using postgres connection "master".
2022-10-05 04:31:41.995691 (MainThread): On master: BEGIN
2022-10-05 04:31:41.995787 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:31:42.007527 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:31:42.007707 (MainThread): On master: COMMIT
2022-10-05 04:31:42.007804 (MainThread): Using postgres connection "master".
2022-10-05 04:31:42.007894 (MainThread): On master: COMMIT
2022-10-05 04:31:42.008126 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:31:42.008237 (MainThread): On master: Close
2022-10-05 04:31:42.008506 (MainThread): 05:31:42 | 
2022-10-05 04:31:42.008626 (MainThread): 05:31:42 | Finished running 2 view models, 1 table model in 0.22s.
2022-10-05 04:31:42.008732 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:31:42.008816 (MainThread): Connection 'model.my_new_project.insert_tables' was properly closed.
2022-10-05 04:31:42.008898 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:31:42.008979 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:31:42.012549 (MainThread): 
2022-10-05 04:31:42.012798 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:31:42.012906 (MainThread): 
2022-10-05 04:31:42.013006 (MainThread): Database Error in model insert_tables (models/insert_tables.sql)
2022-10-05 04:31:42.013103 (MainThread):   syntax error at or near "insert"
2022-10-05 04:31:42.013192 (MainThread):   LINE 4:     insert into customers(id,first_name,last_name,email,date...
2022-10-05 04:31:42.013281 (MainThread):               ^
2022-10-05 04:31:42.013367 (MainThread):   compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:31:42.013465 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:31:42.013635 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93833cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93833c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe93833c0a0>]}
2022-10-05 04:31:42.013804 (MainThread): Flushing usage events
2022-10-05 04:33:54.003853 (MainThread): Running with dbt=0.21.1
2022-10-05 04:33:54.075786 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:33:54.076905 (MainThread): Tracking: tracking
2022-10-05 04:33:54.101777 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712a17b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712a13730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712a13d60>]}
2022-10-05 04:33:54.111103 (MainThread): Partial parsing not enabled
2022-10-05 04:33:54.119855 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:33:54.122668 (MainThread): Parsing macros/relations.sql
2022-10-05 04:33:54.123838 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:33:54.141296 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:33:54.142493 (MainThread): Parsing macros/core.sql
2022-10-05 04:33:54.145065 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:33:54.149983 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:33:54.157215 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:33:54.158378 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:33:54.170608 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:33:54.199254 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:33:54.216831 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:33:54.218024 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:33:54.225641 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:33:54.241795 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:33:54.252762 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:33:54.258889 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:33:54.264577 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:33:54.267205 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:33:54.268185 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:33:54.268822 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:33:54.269842 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:33:54.276136 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:33:54.277353 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:33:54.278990 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:33:54.280038 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:33:54.324318 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:33:54.325435 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:33:54.326193 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:33:54.327068 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:33:54.439615 (MainThread): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:33:54.447371 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.449873 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:33:54.467355 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:33:54.468506 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:33:54.469628 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:33:54.470832 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:33:54.481473 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11f5c4e4-4eb0-4f4c-b18e-a31c7b548e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712a9d0d0>]}
2022-10-05 04:33:54.484449 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:33:54.484744 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11f5c4e4-4eb0-4f4c-b18e-a31c7b548e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712a9d5b0>]}
2022-10-05 04:33:54.484903 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:33:54.485800 (MainThread): 
2022-10-05 04:33:54.486012 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:33:54.486663 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:33:54.493442 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:33:54.493621 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:33:54.493733 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:33:54.539982 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.05 seconds
2022-10-05 04:33:54.541707 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:33:54.542559 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:33:54.546813 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:33:54.546939 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:33:54.547042 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:33:54.555557 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:33:54.555692 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:33:54.555783 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:33:54.561077 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:33:54.562013 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:33:54.562317 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:33:54.565337 (MainThread): Using postgres connection "master".
2022-10-05 04:33:54.565461 (MainThread): On master: BEGIN
2022-10-05 04:33:54.565571 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:33:54.574987 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:33:54.575108 (MainThread): Using postgres connection "master".
2022-10-05 04:33:54.575210 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:33:54.584350 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:33:54.585305 (MainThread): On master: ROLLBACK
2022-10-05 04:33:54.585606 (MainThread): Using postgres connection "master".
2022-10-05 04:33:54.585720 (MainThread): On master: BEGIN
2022-10-05 04:33:54.586123 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:33:54.586253 (MainThread): On master: COMMIT
2022-10-05 04:33:54.586362 (MainThread): Using postgres connection "master".
2022-10-05 04:33:54.586458 (MainThread): On master: COMMIT
2022-10-05 04:33:54.586701 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:33:54.586820 (MainThread): On master: Close
2022-10-05 04:33:54.587048 (MainThread): 05:33:54 | Concurrency: 5 threads (target='dev')
2022-10-05 04:33:54.587183 (MainThread): 05:33:54 | 
2022-10-05 04:33:54.589373 (Thread-1): Began running node model.my_new_project.insert_tables
2022-10-05 04:33:54.589562 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:33:54.589782 (Thread-1): 05:33:54 | 1 of 3 START view model public.insert_tables......................... [RUN]
2022-10-05 04:33:54.589960 (Thread-2): 05:33:54 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:33:54.590228 (Thread-1): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:33:54.590477 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.590640 (Thread-1): Compiling model.my_new_project.insert_tables
2022-10-05 04:33:54.590753 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:33:54.591800 (Thread-1): Writing injected SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:33:54.593643 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:33:54.594229 (Thread-2): finished collecting timing info
2022-10-05 04:33:54.594393 (Thread-1): finished collecting timing info
2022-10-05 04:33:54.619531 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:33:54.624717 (Thread-1): Writing runtime SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:33:54.625106 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:33:54.625200 (Thread-1): On model.my_new_project.insert_tables: BEGIN
2022-10-05 04:33:54.625289 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:33:54.625482 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.625578 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:33:54.625666 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:33:54.633644 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:33:54.633807 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:33:54.633927 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.634023 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:33:54.634113 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:33:54.634204 (Thread-1): On model.my_new_project.insert_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.insert_tables"} */

  create view "postgres"."public"."insert_tables__dbt_tmp" as (
    insert into customers values (1,'Emmanuel','Offisong','eo@yahoo.com','2022-03-05','data engineer'),
(2,'Oduguwa','Damilola','dami@gmail.com','2022-01-01','ml expert')
  );

2022-10-05 04:33:54.634472 (Thread-1): Postgres error: syntax error at or near "insert"
LINE 4:     insert into customers values (1,'Emmanuel','Offisong','e...
            ^

2022-10-05 04:33:54.634567 (Thread-1): On model.my_new_project.insert_tables: ROLLBACK
2022-10-05 04:33:54.634957 (Thread-1): finished collecting timing info
2022-10-05 04:33:54.635079 (Thread-1): On model.my_new_project.insert_tables: Close
2022-10-05 04:33:54.636353 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:33:54.640355 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.640488 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:33:54.641087 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:33:54.642382 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.642479 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:33:54.643193 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:33:54.650277 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:33:54.650446 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.650547 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:33:54.635328 (Thread-1): Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers values (1,'Emmanuel','Offisong','e...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "insert"
LINE 4:     insert into customers values (1,'Emmanuel','Offisong','e...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers values (1,'Emmanuel','Offisong','e...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:33:54.651322 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f5c4e4-4eb0-4f4c-b18e-a31c7b548e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712ab67c0>]}
2022-10-05 04:33:54.651566 (Thread-1): 05:33:54 | 1 of 3 ERROR creating view model public.insert_tables................ [ERROR in 0.06s]
2022-10-05 04:33:54.651681 (Thread-1): Finished running node model.my_new_project.insert_tables
2022-10-05 04:33:54.657320 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-10-05 04:33:54.660617 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:33:54.660738 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:33:54.663161 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:33:54.664071 (Thread-2): finished collecting timing info
2022-10-05 04:33:54.664211 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:33:54.664487 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f5c4e4-4eb0-4f4c-b18e-a31c7b548e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712b508e0>]}
2022-10-05 04:33:54.664726 (Thread-2): 05:33:54 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 04:33:54.664845 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:33:54.665311 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:33:54.665561 (Thread-4): 05:33:54 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:33:54.665995 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:33:54.666144 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:33:54.667753 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:33:54.668050 (Thread-4): finished collecting timing info
2022-10-05 04:33:54.669463 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:33:54.669712 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:33:54.669806 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:33:54.669896 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:33:54.679225 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:33:54.679377 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:33:54.679466 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:33:54.681066 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:33:54.682789 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:33:54.682949 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:33:54.683477 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:33:54.684199 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:33:54.684298 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:33:54.684381 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:33:54.684877 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:33:54.685780 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:33:54.685883 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:33:54.686194 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:33:54.686834 (Thread-4): finished collecting timing info
2022-10-05 04:33:54.686956 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:33:54.687190 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11f5c4e4-4eb0-4f4c-b18e-a31c7b548e7f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712b37880>]}
2022-10-05 04:33:54.687411 (Thread-4): 05:33:54 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:33:54.687523 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:33:54.688240 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:33:54.688379 (MainThread): Using postgres connection "master".
2022-10-05 04:33:54.688468 (MainThread): On master: BEGIN
2022-10-05 04:33:54.688557 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:33:54.696237 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:33:54.696431 (MainThread): On master: COMMIT
2022-10-05 04:33:54.696517 (MainThread): Using postgres connection "master".
2022-10-05 04:33:54.696597 (MainThread): On master: COMMIT
2022-10-05 04:33:54.696765 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:33:54.696867 (MainThread): On master: Close
2022-10-05 04:33:54.697128 (MainThread): 05:33:54 | 
2022-10-05 04:33:54.697245 (MainThread): 05:33:54 | Finished running 2 view models, 1 table model in 0.21s.
2022-10-05 04:33:54.697351 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:33:54.697433 (MainThread): Connection 'model.my_new_project.insert_tables' was properly closed.
2022-10-05 04:33:54.697511 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:33:54.697587 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:33:54.700716 (MainThread): 
2022-10-05 04:33:54.700844 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:33:54.700943 (MainThread): 
2022-10-05 04:33:54.701040 (MainThread): Database Error in model insert_tables (models/insert_tables.sql)
2022-10-05 04:33:54.701130 (MainThread):   syntax error at or near "insert"
2022-10-05 04:33:54.701214 (MainThread):   LINE 4:     insert into customers values (1,'Emmanuel','Offisong','e...
2022-10-05 04:33:54.701297 (MainThread):               ^
2022-10-05 04:33:54.701380 (MainThread):   compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:33:54.701472 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:33:54.701616 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712acc100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712accf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd712acc0d0>]}
2022-10-05 04:33:54.701767 (MainThread): Flushing usage events
2022-10-05 04:34:16.747642 (MainThread): Running with dbt=0.21.1
2022-10-05 04:34:16.816163 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:34:16.818662 (MainThread): Tracking: tracking
2022-10-05 04:34:16.840752 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2213efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2213eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2213eac0>]}
2022-10-05 04:34:16.849177 (MainThread): Partial parsing not enabled
2022-10-05 04:34:16.858074 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:34:16.860681 (MainThread): Parsing macros/relations.sql
2022-10-05 04:34:16.861759 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:34:16.878377 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:34:16.879563 (MainThread): Parsing macros/core.sql
2022-10-05 04:34:16.882185 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:34:16.886910 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:34:16.893733 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:34:16.894862 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:34:16.906898 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:34:16.932993 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:34:16.949722 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:34:16.950904 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:34:16.958224 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:34:16.973255 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:34:16.983549 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:34:16.989287 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:34:16.994634 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:34:16.997239 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:34:16.998218 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:34:16.998833 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:34:16.999853 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:34:17.005920 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:34:17.007121 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:34:17.008765 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:34:17.009804 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:34:17.050997 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:34:17.052133 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:34:17.052886 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:34:17.053754 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:34:17.165943 (MainThread): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:34:17.173740 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.176227 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:34:17.193869 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:34:17.195026 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:34:17.196151 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:34:17.197366 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:34:17.206774 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aa39dde-c7e8-40ef-8a66-cfd25b6e3ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2224a070>]}
2022-10-05 04:34:17.209667 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:34:17.210019 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aa39dde-c7e8-40ef-8a66-cfd25b6e3ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd2224a550>]}
2022-10-05 04:34:17.210176 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:34:17.211082 (MainThread): 
2022-10-05 04:34:17.211309 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:34:17.211951 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:34:17.218826 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:34:17.219053 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:34:17.219161 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:34:17.274960 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-05 04:34:17.276533 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:34:17.277398 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:34:17.281734 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:34:17.281872 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:34:17.281983 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:34:17.291957 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:34:17.292104 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:34:17.292210 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:34:17.297574 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:34:17.298495 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:34:17.298783 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:34:17.301792 (MainThread): Using postgres connection "master".
2022-10-05 04:34:17.301918 (MainThread): On master: BEGIN
2022-10-05 04:34:17.302023 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:34:17.311640 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:34:17.311758 (MainThread): Using postgres connection "master".
2022-10-05 04:34:17.311854 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:34:17.320878 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:34:17.321784 (MainThread): On master: ROLLBACK
2022-10-05 04:34:17.322089 (MainThread): Using postgres connection "master".
2022-10-05 04:34:17.322201 (MainThread): On master: BEGIN
2022-10-05 04:34:17.322608 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:34:17.322733 (MainThread): On master: COMMIT
2022-10-05 04:34:17.322838 (MainThread): Using postgres connection "master".
2022-10-05 04:34:17.322935 (MainThread): On master: COMMIT
2022-10-05 04:34:17.323191 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:34:17.323302 (MainThread): On master: Close
2022-10-05 04:34:17.323518 (MainThread): 05:34:17 | Concurrency: 5 threads (target='dev')
2022-10-05 04:34:17.323641 (MainThread): 05:34:17 | 
2022-10-05 04:34:17.325856 (Thread-1): Began running node model.my_new_project.insert_tables
2022-10-05 04:34:17.326031 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:34:17.326249 (Thread-1): 05:34:17 | 1 of 3 START view model public.insert_tables......................... [RUN]
2022-10-05 04:34:17.326437 (Thread-2): 05:34:17 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:34:17.326754 (Thread-1): Acquiring new postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:34:17.326998 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.327174 (Thread-1): Compiling model.my_new_project.insert_tables
2022-10-05 04:34:17.327313 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:34:17.328367 (Thread-1): Writing injected SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:34:17.330253 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:34:17.330799 (Thread-1): finished collecting timing info
2022-10-05 04:34:17.330952 (Thread-2): finished collecting timing info
2022-10-05 04:34:17.348510 (Thread-1): Writing runtime SQL for node "model.my_new_project.insert_tables"
2022-10-05 04:34:17.360936 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:34:17.361384 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.361482 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:34:17.361574 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:34:17.361767 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:34:17.361868 (Thread-1): On model.my_new_project.insert_tables: BEGIN
2022-10-05 04:34:17.361957 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:34:17.369735 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:34:17.369981 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:34:17.370087 (Thread-1): Using postgres connection "model.my_new_project.insert_tables".
2022-10-05 04:34:17.370207 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.370321 (Thread-1): On model.my_new_project.insert_tables: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.insert_tables"} */

  create view "postgres"."public"."insert_tables__dbt_tmp" as (
    insert into customers values (3,'Emmanuel','Offisong','eo@yahoo.com','2022-03-05','data engineer'),
(3,'Oduguwa','Damilola','dami@gmail.com','2022-01-01','ml expert')
  );

2022-10-05 04:34:17.370427 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:34:17.370802 (Thread-1): Postgres error: syntax error at or near "insert"
LINE 4:     insert into customers values (3,'Emmanuel','Offisong','e...
            ^

2022-10-05 04:34:17.370928 (Thread-1): On model.my_new_project.insert_tables: ROLLBACK
2022-10-05 04:34:17.371323 (Thread-1): finished collecting timing info
2022-10-05 04:34:17.371444 (Thread-1): On model.my_new_project.insert_tables: Close
2022-10-05 04:34:17.372472 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:34:17.376359 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.376470 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:34:17.376846 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:34:17.378085 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.378182 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:34:17.378847 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:34:17.385297 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:34:17.385422 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.385508 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:34:17.371683 (Thread-1): Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers values (3,'Emmanuel','Offisong','e...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "insert"
LINE 4:     insert into customers values (3,'Emmanuel','Offisong','e...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model insert_tables (models/insert_tables.sql)
  syntax error at or near "insert"
  LINE 4:     insert into customers values (3,'Emmanuel','Offisong','e...
              ^
  compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:34:17.386623 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aa39dde-c7e8-40ef-8a66-cfd25b6e3ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd222569a0>]}
2022-10-05 04:34:17.386876 (Thread-1): 05:34:17 | 1 of 3 ERROR creating view model public.insert_tables................ [ERROR in 0.06s]
2022-10-05 04:34:17.387005 (Thread-1): Finished running node model.my_new_project.insert_tables
2022-10-05 04:34:17.392453 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-10-05 04:34:17.396295 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:34:17.396439 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:34:17.398790 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:34:17.399521 (Thread-2): finished collecting timing info
2022-10-05 04:34:17.399651 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:34:17.399914 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aa39dde-c7e8-40ef-8a66-cfd25b6e3ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd22270370>]}
2022-10-05 04:34:17.400148 (Thread-2): 05:34:17 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 04:34:17.400264 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:34:17.400680 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:34:17.400912 (Thread-4): 05:34:17 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:34:17.401151 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:34:17.401253 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:34:17.402879 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:34:17.403336 (Thread-4): finished collecting timing info
2022-10-05 04:34:17.404788 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:34:17.405044 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:34:17.405133 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:34:17.405221 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:34:17.412671 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:34:17.412777 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:34:17.412871 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:34:17.414817 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:34:17.416227 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:34:17.416341 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:34:17.416857 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:34:17.417585 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:34:17.417688 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:34:17.417777 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:34:17.418606 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:34:17.419579 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:34:17.419713 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:34:17.420103 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:34:17.420810 (Thread-4): finished collecting timing info
2022-10-05 04:34:17.420931 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:34:17.421179 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aa39dde-c7e8-40ef-8a66-cfd25b6e3ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd22279640>]}
2022-10-05 04:34:17.421409 (Thread-4): 05:34:17 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:34:17.421526 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:34:17.422734 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:34:17.422988 (MainThread): Using postgres connection "master".
2022-10-05 04:34:17.423073 (MainThread): On master: BEGIN
2022-10-05 04:34:17.423167 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:34:17.432788 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:34:17.432904 (MainThread): On master: COMMIT
2022-10-05 04:34:17.432993 (MainThread): Using postgres connection "master".
2022-10-05 04:34:17.433076 (MainThread): On master: COMMIT
2022-10-05 04:34:17.433311 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:34:17.433413 (MainThread): On master: Close
2022-10-05 04:34:17.433643 (MainThread): 05:34:17 | 
2022-10-05 04:34:17.433754 (MainThread): 05:34:17 | Finished running 2 view models, 1 table model in 0.22s.
2022-10-05 04:34:17.433861 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:34:17.433944 (MainThread): Connection 'model.my_new_project.insert_tables' was properly closed.
2022-10-05 04:34:17.434028 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:34:17.434107 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:34:17.437484 (MainThread): 
2022-10-05 04:34:17.437643 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:34:17.437749 (MainThread): 
2022-10-05 04:34:17.437850 (MainThread): Database Error in model insert_tables (models/insert_tables.sql)
2022-10-05 04:34:17.437944 (MainThread):   syntax error at or near "insert"
2022-10-05 04:34:17.438032 (MainThread):   LINE 4:     insert into customers values (3,'Emmanuel','Offisong','e...
2022-10-05 04:34:17.438119 (MainThread):               ^
2022-10-05 04:34:17.438205 (MainThread):   compiled SQL at target/run/my_new_project/models/insert_tables.sql
2022-10-05 04:34:17.438305 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:34:17.438514 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd223bdfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd223b71c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd22264310>]}
2022-10-05 04:34:17.438720 (MainThread): Flushing usage events
2022-10-05 04:36:11.151809 (MainThread): Running with dbt=0.21.1
2022-10-05 04:36:11.226361 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:36:11.227454 (MainThread): Tracking: tracking
2022-10-05 04:36:11.253168 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc0057b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc0053130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfc00536a0>]}
2022-10-05 04:36:11.261881 (MainThread): Partial parsing not enabled
2022-10-05 04:36:11.271341 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:36:11.274052 (MainThread): Parsing macros/relations.sql
2022-10-05 04:36:11.275124 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:36:11.291957 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:36:11.293125 (MainThread): Parsing macros/core.sql
2022-10-05 04:36:11.295649 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:36:11.300461 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:36:11.307497 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:36:11.308633 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:36:11.320667 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:36:11.348246 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:36:11.365339 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:36:11.366537 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:36:11.374072 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:36:11.389649 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:36:11.400242 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:36:11.406276 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:36:11.411821 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:36:11.414418 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:36:11.415388 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:36:11.415998 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:36:11.417059 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:36:11.423229 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:36:11.424436 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:36:11.426065 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:36:11.427100 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:36:11.469415 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:36:11.470520 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:36:11.471268 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:36:11.472132 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:36:11.584022 (MainThread): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:11.591677 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.594162 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:11.611701 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:11.612837 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:11.613944 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:11.615149 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:11.625597 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd31cac5d-d2d4-4647-8430-b51b8787d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb29de070>]}
2022-10-05 04:36:11.628905 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:36:11.629214 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd31cac5d-d2d4-4647-8430-b51b8787d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb29de550>]}
2022-10-05 04:36:11.629367 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:36:11.630262 (MainThread): 
2022-10-05 04:36:11.630470 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:36:11.631095 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:36:11.637963 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:36:11.638157 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:36:11.638272 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:36:11.701606 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-05 04:36:11.703234 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:36:11.704094 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:36:11.708385 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:36:11.708508 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:36:11.708616 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:36:11.718068 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:11.718192 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:36:11.718292 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:36:11.723885 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:36:11.724775 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:36:11.725068 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:36:11.727954 (MainThread): Using postgres connection "master".
2022-10-05 04:36:11.728079 (MainThread): On master: BEGIN
2022-10-05 04:36:11.728184 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:36:11.738311 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:11.738429 (MainThread): Using postgres connection "master".
2022-10-05 04:36:11.738522 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:36:11.747867 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:36:11.748768 (MainThread): On master: ROLLBACK
2022-10-05 04:36:11.749068 (MainThread): Using postgres connection "master".
2022-10-05 04:36:11.749178 (MainThread): On master: BEGIN
2022-10-05 04:36:11.749607 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:36:11.749722 (MainThread): On master: COMMIT
2022-10-05 04:36:11.749822 (MainThread): Using postgres connection "master".
2022-10-05 04:36:11.749916 (MainThread): On master: COMMIT
2022-10-05 04:36:11.750181 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:36:11.750295 (MainThread): On master: Close
2022-10-05 04:36:11.750512 (MainThread): 05:36:11 | Concurrency: 5 threads (target='dev')
2022-10-05 04:36:11.750634 (MainThread): 05:36:11 | 
2022-10-05 04:36:11.752896 (Thread-1): Began running node model.my_new_project.first_customer_cte
2022-10-05 04:36:11.753069 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:36:11.753279 (Thread-1): 05:36:11 | 1 of 3 START view model public.first_customer_cte.................... [RUN]
2022-10-05 04:36:11.753447 (Thread-2): 05:36:11 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:36:11.753734 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:11.753994 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.754148 (Thread-1): Compiling model.my_new_project.first_customer_cte
2022-10-05 04:36:11.754275 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:36:11.755325 (Thread-1): Writing injected SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 04:36:11.757076 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:36:11.757541 (Thread-1): finished collecting timing info
2022-10-05 04:36:11.770090 (Thread-2): finished collecting timing info
2022-10-05 04:36:11.775361 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 04:36:11.787831 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:36:11.788775 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.788871 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:36:11.788965 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:36:11.789162 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:11.789262 (Thread-1): On model.my_new_project.first_customer_cte: BEGIN
2022-10-05 04:36:11.789348 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:36:11.796409 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:11.796514 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:11.796604 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.796696 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:11.796783 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:36:11.796871 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */

  create view "postgres"."public"."first_customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers where id=1
)
  );

2022-10-05 04:36:11.797128 (Thread-1): Postgres error: syntax error at or near ")"
LINE 7:   );
          ^

2022-10-05 04:36:11.797213 (Thread-1): On model.my_new_project.first_customer_cte: ROLLBACK
2022-10-05 04:36:11.797554 (Thread-1): finished collecting timing info
2022-10-05 04:36:11.797672 (Thread-1): On model.my_new_project.first_customer_cte: Close
2022-10-05 04:36:11.799865 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:36:11.804248 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.804461 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:36:11.804980 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:36:11.806387 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.806517 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:36:11.807031 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:36:11.813675 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:36:11.813804 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.813889 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:36:11.797891 (Thread-1): Database Error in model first_customer_cte (models/first_customer_cte.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 7:   );
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model first_customer_cte (models/first_customer_cte.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
2022-10-05 04:36:11.814383 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31cac5d-d2d4-4647-8430-b51b8787d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb2a887f0>]}
2022-10-05 04:36:11.814628 (Thread-1): 05:36:11 | 1 of 3 ERROR creating view model public.first_customer_cte........... [ERROR in 0.06s]
2022-10-05 04:36:11.814723 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:36:11.814840 (Thread-1): Finished running node model.my_new_project.first_customer_cte
2022-10-05 04:36:11.817811 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:11.818099 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:36:11.820566 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:36:11.821578 (Thread-2): finished collecting timing info
2022-10-05 04:36:11.821785 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:36:11.822160 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31cac5d-d2d4-4647-8430-b51b8787d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb2a0e970>]}
2022-10-05 04:36:11.822394 (Thread-2): 05:36:11 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 04:36:11.822509 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:36:11.822895 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:36:11.823102 (Thread-4): 05:36:11 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:36:11.823353 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:11.823508 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:36:11.824916 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:36:11.825185 (Thread-4): finished collecting timing info
2022-10-05 04:36:11.826446 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:36:11.826668 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:11.826754 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:36:11.826839 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:36:11.834591 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:11.834716 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:11.834800 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:36:11.837911 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:36:11.839675 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:11.839787 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:36:11.840165 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:36:11.840911 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:36:11.841013 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:11.841094 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:36:11.841570 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:36:11.842426 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:11.842524 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:36:11.842744 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:36:11.843350 (Thread-4): finished collecting timing info
2022-10-05 04:36:11.843465 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:36:11.843690 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31cac5d-d2d4-4647-8430-b51b8787d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb2a0e970>]}
2022-10-05 04:36:11.843895 (Thread-4): 05:36:11 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:36:11.844003 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:36:11.844777 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:36:11.844896 (MainThread): Using postgres connection "master".
2022-10-05 04:36:11.844973 (MainThread): On master: BEGIN
2022-10-05 04:36:11.845052 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:36:11.853750 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:11.853957 (MainThread): On master: COMMIT
2022-10-05 04:36:11.854054 (MainThread): Using postgres connection "master".
2022-10-05 04:36:11.854135 (MainThread): On master: COMMIT
2022-10-05 04:36:11.854397 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:36:11.854502 (MainThread): On master: Close
2022-10-05 04:36:11.854895 (MainThread): 05:36:11 | 
2022-10-05 04:36:11.855027 (MainThread): 05:36:11 | Finished running 2 view models, 1 table model in 0.22s.
2022-10-05 04:36:11.855132 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:36:11.855211 (MainThread): Connection 'model.my_new_project.first_customer_cte' was properly closed.
2022-10-05 04:36:11.855292 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:36:11.855368 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:36:11.858300 (MainThread): 
2022-10-05 04:36:11.858419 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:36:11.858523 (MainThread): 
2022-10-05 04:36:11.858618 (MainThread): Database Error in model first_customer_cte (models/first_customer_cte.sql)
2022-10-05 04:36:11.858705 (MainThread):   syntax error at or near ")"
2022-10-05 04:36:11.858789 (MainThread):   LINE 7:   );
2022-10-05 04:36:11.858871 (MainThread):             ^
2022-10-05 04:36:11.858952 (MainThread):   compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
2022-10-05 04:36:11.859043 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:36:11.859190 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb2a06160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb2a06730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfb2a06fa0>]}
2022-10-05 04:36:11.859341 (MainThread): Flushing usage events
2022-10-05 04:36:25.807324 (MainThread): Running with dbt=0.21.1
2022-10-05 04:36:25.878724 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:36:25.879854 (MainThread): Tracking: tracking
2022-10-05 04:36:25.901038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b2938dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b2934460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4b2934d60>]}
2022-10-05 04:36:25.910106 (MainThread): Partial parsing not enabled
2022-10-05 04:36:25.918681 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:36:25.921271 (MainThread): Parsing macros/relations.sql
2022-10-05 04:36:25.922304 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:36:25.938106 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:36:25.939229 (MainThread): Parsing macros/core.sql
2022-10-05 04:36:25.941690 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:36:25.946279 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:36:25.952948 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:36:25.954034 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:36:25.971836 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:36:25.997291 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:36:26.013368 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:36:26.014534 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:36:26.021647 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:36:26.035952 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:36:26.046696 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:36:26.052391 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:36:26.057558 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:36:26.060117 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:36:26.061074 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:36:26.061690 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:36:26.062686 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:36:26.068601 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:36:26.069787 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:36:26.071373 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:36:26.072390 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:36:26.111265 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:36:26.112343 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:36:26.113082 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:36:26.113930 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:36:26.225893 (MainThread): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:26.233556 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.236038 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:26.253706 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:26.254857 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:26.255964 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:26.257170 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:36:26.266554 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49dcbc7e-89c2-4d83-9a69-342be8519bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a06180a0>]}
2022-10-05 04:36:26.269673 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:36:26.270279 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49dcbc7e-89c2-4d83-9a69-342be8519bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a0618580>]}
2022-10-05 04:36:26.270446 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:36:26.271313 (MainThread): 
2022-10-05 04:36:26.271520 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:36:26.272177 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:36:26.278473 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:36:26.278603 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:36:26.278704 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:36:26.310773 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.03 seconds
2022-10-05 04:36:26.312095 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:36:26.312796 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:36:26.316448 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:36:26.316599 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:36:26.316709 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:36:26.324590 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:26.324774 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:36:26.324864 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:36:26.329001 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.00 seconds
2022-10-05 04:36:26.329821 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:36:26.330072 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:36:26.332792 (MainThread): Using postgres connection "master".
2022-10-05 04:36:26.332910 (MainThread): On master: BEGIN
2022-10-05 04:36:26.333005 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:36:26.342347 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:26.342477 (MainThread): Using postgres connection "master".
2022-10-05 04:36:26.342562 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:36:26.353159 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:36:26.354062 (MainThread): On master: ROLLBACK
2022-10-05 04:36:26.354391 (MainThread): Using postgres connection "master".
2022-10-05 04:36:26.354487 (MainThread): On master: BEGIN
2022-10-05 04:36:26.354882 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:36:26.354985 (MainThread): On master: COMMIT
2022-10-05 04:36:26.355077 (MainThread): Using postgres connection "master".
2022-10-05 04:36:26.355158 (MainThread): On master: COMMIT
2022-10-05 04:36:26.355387 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:36:26.355487 (MainThread): On master: Close
2022-10-05 04:36:26.355702 (MainThread): 05:36:26 | Concurrency: 5 threads (target='dev')
2022-10-05 04:36:26.355817 (MainThread): 05:36:26 | 
2022-10-05 04:36:26.357919 (Thread-1): Began running node model.my_new_project.first_customer_cte
2022-10-05 04:36:26.358077 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:36:26.358310 (Thread-1): 05:36:26 | 1 of 3 START view model public.first_customer_cte.................... [RUN]
2022-10-05 04:36:26.358493 (Thread-2): 05:36:26 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:36:26.358778 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:26.359073 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.359252 (Thread-1): Compiling model.my_new_project.first_customer_cte
2022-10-05 04:36:26.359378 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:36:26.360457 (Thread-1): Writing injected SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 04:36:26.362185 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:36:26.362794 (Thread-1): finished collecting timing info
2022-10-05 04:36:26.362968 (Thread-2): finished collecting timing info
2022-10-05 04:36:26.386867 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 04:36:26.392498 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:36:26.392838 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:26.392935 (Thread-1): On model.my_new_project.first_customer_cte: BEGIN
2022-10-05 04:36:26.393048 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.393140 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:36:26.393227 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:36:26.393401 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:36:26.401433 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:26.401643 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:26.401751 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:36:26.401842 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.401931 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */

  create view "postgres"."public"."first_customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers where id=1
);
  );

2022-10-05 04:36:26.402018 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:36:26.402352 (Thread-1): Postgres error: syntax error at or near ";"
LINE 6: );
         ^

2022-10-05 04:36:26.402448 (Thread-1): On model.my_new_project.first_customer_cte: ROLLBACK
2022-10-05 04:36:26.402832 (Thread-1): finished collecting timing info
2022-10-05 04:36:26.402954 (Thread-1): On model.my_new_project.first_customer_cte: Close
2022-10-05 04:36:26.404369 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:36:26.408210 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.408317 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:36:26.408640 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:36:26.409917 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.410015 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:36:26.410768 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:36:26.417141 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:36:26.417257 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.417346 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:36:26.403183 (Thread-1): Database Error in model first_customer_cte (models/first_customer_cte.sql)
  syntax error at or near ";"
  LINE 6: );
           ^
  compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 6: );
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model first_customer_cte (models/first_customer_cte.sql)
  syntax error at or near ";"
  LINE 6: );
           ^
  compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
2022-10-05 04:36:26.418354 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49dcbc7e-89c2-4d83-9a69-342be8519bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a0631cd0>]}
2022-10-05 04:36:26.418620 (Thread-1): 05:36:26 | 1 of 3 ERROR creating view model public.first_customer_cte........... [ERROR in 0.06s]
2022-10-05 04:36:26.418738 (Thread-1): Finished running node model.my_new_project.first_customer_cte
2022-10-05 04:36:26.425000 (Thread-2): SQL status: COMMIT in 0.01 seconds
2022-10-05 04:36:26.428606 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:36:26.428720 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:36:26.430392 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:36:26.431081 (Thread-2): finished collecting timing info
2022-10-05 04:36:26.431198 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:36:26.431432 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49dcbc7e-89c2-4d83-9a69-342be8519bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a065cd60>]}
2022-10-05 04:36:26.431637 (Thread-2): 05:36:26 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 04:36:26.431742 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:36:26.432133 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:36:26.432340 (Thread-4): 05:36:26 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:36:26.432554 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:26.432656 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:36:26.434051 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:36:26.434397 (Thread-4): finished collecting timing info
2022-10-05 04:36:26.436081 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:36:26.436409 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:26.436495 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:36:26.436583 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:36:26.443726 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:26.443826 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:26.443903 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:36:26.446557 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:36:26.447886 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:26.447987 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:36:26.448625 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:36:26.449317 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:36:26.449416 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:26.449496 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:36:26.449864 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:36:26.450769 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:36:26.450873 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:36:26.451153 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:36:26.451896 (Thread-4): finished collecting timing info
2022-10-05 04:36:26.452022 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:36:26.452273 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49dcbc7e-89c2-4d83-9a69-342be8519bfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a05e60a0>]}
2022-10-05 04:36:26.452505 (Thread-4): 05:36:26 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:36:26.452625 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:36:26.453772 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:36:26.454017 (MainThread): Using postgres connection "master".
2022-10-05 04:36:26.454106 (MainThread): On master: BEGIN
2022-10-05 04:36:26.454200 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:36:26.462943 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:36:26.463066 (MainThread): On master: COMMIT
2022-10-05 04:36:26.463150 (MainThread): Using postgres connection "master".
2022-10-05 04:36:26.463228 (MainThread): On master: COMMIT
2022-10-05 04:36:26.463495 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:36:26.463595 (MainThread): On master: Close
2022-10-05 04:36:26.463810 (MainThread): 05:36:26 | 
2022-10-05 04:36:26.463915 (MainThread): 05:36:26 | Finished running 2 view models, 1 table model in 0.19s.
2022-10-05 04:36:26.464011 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:36:26.464090 (MainThread): Connection 'model.my_new_project.first_customer_cte' was properly closed.
2022-10-05 04:36:26.464168 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:36:26.464242 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:36:26.467208 (MainThread): 
2022-10-05 04:36:26.467360 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:36:26.467458 (MainThread): 
2022-10-05 04:36:26.467551 (MainThread): Database Error in model first_customer_cte (models/first_customer_cte.sql)
2022-10-05 04:36:26.467637 (MainThread):   syntax error at or near ";"
2022-10-05 04:36:26.467719 (MainThread):   LINE 6: );
2022-10-05 04:36:26.467800 (MainThread):            ^
2022-10-05 04:36:26.467880 (MainThread):   compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
2022-10-05 04:36:26.467970 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:36:26.468132 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a0644100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a06447c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4a0644f70>]}
2022-10-05 04:36:26.468350 (MainThread): Flushing usage events
2022-10-05 04:38:41.996195 (MainThread): Running with dbt=0.21.1
2022-10-05 04:38:42.065039 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 04:38:42.066255 (MainThread): Tracking: tracking
2022-10-05 04:38:42.092525 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faca2988b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faca28ce7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faca2984d60>]}
2022-10-05 04:38:42.101556 (MainThread): Partial parsing not enabled
2022-10-05 04:38:42.110272 (MainThread): Parsing macros/catalog.sql
2022-10-05 04:38:42.112923 (MainThread): Parsing macros/relations.sql
2022-10-05 04:38:42.114002 (MainThread): Parsing macros/adapters.sql
2022-10-05 04:38:42.130135 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 04:38:42.131265 (MainThread): Parsing macros/core.sql
2022-10-05 04:38:42.133756 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 04:38:42.138437 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 04:38:42.145182 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 04:38:42.146287 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 04:38:42.158025 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 04:38:42.184449 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 04:38:42.200910 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 04:38:42.202083 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 04:38:42.209389 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 04:38:42.224227 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 04:38:42.234351 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 04:38:42.240222 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 04:38:42.245667 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 04:38:42.248219 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 04:38:42.249179 (MainThread): Parsing macros/etc/query.sql
2022-10-05 04:38:42.249787 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 04:38:42.250795 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 04:38:42.256741 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 04:38:42.257931 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 04:38:42.259526 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 04:38:42.260553 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 04:38:42.300786 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 04:38:42.301881 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 04:38:42.302633 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 04:38:42.303490 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 04:38:42.415461 (MainThread): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:38:42.423158 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.425645 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:38:42.443223 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:38:42.444374 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:38:42.445469 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:38:42.446670 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 04:38:42.457336 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '228f94d9-50bc-4d07-aecf-4e5c1a281b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac801b10d0>]}
2022-10-05 04:38:42.460195 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 04:38:42.460498 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '228f94d9-50bc-4d07-aecf-4e5c1a281b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac801b1580>]}
2022-10-05 04:38:42.460650 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 04:38:42.461533 (MainThread): 
2022-10-05 04:38:42.461745 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:38:42.462369 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 04:38:42.469305 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 04:38:42.469502 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 04:38:42.469618 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 04:38:42.517292 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.05 seconds
2022-10-05 04:38:42.518842 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 04:38:42.519689 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 04:38:42.524033 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:38:42.524154 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 04:38:42.524253 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 04:38:42.533735 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:38:42.533851 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 04:38:42.533953 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 04:38:42.539354 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 04:38:42.540227 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 04:38:42.540653 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 04:38:42.543647 (MainThread): Using postgres connection "master".
2022-10-05 04:38:42.543768 (MainThread): On master: BEGIN
2022-10-05 04:38:42.543870 (MainThread): Opening a new connection, currently in state init
2022-10-05 04:38:42.553403 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:38:42.553522 (MainThread): Using postgres connection "master".
2022-10-05 04:38:42.553615 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 04:38:42.562824 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 04:38:42.563748 (MainThread): On master: ROLLBACK
2022-10-05 04:38:42.564054 (MainThread): Using postgres connection "master".
2022-10-05 04:38:42.564163 (MainThread): On master: BEGIN
2022-10-05 04:38:42.564567 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 04:38:42.564682 (MainThread): On master: COMMIT
2022-10-05 04:38:42.564783 (MainThread): Using postgres connection "master".
2022-10-05 04:38:42.564878 (MainThread): On master: COMMIT
2022-10-05 04:38:42.565121 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:38:42.565240 (MainThread): On master: Close
2022-10-05 04:38:42.565471 (MainThread): 05:38:42 | Concurrency: 5 threads (target='dev')
2022-10-05 04:38:42.565605 (MainThread): 05:38:42 | 
2022-10-05 04:38:42.567738 (Thread-1): Began running node model.my_new_project.first_customer_cte
2022-10-05 04:38:42.567917 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 04:38:42.568133 (Thread-1): 05:38:42 | 1 of 3 START view model public.first_customer_cte.................... [RUN]
2022-10-05 04:38:42.568338 (Thread-2): 05:38:42 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 04:38:42.568618 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:38:42.568846 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.568985 (Thread-1): Compiling model.my_new_project.first_customer_cte
2022-10-05 04:38:42.569148 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 04:38:42.570245 (Thread-1): Writing injected SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 04:38:42.572010 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:38:42.572466 (Thread-1): finished collecting timing info
2022-10-05 04:38:42.572621 (Thread-2): finished collecting timing info
2022-10-05 04:38:42.590650 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 04:38:42.603115 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 04:38:42.603531 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:38:42.603627 (Thread-1): On model.my_new_project.first_customer_cte: BEGIN
2022-10-05 04:38:42.603720 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 04:38:42.603915 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.604018 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 04:38:42.604106 (Thread-2): Opening a new connection, currently in state init
2022-10-05 04:38:42.611785 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:38:42.611900 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:38:42.611997 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.612090 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 04:38:42.612180 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 04:38:42.612273 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */

  create view "postgres"."public"."first_customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers where id=1
);
  );

2022-10-05 04:38:42.612670 (Thread-1): Postgres error: syntax error at or near ";"
LINE 6: );
         ^

2022-10-05 04:38:42.612757 (Thread-1): On model.my_new_project.first_customer_cte: ROLLBACK
2022-10-05 04:38:42.613161 (Thread-1): finished collecting timing info
2022-10-05 04:38:42.613277 (Thread-1): On model.my_new_project.first_customer_cte: Close
2022-10-05 04:38:42.615721 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 04:38:42.620080 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.620275 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 04:38:42.621012 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:38:42.622405 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.622503 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 04:38:42.613503 (Thread-1): Database Error in model first_customer_cte (models/first_customer_cte.sql)
  syntax error at or near ";"
  LINE 6: );
           ^
  compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 6: );
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model first_customer_cte (models/first_customer_cte.sql)
  syntax error at or near ";"
  LINE 6: );
           ^
  compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
2022-10-05 04:38:42.622942 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228f94d9-50bc-4d07-aecf-4e5c1a281b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac802608e0>]}
2022-10-05 04:38:42.623171 (Thread-1): 05:38:42 | 1 of 3 ERROR creating view model public.first_customer_cte........... [ERROR in 0.05s]
2022-10-05 04:38:42.623268 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:38:42.623399 (Thread-1): Finished running node model.my_new_project.first_customer_cte
2022-10-05 04:38:42.630214 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:38:42.630446 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.630534 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 04:38:42.631084 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:38:42.634120 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 04:38:42.634288 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 04:38:42.636751 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 04:38:42.637886 (Thread-2): finished collecting timing info
2022-10-05 04:38:42.638088 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 04:38:42.638389 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228f94d9-50bc-4d07-aecf-4e5c1a281b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac80277370>]}
2022-10-05 04:38:42.638608 (Thread-2): 05:38:42 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 04:38:42.638716 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 04:38:42.639156 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 04:38:42.639318 (Thread-4): 05:38:42 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 04:38:42.639569 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:38:42.639671 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 04:38:42.641044 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:38:42.641344 (Thread-4): finished collecting timing info
2022-10-05 04:38:42.642608 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 04:38:42.642828 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:38:42.642909 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 04:38:42.642989 (Thread-4): Opening a new connection, currently in state init
2022-10-05 04:38:42.650141 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:38:42.650264 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:38:42.650348 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 04:38:42.652074 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 04:38:42.653633 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:38:42.653788 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 04:38:42.654254 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 04:38:42.655148 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:38:42.655240 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:38:42.655314 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 04:38:42.655802 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:38:42.656669 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 04:38:42.656763 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 04:38:42.657100 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 04:38:42.657711 (Thread-4): finished collecting timing info
2022-10-05 04:38:42.657820 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 04:38:42.658051 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '228f94d9-50bc-4d07-aecf-4e5c1a281b31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faca29e8e20>]}
2022-10-05 04:38:42.658257 (Thread-4): 05:38:42 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 04:38:42.658362 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 04:38:42.659191 (MainThread): Acquiring new postgres connection "master".
2022-10-05 04:38:42.659307 (MainThread): Using postgres connection "master".
2022-10-05 04:38:42.659383 (MainThread): On master: BEGIN
2022-10-05 04:38:42.659461 (MainThread): Opening a new connection, currently in state closed
2022-10-05 04:38:42.666805 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 04:38:42.666954 (MainThread): On master: COMMIT
2022-10-05 04:38:42.667048 (MainThread): Using postgres connection "master".
2022-10-05 04:38:42.667129 (MainThread): On master: COMMIT
2022-10-05 04:38:42.667351 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 04:38:42.667455 (MainThread): On master: Close
2022-10-05 04:38:42.667705 (MainThread): 05:38:42 | 
2022-10-05 04:38:42.667814 (MainThread): 05:38:42 | Finished running 2 view models, 1 table model in 0.21s.
2022-10-05 04:38:42.667914 (MainThread): Connection 'master' was properly closed.
2022-10-05 04:38:42.667993 (MainThread): Connection 'model.my_new_project.first_customer_cte' was properly closed.
2022-10-05 04:38:42.668071 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 04:38:42.668146 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 04:38:42.671605 (MainThread): 
2022-10-05 04:38:42.671757 (MainThread): Completed with 1 error and 0 warnings:
2022-10-05 04:38:42.671850 (MainThread): 
2022-10-05 04:38:42.671941 (MainThread): Database Error in model first_customer_cte (models/first_customer_cte.sql)
2022-10-05 04:38:42.672028 (MainThread):   syntax error at or near ";"
2022-10-05 04:38:42.672110 (MainThread):   LINE 6: );
2022-10-05 04:38:42.672191 (MainThread):            ^
2022-10-05 04:38:42.672272 (MainThread):   compiled SQL at target/run/my_new_project/models/first_customer_cte.sql
2022-10-05 04:38:42.672363 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-05 04:38:42.672512 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac801df100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac801dff40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac801dffa0>]}
2022-10-05 04:38:42.672669 (MainThread): Flushing usage events
2022-10-05 05:00:23.274805 (MainThread): Running with dbt=0.21.1
2022-10-05 05:00:23.347279 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 05:00:23.348452 (MainThread): Tracking: tracking
2022-10-05 05:00:23.374397 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdabafb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdababee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdababa00>]}
2022-10-05 05:00:23.383155 (MainThread): Partial parsing not enabled
2022-10-05 05:00:23.392429 (MainThread): Parsing macros/catalog.sql
2022-10-05 05:00:23.395091 (MainThread): Parsing macros/relations.sql
2022-10-05 05:00:23.396141 (MainThread): Parsing macros/adapters.sql
2022-10-05 05:00:23.412772 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 05:00:23.413929 (MainThread): Parsing macros/core.sql
2022-10-05 05:00:23.416449 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 05:00:23.421198 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 05:00:23.428171 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 05:00:23.429300 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 05:00:23.441203 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 05:00:23.468411 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 05:00:23.485292 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 05:00:23.486465 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 05:00:23.493877 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 05:00:23.509261 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 05:00:23.519694 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 05:00:23.525659 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 05:00:23.531167 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 05:00:23.533753 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 05:00:23.534716 (MainThread): Parsing macros/etc/query.sql
2022-10-05 05:00:23.535324 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 05:00:23.536333 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 05:00:23.542418 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 05:00:23.543615 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 05:00:23.545230 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 05:00:23.546269 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 05:00:23.588286 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 05:00:23.589390 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 05:00:23.590141 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 05:00:23.591002 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 05:00:23.703162 (MainThread): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:00:23.710890 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.713377 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:00:23.730897 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:00:23.732037 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:00:23.733145 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:00:23.734353 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:00:23.744691 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3c4f38a-443c-40a2-a566-deab175c9bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdaca9cd0>]}
2022-10-05 05:00:23.747826 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 05:00:23.748136 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3c4f38a-443c-40a2-a566-deab175c9bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdac7f2e0>]}
2022-10-05 05:00:23.748299 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 05:00:23.749213 (MainThread): 
2022-10-05 05:00:23.749423 (MainThread): Acquiring new postgres connection "master".
2022-10-05 05:00:23.750098 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 05:00:23.756973 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 05:00:23.757359 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 05:00:23.757502 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 05:00:23.816692 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-05 05:00:23.818248 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 05:00:23.819168 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 05:00:23.823773 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 05:00:23.823936 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 05:00:23.824049 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 05:00:23.834040 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:00:23.834176 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 05:00:23.834288 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 05:00:23.839992 (ThreadPoolExecutor-1_0): SQL status: SELECT 3 in 0.01 seconds
2022-10-05 05:00:23.840975 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 05:00:23.841247 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 05:00:23.844412 (MainThread): Using postgres connection "master".
2022-10-05 05:00:23.844542 (MainThread): On master: BEGIN
2022-10-05 05:00:23.844649 (MainThread): Opening a new connection, currently in state init
2022-10-05 05:00:23.854248 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:00:23.854369 (MainThread): Using postgres connection "master".
2022-10-05 05:00:23.854464 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 05:00:23.863108 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-05 05:00:23.864034 (MainThread): On master: ROLLBACK
2022-10-05 05:00:23.864318 (MainThread): Using postgres connection "master".
2022-10-05 05:00:23.864430 (MainThread): On master: BEGIN
2022-10-05 05:00:23.864798 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 05:00:23.864923 (MainThread): On master: COMMIT
2022-10-05 05:00:23.865026 (MainThread): Using postgres connection "master".
2022-10-05 05:00:23.865122 (MainThread): On master: COMMIT
2022-10-05 05:00:23.865343 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:00:23.865465 (MainThread): On master: Close
2022-10-05 05:00:23.865693 (MainThread): 06:00:23 | Concurrency: 5 threads (target='dev')
2022-10-05 05:00:23.865816 (MainThread): 06:00:23 | 
2022-10-05 05:00:23.868095 (Thread-1): Began running node model.my_new_project.first_customer_cte
2022-10-05 05:00:23.868259 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 05:00:23.868513 (Thread-1): 06:00:23 | 1 of 3 START view model public.first_customer_cte.................... [RUN]
2022-10-05 05:00:23.868709 (Thread-2): 06:00:23 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 05:00:23.869020 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:00:23.869440 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.869593 (Thread-1): Compiling model.my_new_project.first_customer_cte
2022-10-05 05:00:23.869735 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 05:00:23.870825 (Thread-1): Writing injected SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 05:00:23.872529 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 05:00:23.872985 (Thread-1): finished collecting timing info
2022-10-05 05:00:23.873126 (Thread-2): finished collecting timing info
2022-10-05 05:00:23.890810 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 05:00:23.903204 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 05:00:23.903640 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.903739 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 05:00:23.903831 (Thread-2): Opening a new connection, currently in state init
2022-10-05 05:00:23.904026 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:00:23.904129 (Thread-1): On model.my_new_project.first_customer_cte: BEGIN
2022-10-05 05:00:23.904219 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 05:00:23.912369 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:00:23.912520 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:00:23.912637 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:00:23.912732 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.912823 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */

  create view "postgres"."public"."first_customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers where id=1
)
select * from customer_cte
  );

2022-10-05 05:00:23.912911 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 05:00:23.915323 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 05:00:23.915417 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 05:00:23.919338 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:00:23.920691 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.920803 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
alter table "postgres"."public"."first_customer_cte__dbt_tmp" rename to "first_customer_cte"
2022-10-05 05:00:23.920898 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 05:00:23.921534 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:00:23.921634 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:00:23.922769 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.927018 (Thread-1): On model.my_new_project.first_customer_cte: COMMIT
2022-10-05 05:00:23.927127 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 05:00:23.927225 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:00:23.927346 (Thread-1): On model.my_new_project.first_customer_cte: COMMIT
2022-10-05 05:00:23.928101 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:00:23.931493 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 05:00:23.931601 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:00:23.931686 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.934515 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:00:23.934621 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 05:00:23.934713 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
drop view if exists "postgres"."public"."first_customer_cte__dbt_backup" cascade
2022-10-05 05:00:23.935073 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 05:00:23.935754 (Thread-1): finished collecting timing info
2022-10-05 05:00:23.935868 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:00:23.935967 (Thread-1): On model.my_new_project.first_customer_cte: Close
2022-10-05 05:00:23.936775 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:00:23.937034 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c4f38a-443c-40a2-a566-deab175c9bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdacd5790>]}
2022-10-05 05:00:23.937114 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 05:00:23.937358 (Thread-1): 06:00:23 | 1 of 3 OK created view model public.first_customer_cte............... [CREATE VIEW in 0.07s]
2022-10-05 05:00:23.937488 (Thread-1): Finished running node model.my_new_project.first_customer_cte
2022-10-05 05:00:23.940278 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 05:00:23.941078 (Thread-2): finished collecting timing info
2022-10-05 05:00:23.941211 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 05:00:23.941477 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c4f38a-443c-40a2-a566-deab175c9bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdace0b80>]}
2022-10-05 05:00:23.941704 (Thread-2): 06:00:23 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 05:00:23.941822 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 05:00:23.942258 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 05:00:23.942430 (Thread-4): 06:00:23 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 05:00:23.942714 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:00:23.942851 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 05:00:23.944928 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 05:00:23.945663 (Thread-4): finished collecting timing info
2022-10-05 05:00:23.947408 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 05:00:23.947797 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:00:23.947889 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 05:00:23.947980 (Thread-4): Opening a new connection, currently in state init
2022-10-05 05:00:23.956362 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:00:23.956495 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:00:23.956587 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 05:00:23.959823 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 05:00:23.961626 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:00:23.961821 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 05:00:23.962329 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:00:23.963199 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 05:00:23.963355 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:00:23.963441 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 05:00:23.963996 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:00:23.965209 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:00:23.965315 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 05:00:23.965574 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 05:00:23.966254 (Thread-4): finished collecting timing info
2022-10-05 05:00:23.966377 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 05:00:23.966618 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3c4f38a-443c-40a2-a566-deab175c9bdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdad8fd30>]}
2022-10-05 05:00:23.966841 (Thread-4): 06:00:23 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-05 05:00:23.966952 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 05:00:23.967745 (MainThread): Acquiring new postgres connection "master".
2022-10-05 05:00:23.967894 (MainThread): Using postgres connection "master".
2022-10-05 05:00:23.967983 (MainThread): On master: BEGIN
2022-10-05 05:00:23.968073 (MainThread): Opening a new connection, currently in state closed
2022-10-05 05:00:23.975775 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:00:23.975964 (MainThread): On master: COMMIT
2022-10-05 05:00:23.976048 (MainThread): Using postgres connection "master".
2022-10-05 05:00:23.976127 (MainThread): On master: COMMIT
2022-10-05 05:00:23.976295 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:00:23.976398 (MainThread): On master: Close
2022-10-05 05:00:23.976671 (MainThread): 06:00:23 | 
2022-10-05 05:00:23.976791 (MainThread): 06:00:23 | Finished running 2 view models, 1 table model in 0.23s.
2022-10-05 05:00:23.976895 (MainThread): Connection 'master' was properly closed.
2022-10-05 05:00:23.976976 (MainThread): Connection 'model.my_new_project.first_customer_cte' was properly closed.
2022-10-05 05:00:23.977054 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 05:00:23.977130 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 05:00:23.980516 (MainThread): 
2022-10-05 05:00:23.980675 (MainThread): Completed successfully
2022-10-05 05:00:23.980775 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-05 05:00:23.980936 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cb8125b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdacdbc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9cdacdb040>]}
2022-10-05 05:00:23.981095 (MainThread): Flushing usage events
2022-10-05 05:04:09.286737 (MainThread): Running with dbt=0.21.1
2022-10-05 05:04:09.380004 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-05 05:04:09.381258 (MainThread): Tracking: tracking
2022-10-05 05:04:09.410170 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a25fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a25fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a25fb80>]}
2022-10-05 05:04:09.419183 (MainThread): Partial parsing not enabled
2022-10-05 05:04:09.428355 (MainThread): Parsing macros/catalog.sql
2022-10-05 05:04:09.430785 (MainThread): Parsing macros/relations.sql
2022-10-05 05:04:09.431791 (MainThread): Parsing macros/adapters.sql
2022-10-05 05:04:09.448180 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-05 05:04:09.449329 (MainThread): Parsing macros/core.sql
2022-10-05 05:04:09.451938 (MainThread): Parsing macros/materializations/test.sql
2022-10-05 05:04:09.456639 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-05 05:04:09.463435 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-05 05:04:09.464557 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-05 05:04:09.476528 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-05 05:04:09.502509 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-05 05:04:09.519416 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-05 05:04:09.520589 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-05 05:04:09.527878 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-05 05:04:09.542871 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-05 05:04:09.553155 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-05 05:04:09.558862 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-05 05:04:09.564191 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-05 05:04:09.566783 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-05 05:04:09.567750 (MainThread): Parsing macros/etc/query.sql
2022-10-05 05:04:09.568361 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-05 05:04:09.569368 (MainThread): Parsing macros/etc/datetime.sql
2022-10-05 05:04:09.575402 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-05 05:04:09.576588 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-05 05:04:09.578212 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-05 05:04:09.579258 (MainThread): Parsing macros/adapters/common.sql
2022-10-05 05:04:09.620508 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-05 05:04:09.621824 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-05 05:04:09.622610 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-05 05:04:09.623485 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-05 05:04:09.734824 (MainThread): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.743026 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.745497 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:04:09.763087 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:04:09.764241 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:04:09.765345 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:04:09.766537 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-05 05:04:09.777610 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c4670c4-ac86-4280-becc-032f0cc1380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a36a0d0>]}
2022-10-05 05:04:09.780993 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-05 05:04:09.781407 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c4670c4-ac86-4280-becc-032f0cc1380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a36a550>]}
2022-10-05 05:04:09.781578 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-05 05:04:09.782473 (MainThread): 
2022-10-05 05:04:09.782680 (MainThread): Acquiring new postgres connection "master".
2022-10-05 05:04:09.783330 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-05 05:04:09.790114 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-05 05:04:09.790290 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-05 05:04:09.790393 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-05 05:04:09.846413 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-05 05:04:09.847896 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-05 05:04:09.848692 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-05 05:04:09.852954 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 05:04:09.853077 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-05 05:04:09.853178 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-05 05:04:09.862718 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:04:09.862830 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-05 05:04:09.862921 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-05 05:04:09.868240 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.01 seconds
2022-10-05 05:04:09.869144 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-05 05:04:09.869429 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-05 05:04:09.872512 (MainThread): Using postgres connection "master".
2022-10-05 05:04:09.872709 (MainThread): On master: BEGIN
2022-10-05 05:04:09.872825 (MainThread): Opening a new connection, currently in state init
2022-10-05 05:04:09.882405 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:04:09.882554 (MainThread): Using postgres connection "master".
2022-10-05 05:04:09.882651 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-05 05:04:09.894141 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2022-10-05 05:04:09.895188 (MainThread): On master: ROLLBACK
2022-10-05 05:04:09.895471 (MainThread): Using postgres connection "master".
2022-10-05 05:04:09.895581 (MainThread): On master: BEGIN
2022-10-05 05:04:09.895947 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-05 05:04:09.896067 (MainThread): On master: COMMIT
2022-10-05 05:04:09.896171 (MainThread): Using postgres connection "master".
2022-10-05 05:04:09.896266 (MainThread): On master: COMMIT
2022-10-05 05:04:09.896473 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:04:09.896590 (MainThread): On master: Close
2022-10-05 05:04:09.896842 (MainThread): 06:04:09 | Concurrency: 5 threads (target='dev')
2022-10-05 05:04:09.896980 (MainThread): 06:04:09 | 
2022-10-05 05:04:09.899473 (Thread-1): Began running node model.my_new_project.first_customer_cte
2022-10-05 05:04:09.899676 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-05 05:04:09.899878 (Thread-1): 06:04:09 | 1 of 3 START table model public.first_customer_cte................... [RUN]
2022-10-05 05:04:09.900094 (Thread-2): 06:04:09 | 2 of 3 START table model public.my_first_dbt_model................... [RUN]
2022-10-05 05:04:09.900452 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.900732 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.900883 (Thread-1): Compiling model.my_new_project.first_customer_cte
2022-10-05 05:04:09.901013 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-05 05:04:09.902809 (Thread-1): Writing injected SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 05:04:09.904691 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 05:04:09.905478 (Thread-2): finished collecting timing info
2022-10-05 05:04:09.924310 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-05 05:04:09.924576 (Thread-1): finished collecting timing info
2022-10-05 05:04:09.925931 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_customer_cte"
2022-10-05 05:04:09.926192 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.926291 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-05 05:04:09.926411 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.926515 (Thread-2): Opening a new connection, currently in state init
2022-10-05 05:04:09.926611 (Thread-1): On model.my_new_project.first_customer_cte: BEGIN
2022-10-05 05:04:09.926800 (Thread-1): Opening a new connection, currently in state closed
2022-10-05 05:04:09.935149 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:04:09.935299 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:04:09.935423 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.935521 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.935613 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-05 05:04:09.935703 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */


  create  table "postgres"."public"."first_customer_cte__dbt_tmp"
  as (
    
with customer_cte as (
    select * from customers where id=1
)
select * from customer_cte
  );
2022-10-05 05:04:09.940213 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-05 05:04:09.940313 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-05 05:04:09.944653 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.946206 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.946352 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
alter table "postgres"."public"."first_customer_cte" rename to "first_customer_cte__dbt_backup"
2022-10-05 05:04:09.946455 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-05 05:04:09.947128 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:04:09.948800 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.948927 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:04:09.949028 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-05 05:04:09.950336 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.950476 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
alter table "postgres"."public"."first_customer_cte__dbt_tmp" rename to "first_customer_cte"
2022-10-05 05:04:09.951275 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:04:09.951377 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:04:09.958418 (Thread-1): On model.my_new_project.first_customer_cte: COMMIT
2022-10-05 05:04:09.959176 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 05:04:09.959283 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.959372 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.959453 (Thread-1): On model.my_new_project.first_customer_cte: COMMIT
2022-10-05 05:04:09.959535 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-05 05:04:09.960650 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:04:09.963545 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-05 05:04:09.963652 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:04:09.963733 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
drop view if exists "postgres"."public"."first_customer_cte__dbt_backup" cascade
2022-10-05 05:04:09.964617 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-05 05:04:09.964746 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-05 05:04:09.967127 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 05:04:09.967828 (Thread-1): finished collecting timing info
2022-10-05 05:04:09.967961 (Thread-1): On model.my_new_project.first_customer_cte: Close
2022-10-05 05:04:09.968240 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c4670c4-ac86-4280-becc-032f0cc1380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a389ac0>]}
2022-10-05 05:04:09.968480 (Thread-1): 06:04:09 | 1 of 3 OK created table model public.first_customer_cte.............. [SELECT 1 in 0.07s]
2022-10-05 05:04:09.968585 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-05 05:04:09.968705 (Thread-1): Finished running node model.my_new_project.first_customer_cte
2022-10-05 05:04:09.969393 (Thread-2): finished collecting timing info
2022-10-05 05:04:09.969620 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-05 05:04:09.969852 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c4670c4-ac86-4280-becc-032f0cc1380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a4188b0>]}
2022-10-05 05:04:09.970051 (Thread-2): 06:04:09 | 2 of 3 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.07s]
2022-10-05 05:04:09.970161 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-05 05:04:09.970523 (Thread-4): Began running node model.my_new_project.my_second_dbt_model
2022-10-05 05:04:09.970822 (Thread-4): 06:04:09 | 3 of 3 START view model public.my_second_dbt_model................... [RUN]
2022-10-05 05:04:09.971117 (Thread-4): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:04:09.971232 (Thread-4): Compiling model.my_new_project.my_second_dbt_model
2022-10-05 05:04:09.972708 (Thread-4): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 05:04:09.973065 (Thread-4): finished collecting timing info
2022-10-05 05:04:09.985418 (Thread-4): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-05 05:04:09.985815 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:04:09.985903 (Thread-4): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-05 05:04:09.985993 (Thread-4): Opening a new connection, currently in state init
2022-10-05 05:04:09.994648 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:04:09.994772 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:04:09.994861 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-05 05:04:09.998123 (Thread-4): SQL status: CREATE VIEW in 0.00 seconds
2022-10-05 05:04:09.999778 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:04:09.999882 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-05 05:04:10.000480 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-05 05:04:10.001155 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 05:04:10.001250 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:04:10.001330 (Thread-4): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-05 05:04:10.002044 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:04:10.002820 (Thread-4): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-05 05:04:10.002909 (Thread-4): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-05 05:04:10.003228 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-05 05:04:10.003932 (Thread-4): finished collecting timing info
2022-10-05 05:04:10.004048 (Thread-4): On model.my_new_project.my_second_dbt_model: Close
2022-10-05 05:04:10.004287 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c4670c4-ac86-4280-becc-032f0cc1380f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc358ab2370>]}
2022-10-05 05:04:10.004505 (Thread-4): 06:04:10 | 3 of 3 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-05 05:04:10.004614 (Thread-4): Finished running node model.my_new_project.my_second_dbt_model
2022-10-05 05:04:10.005326 (MainThread): Acquiring new postgres connection "master".
2022-10-05 05:04:10.005449 (MainThread): Using postgres connection "master".
2022-10-05 05:04:10.005530 (MainThread): On master: BEGIN
2022-10-05 05:04:10.005612 (MainThread): Opening a new connection, currently in state closed
2022-10-05 05:04:10.014271 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-05 05:04:10.014448 (MainThread): On master: COMMIT
2022-10-05 05:04:10.014533 (MainThread): Using postgres connection "master".
2022-10-05 05:04:10.014613 (MainThread): On master: COMMIT
2022-10-05 05:04:10.014776 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-05 05:04:10.014878 (MainThread): On master: Close
2022-10-05 05:04:10.015135 (MainThread): 06:04:10 | 
2022-10-05 05:04:10.015252 (MainThread): 06:04:10 | Finished running 2 table models, 1 view model in 0.23s.
2022-10-05 05:04:10.015354 (MainThread): Connection 'master' was properly closed.
2022-10-05 05:04:10.015433 (MainThread): Connection 'model.my_new_project.first_customer_cte' was properly closed.
2022-10-05 05:04:10.015510 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-05 05:04:10.015586 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-05 05:04:10.019860 (MainThread): 
2022-10-05 05:04:10.020038 (MainThread): Completed successfully
2022-10-05 05:04:10.020141 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-05 05:04:10.020303 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a2fc910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a37c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc37a37cca0>]}
2022-10-05 05:04:10.020460 (MainThread): Flushing usage events
2022-10-05 05:04:15.823091 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2022-10-05 05:04:15.825016 (MainThread): Error sending message, disabling tracking
2022-10-06 05:01:28.314425 (MainThread): Running with dbt=0.21.1
2022-10-06 05:01:28.397372 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 05:01:28.398651 (MainThread): Tracking: tracking
2022-10-06 05:01:28.434990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b525a5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b525b3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b525b3460>]}
2022-10-06 05:01:28.444151 (MainThread): Partial parsing not enabled
2022-10-06 05:01:28.453353 (MainThread): Parsing macros/catalog.sql
2022-10-06 05:01:28.456082 (MainThread): Parsing macros/relations.sql
2022-10-06 05:01:28.457080 (MainThread): Parsing macros/adapters.sql
2022-10-06 05:01:28.472726 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 05:01:28.473849 (MainThread): Parsing macros/core.sql
2022-10-06 05:01:28.476334 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 05:01:28.480922 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 05:01:28.487617 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 05:01:28.488711 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 05:01:28.500334 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 05:01:28.524987 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 05:01:28.541304 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 05:01:28.542453 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 05:01:28.549579 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 05:01:28.563867 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 05:01:28.573700 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 05:01:28.579271 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 05:01:28.584442 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 05:01:28.586990 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 05:01:28.587945 (MainThread): Parsing macros/etc/query.sql
2022-10-06 05:01:28.588553 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 05:01:28.589551 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 05:01:28.595399 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 05:01:28.596574 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 05:01:28.598183 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 05:01:28.599204 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 05:01:28.637986 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 05:01:28.639064 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 05:01:28.639803 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 05:01:28.640653 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 05:01:28.763084 (MainThread): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:28.771308 (MainThread): Acquiring new postgres connection "model.my_new_project.sec_cus".
2022-10-06 05:01:28.773230 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:28.775463 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 05:01:28.793033 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 05:01:28.794214 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 05:01:28.795328 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 05:01:28.797161 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 05:01:28.807217 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45e02857-73cb-4cd7-b089-e407a0ea7d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b52749f10>]}
2022-10-06 05:01:28.810619 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 05:01:28.811277 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45e02857-73cb-4cd7-b089-e407a0ea7d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b526b1c70>]}
2022-10-06 05:01:28.811442 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 05:01:28.812385 (MainThread): 
2022-10-06 05:01:28.812608 (MainThread): Acquiring new postgres connection "master".
2022-10-06 05:01:28.813271 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 05:01:28.820115 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 05:01:28.820403 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 05:01:28.820532 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 05:01:28.913237 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.09 seconds
2022-10-06 05:01:28.914987 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 05:01:28.916006 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 05:01:28.920822 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 05:01:28.920962 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 05:01:28.921079 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 05:01:28.930790 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 05:01:28.930921 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 05:01:28.931029 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 05:01:28.938023 (ThreadPoolExecutor-1_0): SQL status: SELECT 4 in 0.01 seconds
2022-10-06 05:01:28.938988 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 05:01:28.939297 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 05:01:28.942466 (MainThread): Using postgres connection "master".
2022-10-06 05:01:28.942590 (MainThread): On master: BEGIN
2022-10-06 05:01:28.942696 (MainThread): Opening a new connection, currently in state init
2022-10-06 05:01:28.952643 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 05:01:28.952772 (MainThread): Using postgres connection "master".
2022-10-06 05:01:28.952868 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 05:01:28.967848 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-06 05:01:28.968769 (MainThread): On master: ROLLBACK
2022-10-06 05:01:28.969076 (MainThread): Using postgres connection "master".
2022-10-06 05:01:28.969185 (MainThread): On master: BEGIN
2022-10-06 05:01:28.969595 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 05:01:28.969719 (MainThread): On master: COMMIT
2022-10-06 05:01:28.969826 (MainThread): Using postgres connection "master".
2022-10-06 05:01:28.969925 (MainThread): On master: COMMIT
2022-10-06 05:01:28.970185 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 05:01:28.970304 (MainThread): On master: Close
2022-10-06 05:01:28.970540 (MainThread): 06:01:28 | Concurrency: 5 threads (target='dev')
2022-10-06 05:01:28.970676 (MainThread): 06:01:28 | 
2022-10-06 05:01:28.973049 (Thread-1): Began running node model.my_new_project.first_customer_cte
2022-10-06 05:01:28.973232 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 05:01:28.973459 (Thread-1): 06:01:28 | 1 of 4 START table model public.first_customer_cte................... [RUN]
2022-10-06 05:01:28.973583 (Thread-3): Began running node model.my_new_project.sec_cus
2022-10-06 05:01:28.973775 (Thread-2): 06:01:28 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 05:01:28.974063 (Thread-1): Acquiring new postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:28.974270 (Thread-3): 06:01:28 | 3 of 4 START view model public.sec_cus............................... [RUN]
2022-10-06 05:01:28.974529 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:28.974664 (Thread-1): Compiling model.my_new_project.first_customer_cte
2022-10-06 05:01:28.974895 (Thread-3): Acquiring new postgres connection "model.my_new_project.sec_cus".
2022-10-06 05:01:28.975008 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 05:01:28.976869 (Thread-1): Writing injected SQL for node "model.my_new_project.first_customer_cte"
2022-10-06 05:01:28.977040 (Thread-3): Compiling model.my_new_project.sec_cus
2022-10-06 05:01:28.979415 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 05:01:28.980771 (Thread-3): Writing injected SQL for node "model.my_new_project.sec_cus"
2022-10-06 05:01:28.981176 (Thread-1): finished collecting timing info
2022-10-06 05:01:28.981329 (Thread-2): finished collecting timing info
2022-10-06 05:01:28.999014 (Thread-1): Writing runtime SQL for node "model.my_new_project.first_customer_cte"
2022-10-06 05:01:28.999180 (Thread-3): finished collecting timing info
2022-10-06 05:01:29.000738 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 05:01:29.012220 (Thread-3): Writing runtime SQL for node "model.my_new_project.sec_cus"
2022-10-06 05:01:29.012510 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:29.012635 (Thread-1): On model.my_new_project.first_customer_cte: BEGIN
2022-10-06 05:01:29.012749 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 05:01:29.012945 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:29.013076 (Thread-3): Using postgres connection "model.my_new_project.sec_cus".
2022-10-06 05:01:29.013163 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 05:01:29.013261 (Thread-3): On model.my_new_project.sec_cus: BEGIN
2022-10-06 05:01:29.013367 (Thread-2): Opening a new connection, currently in state init
2022-10-06 05:01:29.013466 (Thread-3): Opening a new connection, currently in state init
2022-10-06 05:01:29.021632 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 05:01:29.021790 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 05:01:29.021918 (Thread-3): Using postgres connection "model.my_new_project.sec_cus".
2022-10-06 05:01:29.022019 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:29.022115 (Thread-3): On model.my_new_project.sec_cus: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.sec_cus"} */

  create view "postgres"."public"."sec_cus__dbt_tmp" as (
    create view sec_cus as select * from customers where id=2
  );

2022-10-06 05:01:29.022209 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */


  create  table "postgres"."public"."first_customer_cte__dbt_tmp"
  as (
    
with customer_cte as (
    select * from customers where id=1
)
select * from customer_cte
  );
2022-10-06 05:01:29.022829 (Thread-3): Postgres error: syntax error at or near "create"
LINE 4:     create view sec_cus as select * from customers where id=...
            ^

2022-10-06 05:01:29.022931 (Thread-3): On model.my_new_project.sec_cus: ROLLBACK
2022-10-06 05:01:29.023285 (Thread-3): finished collecting timing info
2022-10-06 05:01:29.023409 (Thread-3): On model.my_new_project.sec_cus: Close
2022-10-06 05:01:29.024915 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 05:01:29.025092 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:29.025190 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 05:01:29.023655 (Thread-3): Database Error in model sec_cus (models/sec_cus.sql)
  syntax error at or near "create"
  LINE 4:     create view sec_cus as select * from customers where id=...
              ^
  compiled SQL at target/run/my_new_project/models/sec_cus.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "create"
LINE 4:     create view sec_cus as select * from customers where id=...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model sec_cus (models/sec_cus.sql)
  syntax error at or near "create"
  LINE 4:     create view sec_cus as select * from customers where id=...
              ^
  compiled SQL at target/run/my_new_project/models/sec_cus.sql
2022-10-06 05:01:29.027410 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e02857-73cb-4cd7-b089-e407a0ea7d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b526c4a60>]}
2022-10-06 05:01:29.027641 (Thread-3): 06:01:29 | 3 of 4 ERROR creating view model public.sec_cus...................... [ERROR in 0.05s]
2022-10-06 05:01:29.027759 (Thread-3): Finished running node model.my_new_project.sec_cus
2022-10-06 05:01:29.038354 (Thread-1): SQL status: SELECT 1 in 0.02 seconds
2022-10-06 05:01:29.038557 (Thread-2): SQL status: SELECT 2 in 0.01 seconds
2022-10-06 05:01:29.042692 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:29.043998 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:29.044116 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
alter table "postgres"."public"."first_customer_cte" rename to "first_customer_cte__dbt_backup"
2022-10-06 05:01:29.044208 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 05:01:29.045517 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 05:01:29.045624 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 05:01:29.046786 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:29.048012 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:29.048117 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 05:01:29.048210 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
alter table "postgres"."public"."first_customer_cte__dbt_tmp" rename to "first_customer_cte"
2022-10-06 05:01:29.049427 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 05:01:29.055830 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2022-10-06 05:01:29.056760 (Thread-1): On model.my_new_project.first_customer_cte: COMMIT
2022-10-06 05:01:29.057582 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 05:01:29.057695 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:29.057785 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:29.057868 (Thread-1): On model.my_new_project.first_customer_cte: COMMIT
2022-10-06 05:01:29.057948 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 05:01:29.059401 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 05:01:29.059496 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 05:01:29.062356 (Thread-1): Using postgres connection "model.my_new_project.first_customer_cte".
2022-10-06 05:01:29.063177 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 05:01:29.063291 (Thread-1): On model.my_new_project.first_customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.first_customer_cte"} */
drop table if exists "postgres"."public"."first_customer_cte__dbt_backup" cascade
2022-10-06 05:01:29.063386 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 05:01:29.067946 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 05:01:29.068119 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 05:01:29.069375 (Thread-1): finished collecting timing info
2022-10-06 05:01:29.070055 (Thread-2): finished collecting timing info
2022-10-06 05:01:29.070196 (Thread-1): On model.my_new_project.first_customer_cte: Close
2022-10-06 05:01:29.070306 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 05:01:29.070579 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e02857-73cb-4cd7-b089-e407a0ea7d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b526bf460>]}
2022-10-06 05:01:29.070796 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e02857-73cb-4cd7-b089-e407a0ea7d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b526bfd00>]}
2022-10-06 05:01:29.071068 (Thread-2): 06:01:29 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.10s]
2022-10-06 05:01:29.071268 (Thread-1): 06:01:29 | 1 of 4 OK created table model public.first_customer_cte.............. [SELECT 1 in 0.10s]
2022-10-06 05:01:29.071381 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 05:01:29.071497 (Thread-1): Finished running node model.my_new_project.first_customer_cte
2022-10-06 05:01:29.071807 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 05:01:29.071972 (Thread-5): 06:01:29 | 4 of 4 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 05:01:29.072180 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 05:01:29.072283 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 05:01:29.073713 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 05:01:29.074020 (Thread-5): finished collecting timing info
2022-10-06 05:01:29.076244 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 05:01:29.076498 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 05:01:29.076593 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 05:01:29.076681 (Thread-5): Opening a new connection, currently in state init
2022-10-06 05:01:29.084990 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 05:01:29.085194 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 05:01:29.085288 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 05:01:29.087380 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 05:01:29.088867 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 05:01:29.088973 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 05:01:29.089301 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 05:01:29.089955 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 05:01:29.090048 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 05:01:29.090129 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 05:01:29.090565 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 05:01:29.091397 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 05:01:29.091493 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 05:01:29.091706 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 05:01:29.092319 (Thread-5): finished collecting timing info
2022-10-06 05:01:29.092440 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 05:01:29.092674 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45e02857-73cb-4cd7-b089-e407a0ea7d2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b527bdcd0>]}
2022-10-06 05:01:29.092883 (Thread-5): 06:01:29 | 4 of 4 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 05:01:29.092991 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 05:01:29.093803 (MainThread): Acquiring new postgres connection "master".
2022-10-06 05:01:29.093927 (MainThread): Using postgres connection "master".
2022-10-06 05:01:29.094009 (MainThread): On master: BEGIN
2022-10-06 05:01:29.094090 (MainThread): Opening a new connection, currently in state closed
2022-10-06 05:01:29.103150 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 05:01:29.103392 (MainThread): On master: COMMIT
2022-10-06 05:01:29.103484 (MainThread): Using postgres connection "master".
2022-10-06 05:01:29.103566 (MainThread): On master: COMMIT
2022-10-06 05:01:29.103754 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 05:01:29.103910 (MainThread): On master: Close
2022-10-06 05:01:29.104335 (MainThread): 06:01:29 | 
2022-10-06 05:01:29.104453 (MainThread): 06:01:29 | Finished running 2 view models, 2 table models in 0.29s.
2022-10-06 05:01:29.104556 (MainThread): Connection 'master' was properly closed.
2022-10-06 05:01:29.104638 (MainThread): Connection 'model.my_new_project.first_customer_cte' was properly closed.
2022-10-06 05:01:29.104716 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 05:01:29.104794 (MainThread): Connection 'model.my_new_project.sec_cus' was properly closed.
2022-10-06 05:01:29.104868 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 05:01:29.107777 (MainThread): 
2022-10-06 05:01:29.107896 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 05:01:29.107995 (MainThread): 
2022-10-06 05:01:29.108094 (MainThread): Database Error in model sec_cus (models/sec_cus.sql)
2022-10-06 05:01:29.108183 (MainThread):   syntax error at or near "create"
2022-10-06 05:01:29.108266 (MainThread):   LINE 4:     create view sec_cus as select * from customers where id=...
2022-10-06 05:01:29.108348 (MainThread):               ^
2022-10-06 05:01:29.108429 (MainThread):   compiled SQL at target/run/my_new_project/models/sec_cus.sql
2022-10-06 05:01:29.108521 (MainThread): 
Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
2022-10-06 05:01:29.108668 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b20015160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b526237c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b527ed700>]}
2022-10-06 05:01:29.108820 (MainThread): Flushing usage events
2022-10-06 06:11:59.795455 (MainThread): Running with dbt=0.21.1
2022-10-06 06:11:59.878802 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 06:11:59.880315 (MainThread): Tracking: tracking
2022-10-06 06:11:59.911749 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba2568bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba2564730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba2564d60>]}
2022-10-06 06:11:59.920892 (MainThread): Partial parsing not enabled
2022-10-06 06:11:59.931103 (MainThread): Parsing macros/catalog.sql
2022-10-06 06:11:59.933827 (MainThread): Parsing macros/relations.sql
2022-10-06 06:11:59.934928 (MainThread): Parsing macros/adapters.sql
2022-10-06 06:11:59.952561 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 06:11:59.953757 (MainThread): Parsing macros/core.sql
2022-10-06 06:11:59.956323 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 06:11:59.961322 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 06:11:59.968574 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 06:11:59.969821 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 06:11:59.982189 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 06:12:00.012455 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 06:12:00.030215 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 06:12:00.031459 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 06:12:00.039282 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 06:12:00.055803 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 06:12:00.067139 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 06:12:00.073650 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 06:12:00.079734 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 06:12:00.082441 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 06:12:00.083451 (MainThread): Parsing macros/etc/query.sql
2022-10-06 06:12:00.084083 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 06:12:00.085125 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 06:12:00.091469 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 06:12:00.092694 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 06:12:00.094330 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 06:12:00.095410 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 06:12:00.139755 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 06:12:00.140870 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 06:12:00.141627 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 06:12:00.142493 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 06:12:00.256841 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:00.265752 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:00.267704 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.269954 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:00.287403 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:00.288573 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:00.289709 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:00.291543 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:00.301039 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e3e5714-9f11-4ad4-a336-4c88c473c2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba2568520>]}
2022-10-06 06:12:00.304634 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 06:12:00.305522 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e3e5714-9f11-4ad4-a336-4c88c473c2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba25e8b80>]}
2022-10-06 06:12:00.305690 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 06:12:00.306609 (MainThread): 
2022-10-06 06:12:00.306825 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:12:00.307526 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 06:12:00.314433 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 06:12:00.314608 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 06:12:00.314708 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 06:12:00.403984 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.09 seconds
2022-10-06 06:12:00.405621 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 06:12:00.406619 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 06:12:00.411383 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:12:00.411549 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 06:12:00.411677 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 06:12:00.421548 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:00.421694 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:12:00.421800 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 06:12:00.428268 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2022-10-06 06:12:00.429286 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 06:12:00.429599 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 06:12:00.432794 (MainThread): Using postgres connection "master".
2022-10-06 06:12:00.432916 (MainThread): On master: BEGIN
2022-10-06 06:12:00.433019 (MainThread): Opening a new connection, currently in state init
2022-10-06 06:12:00.442705 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:00.442839 (MainThread): Using postgres connection "master".
2022-10-06 06:12:00.442933 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 06:12:00.459610 (MainThread): SQL status: SELECT 1 in 0.02 seconds
2022-10-06 06:12:00.460509 (MainThread): On master: ROLLBACK
2022-10-06 06:12:00.460786 (MainThread): Using postgres connection "master".
2022-10-06 06:12:00.460898 (MainThread): On master: BEGIN
2022-10-06 06:12:00.461253 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 06:12:00.461376 (MainThread): On master: COMMIT
2022-10-06 06:12:00.461479 (MainThread): Using postgres connection "master".
2022-10-06 06:12:00.461573 (MainThread): On master: COMMIT
2022-10-06 06:12:00.461791 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:00.461912 (MainThread): On master: Close
2022-10-06 06:12:00.462140 (MainThread): 07:12:00 | Concurrency: 5 threads (target='dev')
2022-10-06 06:12:00.462275 (MainThread): 07:12:00 | 
2022-10-06 06:12:00.464695 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 06:12:00.464878 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 06:12:00.465026 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 06:12:00.465233 (Thread-1): 07:12:00 | 1 of 4 START view model public.customer_cte.......................... [RUN]
2022-10-06 06:12:00.465436 (Thread-2): 07:12:00 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 06:12:00.465623 (Thread-3): 07:12:00 | 3 of 4 START view model public.orders_cte............................ [RUN]
2022-10-06 06:12:00.465948 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:00.466229 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.466510 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:00.466666 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 06:12:00.466793 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 06:12:00.466913 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 06:12:00.468006 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:12:00.470474 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:12:00.471654 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:12:00.472134 (Thread-1): finished collecting timing info
2022-10-06 06:12:00.483710 (Thread-3): finished collecting timing info
2022-10-06 06:12:00.489737 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:12:00.491192 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:12:00.491400 (Thread-2): finished collecting timing info
2022-10-06 06:12:00.503969 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:12:00.504296 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:00.504400 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 06:12:00.504498 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 06:12:00.504648 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:00.504751 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.504935 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 06:12:00.505031 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 06:12:00.505131 (Thread-3): Opening a new connection, currently in state init
2022-10-06 06:12:00.505214 (Thread-2): Opening a new connection, currently in state init
2022-10-06 06:12:00.515263 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:00.515454 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:00.515543 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
  );

2022-10-06 06:12:00.515642 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:00.515765 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:00.515838 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
  );

2022-10-06 06:12:00.516048 (Thread-1): Postgres error: syntax error at or near ")"
LINE 7:   );
          ^

2022-10-06 06:12:00.516159 (Thread-1): On model.my_new_project.customer_cte: ROLLBACK
2022-10-06 06:12:00.516263 (Thread-3): Postgres error: syntax error at or near ")"
LINE 7:   );
          ^

2022-10-06 06:12:00.516367 (Thread-3): On model.my_new_project.orders_cte: ROLLBACK
2022-10-06 06:12:00.516674 (Thread-1): finished collecting timing info
2022-10-06 06:12:00.516806 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 06:12:00.516944 (Thread-3): finished collecting timing info
2022-10-06 06:12:00.517059 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 06:12:00.517159 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:00.517251 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.517334 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 06:12:00.517872 (Thread-1): Database Error in model customer_cte (models/customer_cte.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/my_new_project/models/customer_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 7:   );
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_cte (models/customer_cte.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/my_new_project/models/customer_cte.sql
2022-10-06 06:12:00.517570 (Thread-3): Database Error in model orders_cte (models/orders_cte.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/my_new_project/models/orders_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ")"
LINE 7:   );
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model orders_cte (models/orders_cte.sql)
  syntax error at or near ")"
  LINE 7:   );
            ^
  compiled SQL at target/run/my_new_project/models/orders_cte.sql
2022-10-06 06:12:00.521664 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e3e5714-9f11-4ad4-a336-4c88c473c2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb908adee0>]}
2022-10-06 06:12:00.521840 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e3e5714-9f11-4ad4-a336-4c88c473c2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb80232ca0>]}
2022-10-06 06:12:00.522101 (Thread-1): 07:12:00 | 1 of 4 ERROR creating view model public.customer_cte................. [ERROR in 0.06s]
2022-10-06 06:12:00.522287 (Thread-3): 07:12:00 | 3 of 4 ERROR creating view model public.orders_cte................... [ERROR in 0.06s]
2022-10-06 06:12:00.522418 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 06:12:00.522526 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 06:12:00.529962 (Thread-2): SQL status: SELECT 2 in 0.01 seconds
2022-10-06 06:12:00.534421 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.534538 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 06:12:00.535044 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:00.536250 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.536350 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 06:12:00.537705 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:00.544971 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:12:00.545151 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.545237 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:12:00.546375 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:00.549415 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:00.549523 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 06:12:00.554634 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2022-10-06 06:12:00.555346 (Thread-2): finished collecting timing info
2022-10-06 06:12:00.555476 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 06:12:00.555735 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e3e5714-9f11-4ad4-a336-4c88c473c2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba2682fd0>]}
2022-10-06 06:12:00.555965 (Thread-2): 07:12:00 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-06 06:12:00.556083 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 06:12:00.556533 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 06:12:00.556746 (Thread-5): 07:12:00 | 4 of 4 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 06:12:00.556961 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:00.557067 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 06:12:00.558518 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:12:00.558889 (Thread-5): finished collecting timing info
2022-10-06 06:12:00.560554 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:12:00.560907 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:00.561002 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 06:12:00.561097 (Thread-5): Opening a new connection, currently in state init
2022-10-06 06:12:00.570294 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:00.570404 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:00.570492 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 06:12:00.574068 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 06:12:00.575687 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:00.575822 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 06:12:00.576356 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:00.577165 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:12:00.577285 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:00.577374 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:12:00.577963 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:00.578990 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:00.579110 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 06:12:00.579371 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:12:00.580318 (Thread-5): finished collecting timing info
2022-10-06 06:12:00.580474 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 06:12:00.580863 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0e3e5714-9f11-4ad4-a336-4c88c473c2dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbb8022d2b0>]}
2022-10-06 06:12:00.581151 (Thread-5): 07:12:00 | 4 of 4 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 06:12:00.581271 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 06:12:00.582062 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:12:00.582194 (MainThread): Using postgres connection "master".
2022-10-06 06:12:00.582281 (MainThread): On master: BEGIN
2022-10-06 06:12:00.582370 (MainThread): Opening a new connection, currently in state closed
2022-10-06 06:12:00.590248 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:00.590359 (MainThread): On master: COMMIT
2022-10-06 06:12:00.590445 (MainThread): Using postgres connection "master".
2022-10-06 06:12:00.590520 (MainThread): On master: COMMIT
2022-10-06 06:12:00.590702 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:00.590801 (MainThread): On master: Close
2022-10-06 06:12:00.591020 (MainThread): 07:12:00 | 
2022-10-06 06:12:00.591131 (MainThread): 07:12:00 | Finished running 3 view models, 1 table model in 0.28s.
2022-10-06 06:12:00.591235 (MainThread): Connection 'master' was properly closed.
2022-10-06 06:12:00.591319 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 06:12:00.591400 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 06:12:00.591480 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 06:12:00.591558 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 06:12:00.595683 (MainThread): 
2022-10-06 06:12:00.595859 (MainThread): Completed with 2 errors and 0 warnings:
2022-10-06 06:12:00.595960 (MainThread): 
2022-10-06 06:12:00.596053 (MainThread): Database Error in model customer_cte (models/customer_cte.sql)
2022-10-06 06:12:00.596141 (MainThread):   syntax error at or near ")"
2022-10-06 06:12:00.596221 (MainThread):   LINE 7:   );
2022-10-06 06:12:00.596302 (MainThread):             ^
2022-10-06 06:12:00.596381 (MainThread):   compiled SQL at target/run/my_new_project/models/customer_cte.sql
2022-10-06 06:12:00.596464 (MainThread): 
2022-10-06 06:12:00.596551 (MainThread): Database Error in model orders_cte (models/orders_cte.sql)
2022-10-06 06:12:00.596632 (MainThread):   syntax error at or near ")"
2022-10-06 06:12:00.596710 (MainThread):   LINE 7:   );
2022-10-06 06:12:00.596791 (MainThread):             ^
2022-10-06 06:12:00.596870 (MainThread):   compiled SQL at target/run/my_new_project/models/orders_cte.sql
2022-10-06 06:12:00.596962 (MainThread): 
Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
2022-10-06 06:12:00.597211 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba268c340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba268ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba268c100>]}
2022-10-06 06:12:00.597431 (MainThread): Flushing usage events
2022-10-06 06:12:52.365518 (MainThread): Running with dbt=0.21.1
2022-10-06 06:12:52.444897 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 06:12:52.447728 (MainThread): Tracking: tracking
2022-10-06 06:12:52.473484 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef6282bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef628a5460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef628a5d30>]}
2022-10-06 06:12:52.482696 (MainThread): Partial parsing not enabled
2022-10-06 06:12:52.491617 (MainThread): Parsing macros/catalog.sql
2022-10-06 06:12:52.494197 (MainThread): Parsing macros/relations.sql
2022-10-06 06:12:52.495304 (MainThread): Parsing macros/adapters.sql
2022-10-06 06:12:52.512119 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 06:12:52.513276 (MainThread): Parsing macros/core.sql
2022-10-06 06:12:52.515868 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 06:12:52.520640 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 06:12:52.527430 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 06:12:52.528556 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 06:12:52.540572 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 06:12:52.569346 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 06:12:52.586657 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 06:12:52.587856 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 06:12:52.595480 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 06:12:52.611218 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 06:12:52.621840 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 06:12:52.628125 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 06:12:52.633885 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 06:12:52.636478 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 06:12:52.637448 (MainThread): Parsing macros/etc/query.sql
2022-10-06 06:12:52.638061 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 06:12:52.639081 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 06:12:52.645227 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 06:12:52.646428 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 06:12:52.648042 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 06:12:52.649075 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 06:12:52.691464 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 06:12:52.692561 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 06:12:52.693306 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 06:12:52.694169 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 06:12:52.805944 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:52.813706 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:52.815838 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:52.818086 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:52.835549 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:52.836705 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:52.837825 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:52.839661 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:12:52.848563 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e37a6074-a1b6-4cb4-94a0-f122f597eb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef505baf40>]}
2022-10-06 06:12:52.851377 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 06:12:52.851985 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e37a6074-a1b6-4cb4-94a0-f122f597eb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef505ba040>]}
2022-10-06 06:12:52.852140 (MainThread): Found 4 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 06:12:52.853047 (MainThread): 
2022-10-06 06:12:52.853257 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:12:52.853964 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 06:12:52.860619 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 06:12:52.860775 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 06:12:52.860878 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 06:12:52.916759 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 06:12:52.918191 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 06:12:52.919019 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 06:12:52.923428 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:12:52.923558 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 06:12:52.923666 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 06:12:52.933619 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:52.933748 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:12:52.933857 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 06:12:52.939159 (ThreadPoolExecutor-1_0): SQL status: SELECT 5 in 0.01 seconds
2022-10-06 06:12:52.940065 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 06:12:52.940350 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 06:12:52.943317 (MainThread): Using postgres connection "master".
2022-10-06 06:12:52.943436 (MainThread): On master: BEGIN
2022-10-06 06:12:52.943539 (MainThread): Opening a new connection, currently in state init
2022-10-06 06:12:52.952747 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:52.952867 (MainThread): Using postgres connection "master".
2022-10-06 06:12:52.952962 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 06:12:52.967915 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2022-10-06 06:12:52.968828 (MainThread): On master: ROLLBACK
2022-10-06 06:12:52.969098 (MainThread): Using postgres connection "master".
2022-10-06 06:12:52.969208 (MainThread): On master: BEGIN
2022-10-06 06:12:52.969553 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 06:12:52.969670 (MainThread): On master: COMMIT
2022-10-06 06:12:52.969773 (MainThread): Using postgres connection "master".
2022-10-06 06:12:52.969869 (MainThread): On master: COMMIT
2022-10-06 06:12:52.970092 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:52.970206 (MainThread): On master: Close
2022-10-06 06:12:52.970440 (MainThread): 07:12:52 | Concurrency: 5 threads (target='dev')
2022-10-06 06:12:52.970574 (MainThread): 07:12:52 | 
2022-10-06 06:12:52.972905 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 06:12:52.973126 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 06:12:52.973362 (Thread-1): 07:12:52 | 1 of 4 START view model public.customer_cte.......................... [RUN]
2022-10-06 06:12:52.973483 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 06:12:52.973670 (Thread-2): 07:12:52 | 2 of 4 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 06:12:52.974012 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:52.974199 (Thread-3): 07:12:52 | 3 of 4 START view model public.orders_cte............................ [RUN]
2022-10-06 06:12:52.974521 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:52.974672 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 06:12:52.974958 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:52.975063 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 06:12:52.976182 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:12:52.976339 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 06:12:52.978806 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:12:52.980031 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:12:52.980764 (Thread-1): finished collecting timing info
2022-10-06 06:12:52.993175 (Thread-2): finished collecting timing info
2022-10-06 06:12:52.997675 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:12:52.997899 (Thread-3): finished collecting timing info
2022-10-06 06:12:53.010447 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:12:53.012046 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:12:53.012428 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:53.012563 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:53.012694 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 06:12:53.012820 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 06:12:53.012928 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:53.013040 (Thread-2): Opening a new connection, currently in state init
2022-10-06 06:12:53.013139 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 06:12:53.013239 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 06:12:53.013575 (Thread-3): Opening a new connection, currently in state init
2022-10-06 06:12:53.021368 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:53.021507 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:53.021626 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:53.021727 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:53.021823 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:53.021904 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 06:12:53.021994 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 06:12:53.022082 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:53.022208 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 06:12:53.023657 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 06:12:53.027581 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:53.027692 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:12:53.027789 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 06:12:53.027865 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:12:53.029273 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:53.030627 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:53.030774 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 06:12:53.030873 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:53.030968 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 06:12:53.032307 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:53.032410 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:53.032521 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 06:12:53.036741 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:12:53.036846 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:53.036962 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:53.037611 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:12:53.037713 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:53.037789 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:12:53.037878 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:53.040937 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:12:53.041079 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:12:53.041171 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:53.041279 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:12:53.041780 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:53.044480 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:12:53.044593 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 06:12:53.044704 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:53.045530 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:12:53.045623 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 06:12:53.045802 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:53.046535 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:12:53.046622 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 06:12:53.046720 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:12:53.048123 (Thread-3): finished collecting timing info
2022-10-06 06:12:53.048249 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 06:12:53.048361 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:12:53.048958 (Thread-1): finished collecting timing info
2022-10-06 06:12:53.049069 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 06:12:53.049311 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e37a6074-a1b6-4cb4-94a0-f122f597eb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef628b7280>]}
2022-10-06 06:12:53.049519 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e37a6074-a1b6-4cb4-94a0-f122f597eb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef505ed820>]}
2022-10-06 06:12:53.049730 (Thread-1): 07:12:53 | 1 of 4 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 06:12:53.049843 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 06:12:53.050107 (Thread-3): 07:12:53 | 3 of 4 OK created view model public.orders_cte....................... [CREATE VIEW in 0.07s]
2022-10-06 06:12:53.050225 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 06:12:53.050371 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 06:12:53.050953 (Thread-2): finished collecting timing info
2022-10-06 06:12:53.051063 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 06:12:53.051266 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e37a6074-a1b6-4cb4-94a0-f122f597eb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef505b6d00>]}
2022-10-06 06:12:53.051439 (Thread-2): 07:12:53 | 2 of 4 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 06:12:53.051539 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 06:12:53.051934 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 06:12:53.052105 (Thread-5): 07:12:53 | 4 of 4 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 06:12:53.052308 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:53.052407 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 06:12:53.053678 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:12:53.054006 (Thread-5): finished collecting timing info
2022-10-06 06:12:53.055315 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:12:53.055561 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:53.055646 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 06:12:53.055733 (Thread-5): Opening a new connection, currently in state init
2022-10-06 06:12:53.064609 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:53.064769 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:53.064853 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 06:12:53.067604 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 06:12:53.069096 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:53.069212 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 06:12:53.069581 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:12:53.070217 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:12:53.070307 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:53.070384 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:12:53.070784 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:53.071591 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:12:53.071684 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 06:12:53.071897 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:12:53.072484 (Thread-5): finished collecting timing info
2022-10-06 06:12:53.072595 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 06:12:53.072824 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e37a6074-a1b6-4cb4-94a0-f122f597eb4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef507313d0>]}
2022-10-06 06:12:53.073025 (Thread-5): 07:12:53 | 4 of 4 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 06:12:53.073130 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 06:12:53.073882 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:12:53.073997 (MainThread): Using postgres connection "master".
2022-10-06 06:12:53.074074 (MainThread): On master: BEGIN
2022-10-06 06:12:53.074151 (MainThread): Opening a new connection, currently in state closed
2022-10-06 06:12:53.082324 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:12:53.082555 (MainThread): On master: COMMIT
2022-10-06 06:12:53.082648 (MainThread): Using postgres connection "master".
2022-10-06 06:12:53.082737 (MainThread): On master: COMMIT
2022-10-06 06:12:53.082931 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:12:53.083066 (MainThread): On master: Close
2022-10-06 06:12:53.083409 (MainThread): 07:12:53 | 
2022-10-06 06:12:53.083539 (MainThread): 07:12:53 | Finished running 3 view models, 1 table model in 0.23s.
2022-10-06 06:12:53.083646 (MainThread): Connection 'master' was properly closed.
2022-10-06 06:12:53.083727 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 06:12:53.083805 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 06:12:53.083881 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 06:12:53.083954 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 06:12:53.086921 (MainThread): 
2022-10-06 06:12:53.087042 (MainThread): Completed successfully
2022-10-06 06:12:53.087145 (MainThread): 
Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
2022-10-06 06:12:53.087295 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef50680370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef50585f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef505858b0>]}
2022-10-06 06:12:53.087448 (MainThread): Flushing usage events
2022-10-06 06:17:24.466520 (MainThread): Running with dbt=0.21.1
2022-10-06 06:17:24.536962 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 06:17:24.539086 (MainThread): Tracking: tracking
2022-10-06 06:17:24.566299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4aa00d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4aa00e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4aa00c70>]}
2022-10-06 06:17:24.574966 (MainThread): Partial parsing not enabled
2022-10-06 06:17:24.584504 (MainThread): Parsing macros/catalog.sql
2022-10-06 06:17:24.587049 (MainThread): Parsing macros/relations.sql
2022-10-06 06:17:24.588097 (MainThread): Parsing macros/adapters.sql
2022-10-06 06:17:24.604039 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 06:17:24.605171 (MainThread): Parsing macros/core.sql
2022-10-06 06:17:24.607730 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 06:17:24.612375 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 06:17:24.619004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 06:17:24.620117 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 06:17:24.631907 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 06:17:24.657120 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 06:17:24.673363 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 06:17:24.674511 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 06:17:24.681666 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 06:17:24.696313 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 06:17:24.706620 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 06:17:24.712222 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 06:17:24.717444 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 06:17:24.720001 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 06:17:24.720958 (MainThread): Parsing macros/etc/query.sql
2022-10-06 06:17:24.721567 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 06:17:24.722560 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 06:17:24.728480 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 06:17:24.729660 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 06:17:24.731247 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 06:17:24.732270 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 06:17:24.772312 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 06:17:24.773393 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 06:17:24.774137 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 06:17:24.774998 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 06:17:24.886975 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:17:24.894579 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:17:24.896447 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:17:24.899419 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4aa45250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4aa51a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde4aa51c10>]}
2022-10-06 06:17:24.899604 (MainThread): Flushing usage events
2022-10-06 06:17:26.454000 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 06:17:26.454679 (MainThread): Encountered an error:
2022-10-06 06:17:26.455172 (MainThread): Compilation Error in model referencing (models/referencing.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
2022-10-06 06:17:26.463119 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 306, in load
    self.parse_project(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/models.py", line 94, in render_update
    super().render_update(node, config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 380, in render_update
    context = self.render_with_context(node, config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 271, in render_with_context
    get_rendered(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/context/providers.py", line 246, in __call__
    self.validate_args(name, package)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/context/providers.py", line 225, in validate_args
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error in model referencing (models/referencing.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>

2022-10-06 06:34:53.217461 (MainThread): Running with dbt=0.21.1
2022-10-06 06:34:53.292867 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 06:34:53.296510 (MainThread): Tracking: tracking
2022-10-06 06:34:53.320370 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52ad75be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52ad75fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52ad75b20>]}
2022-10-06 06:34:53.328841 (MainThread): Partial parsing not enabled
2022-10-06 06:34:53.338268 (MainThread): Parsing macros/catalog.sql
2022-10-06 06:34:53.340870 (MainThread): Parsing macros/relations.sql
2022-10-06 06:34:53.341900 (MainThread): Parsing macros/adapters.sql
2022-10-06 06:34:53.358317 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 06:34:53.359489 (MainThread): Parsing macros/core.sql
2022-10-06 06:34:53.362143 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 06:34:53.366951 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 06:34:53.373704 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 06:34:53.374851 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 06:34:53.387057 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 06:34:53.413843 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 06:34:53.430687 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 06:34:53.431889 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 06:34:53.439447 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 06:34:53.454668 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 06:34:53.465016 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 06:34:53.471044 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 06:34:53.476615 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 06:34:53.479256 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 06:34:53.480244 (MainThread): Parsing macros/etc/query.sql
2022-10-06 06:34:53.480868 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 06:34:53.481896 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 06:34:53.488010 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 06:34:53.489222 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 06:34:53.490857 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 06:34:53.491912 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 06:34:53.532666 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 06:34:53.533776 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 06:34:53.534535 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 06:34:53.535410 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 06:34:53.650867 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:34:53.658650 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:34:53.660526 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:34:53.663160 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe52ad6cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5080d9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5080d9be0>]}
2022-10-06 06:34:53.663352 (MainThread): Flushing usage events
2022-10-06 06:34:55.112463 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 06:34:55.113146 (MainThread): Encountered an error:
2022-10-06 06:34:55.113616 (MainThread): Compilation Error in model referencing (models/referencing.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>
2022-10-06 06:34:55.122330 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 306, in load
    self.parse_project(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 416, in parse_project
    parser.parse_file(block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 432, in parse_file
    self.parse_node(file_block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 405, in parse_node
    self.render_update(node, config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/models.py", line 94, in render_update
    super().render_update(node, config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 380, in render_update
    context = self.render_with_context(node, config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/base.py", line 271, in render_with_context
    get_rendered(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 598, in get_rendered
    return render_template(template, ctx, node)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 549, in render_template
    return template.render(ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 2, in top-level template code
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/context/providers.py", line 246, in __call__
    self.validate_args(name, package)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/context/providers.py", line 225, in validate_args
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error in model referencing (models/referencing.sql)
  The name argument to ref() must be a string, got <class 'dbt.clients.jinja.create_undefined.<locals>.Undefined'>

2022-10-06 06:37:35.992058 (MainThread): Running with dbt=0.21.1
2022-10-06 06:37:36.063662 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 06:37:36.065273 (MainThread): Tracking: tracking
2022-10-06 06:37:36.084870 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4a935df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4a943790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4a943880>]}
2022-10-06 06:37:36.093499 (MainThread): Partial parsing not enabled
2022-10-06 06:37:36.103314 (MainThread): Parsing macros/catalog.sql
2022-10-06 06:37:36.105947 (MainThread): Parsing macros/relations.sql
2022-10-06 06:37:36.106988 (MainThread): Parsing macros/adapters.sql
2022-10-06 06:37:36.122862 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 06:37:36.123989 (MainThread): Parsing macros/core.sql
2022-10-06 06:37:36.126479 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 06:37:36.131111 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 06:37:36.137779 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 06:37:36.138879 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 06:37:36.150555 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 06:37:36.175222 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 06:37:36.191254 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 06:37:36.192414 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 06:37:36.199563 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 06:37:36.213881 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 06:37:36.223751 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 06:37:36.229346 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 06:37:36.234540 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 06:37:36.237115 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 06:37:36.238108 (MainThread): Parsing macros/etc/query.sql
2022-10-06 06:37:36.238723 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 06:37:36.239733 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 06:37:36.245607 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 06:37:36.246785 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 06:37:36.248373 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 06:37:36.249398 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 06:37:36.288583 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 06:37:36.289696 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 06:37:36.290454 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 06:37:36.291316 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 06:37:36.403644 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.411364 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.413247 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:37:36.415607 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.418012 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:37:36.436309 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:37:36.437434 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:37:36.438518 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:37:36.439701 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:37:36.449746 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b9bc1e2-5fa4-485d-94d5-038e5f95445a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4a9c1fd0>]}
2022-10-06 06:37:36.453247 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 06:37:36.453577 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b9bc1e2-5fa4-485d-94d5-038e5f95445a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4aa044c0>]}
2022-10-06 06:37:36.453741 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 06:37:36.454713 (MainThread): 
2022-10-06 06:37:36.454925 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:37:36.455675 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 06:37:36.462308 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 06:37:36.462475 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 06:37:36.462587 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 06:37:36.526397 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 06:37:36.528062 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 06:37:36.529024 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 06:37:36.533411 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:37:36.533542 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 06:37:36.533650 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 06:37:36.543894 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:37:36.544017 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:37:36.544120 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 06:37:36.549703 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 06:37:36.550658 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 06:37:36.550950 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 06:37:36.554109 (MainThread): Using postgres connection "master".
2022-10-06 06:37:36.554229 (MainThread): On master: BEGIN
2022-10-06 06:37:36.554334 (MainThread): Opening a new connection, currently in state init
2022-10-06 06:37:36.563815 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:37:36.563935 (MainThread): Using postgres connection "master".
2022-10-06 06:37:36.564028 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 06:37:36.586442 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 06:37:36.587428 (MainThread): On master: ROLLBACK
2022-10-06 06:37:36.587690 (MainThread): Using postgres connection "master".
2022-10-06 06:37:36.587799 (MainThread): On master: BEGIN
2022-10-06 06:37:36.588116 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 06:37:36.588235 (MainThread): On master: COMMIT
2022-10-06 06:37:36.588336 (MainThread): Using postgres connection "master".
2022-10-06 06:37:36.588430 (MainThread): On master: COMMIT
2022-10-06 06:37:36.588632 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:37:36.588753 (MainThread): On master: Close
2022-10-06 06:37:36.588987 (MainThread): 07:37:36 | Concurrency: 5 threads (target='dev')
2022-10-06 06:37:36.589121 (MainThread): 07:37:36 | 
2022-10-06 06:37:36.591586 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 06:37:36.591777 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 06:37:36.591917 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 06:37:36.592128 (Thread-1): 07:37:36 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 06:37:36.592311 (Thread-2): 07:37:36 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 06:37:36.592513 (Thread-3): 07:37:36 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 06:37:36.593677 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.593965 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.594131 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 06:37:36.594355 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.594478 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 06:37:36.595535 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:37:36.595685 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 06:37:36.597546 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:37:36.598860 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:37:36.599645 (Thread-2): finished collecting timing info
2022-10-06 06:37:36.605891 (Thread-1): finished collecting timing info
2022-10-06 06:37:36.624609 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:37:36.630344 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:37:36.630454 (Thread-3): finished collecting timing info
2022-10-06 06:37:36.632008 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:37:36.632310 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.632441 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.632544 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 06:37:36.632649 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 06:37:36.632760 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.632858 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 06:37:36.632954 (Thread-2): Opening a new connection, currently in state closed
2022-10-06 06:37:36.633044 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 06:37:36.633300 (Thread-3): Opening a new connection, currently in state init
2022-10-06 06:37:36.643166 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:37:36.643316 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.643403 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 06:37:36.644403 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:37:36.644495 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.644574 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 06:37:36.648730 (Thread-3): SQL status: BEGIN in 0.02 seconds
2022-10-06 06:37:36.648850 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.648941 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 06:37:36.650171 (Thread-2): SQL status: SELECT 2 in 0.01 seconds
2022-10-06 06:37:36.654658 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.654806 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:37:36.654904 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:37:36.654990 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 06:37:36.656473 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.657797 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.657950 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 06:37:36.658047 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 06:37:36.658376 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:37:36.659618 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.659728 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:37:36.659820 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 06:37:36.659900 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:37:36.661159 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.662434 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.662544 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:37:36.662629 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 06:37:36.662716 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 06:37:36.669690 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:37:36.669907 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.669998 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:37:36.670289 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:37:36.670401 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:37:36.670489 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:37:36.671196 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:37:36.671855 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:37:36.675484 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:37:36.675597 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.675684 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.675763 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 06:37:36.675844 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:37:36.675924 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:37:36.676494 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:37:36.677334 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:37:36.677434 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:37:36.677513 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 06:37:36.678348 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:37:36.678466 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 06:37:36.679210 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 06:37:36.679882 (Thread-2): finished collecting timing info
2022-10-06 06:37:36.679994 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:37:36.680096 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 06:37:36.680176 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:37:36.680801 (Thread-3): finished collecting timing info
2022-10-06 06:37:36.681452 (Thread-1): finished collecting timing info
2022-10-06 06:37:36.681684 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9bc1e2-5fa4-485d-94d5-038e5f95445a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4aac7e50>]}
2022-10-06 06:37:36.681788 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 06:37:36.681910 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 06:37:36.682161 (Thread-2): 07:37:36 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-06 06:37:36.682382 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9bc1e2-5fa4-485d-94d5-038e5f95445a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b386e61f0>]}
2022-10-06 06:37:36.682516 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 06:37:36.682737 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9bc1e2-5fa4-485d-94d5-038e5f95445a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b386b8580>]}
2022-10-06 06:37:36.682913 (Thread-3): 07:37:36 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 06:37:36.683254 (Thread-1): 07:37:36 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.09s]
2022-10-06 06:37:36.683377 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 06:37:36.683490 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 06:37:36.683600 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 06:37:36.683743 (Thread-5): 07:37:36 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 06:37:36.684065 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:37:36.684174 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 06:37:36.685564 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:37:36.685810 (Thread-2): Began running node model.my_new_project.referencing
2022-10-06 06:37:36.685979 (Thread-2): 07:37:36 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 06:37:36.686193 (Thread-2): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:37:36.686300 (Thread-2): Compiling model.my_new_project.referencing
2022-10-06 06:37:36.688098 (Thread-2): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 06:37:36.688367 (Thread-5): finished collecting timing info
2022-10-06 06:37:36.690006 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:37:36.690452 (Thread-2): finished collecting timing info
2022-10-06 06:37:36.692277 (Thread-2): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 06:37:36.692488 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:37:36.692594 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 06:37:36.692701 (Thread-5): Opening a new connection, currently in state init
2022-10-06 06:37:36.692936 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 06:37:36.693027 (Thread-2): On model.my_new_project.referencing: BEGIN
2022-10-06 06:37:36.693113 (Thread-2): Opening a new connection, currently in state closed
2022-10-06 06:37:36.701480 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:37:36.701636 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:37:36.701737 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 06:37:36.701835 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:37:36.701925 (Thread-2): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    with referencing as (
    select * from "postgres"."public"."customer_cte" c
    join "postgres"."public"."orders_cte" o
    on c.order_id=o.order_id
)
select * from referencing
  );

2022-10-06 06:37:36.702016 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 06:37:36.704018 (Thread-2): Postgres error: column "order_id" specified more than once

2022-10-06 06:37:36.704166 (Thread-2): On model.my_new_project.referencing: ROLLBACK
2022-10-06 06:37:36.704759 (Thread-2): finished collecting timing info
2022-10-06 06:37:36.704911 (Thread-2): On model.my_new_project.referencing: Close
2022-10-06 06:37:36.705370 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 06:37:36.706804 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:37:36.706907 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 06:37:36.707577 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:37:36.708261 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:37:36.708357 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:37:36.708436 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:37:36.709036 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:37:36.709891 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:37:36.709985 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 06:37:36.710279 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:37:36.710994 (Thread-5): finished collecting timing info
2022-10-06 06:37:36.711109 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 06:37:36.711337 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9bc1e2-5fa4-485d-94d5-038e5f95445a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4ab02610>]}
2022-10-06 06:37:36.711609 (Thread-5): 07:37:36 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 06:37:36.711765 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 06:37:36.705170 (Thread-2): Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "order_id" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 06:37:36.713304 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b9bc1e2-5fa4-485d-94d5-038e5f95445a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4aaa48b0>]}
2022-10-06 06:37:36.713517 (Thread-2): 07:37:36 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.03s]
2022-10-06 06:37:36.713624 (Thread-2): Finished running node model.my_new_project.referencing
2022-10-06 06:37:36.714390 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:37:36.714506 (MainThread): Using postgres connection "master".
2022-10-06 06:37:36.714585 (MainThread): On master: BEGIN
2022-10-06 06:37:36.714664 (MainThread): Opening a new connection, currently in state closed
2022-10-06 06:37:36.723233 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:37:36.723435 (MainThread): On master: COMMIT
2022-10-06 06:37:36.723525 (MainThread): Using postgres connection "master".
2022-10-06 06:37:36.723605 (MainThread): On master: COMMIT
2022-10-06 06:37:36.723810 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:37:36.723905 (MainThread): On master: Close
2022-10-06 06:37:36.724166 (MainThread): 07:37:36 | 
2022-10-06 06:37:36.724270 (MainThread): 07:37:36 | Finished running 1 table model, 4 view models in 0.27s.
2022-10-06 06:37:36.724361 (MainThread): Connection 'master' was properly closed.
2022-10-06 06:37:36.724441 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 06:37:36.724518 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 06:37:36.724594 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 06:37:36.724668 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 06:37:36.727630 (MainThread): 
2022-10-06 06:37:36.727751 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 06:37:36.727848 (MainThread): 
2022-10-06 06:37:36.727941 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 06:37:36.728029 (MainThread):   column "order_id" specified more than once
2022-10-06 06:37:36.728112 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 06:37:36.728204 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 06:37:36.728348 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4aa04fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4aa827c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b4aaa8af0>]}
2022-10-06 06:37:36.728498 (MainThread): Flushing usage events
2022-10-06 06:38:39.336734 (MainThread): Running with dbt=0.21.1
2022-10-06 06:38:39.390976 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 06:38:39.391771 (MainThread): Tracking: tracking
2022-10-06 06:38:39.409062 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8640077b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8640073160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8640073d60>]}
2022-10-06 06:38:39.417280 (MainThread): Partial parsing not enabled
2022-10-06 06:38:39.423748 (MainThread): Parsing macros/catalog.sql
2022-10-06 06:38:39.426118 (MainThread): Parsing macros/relations.sql
2022-10-06 06:38:39.427149 (MainThread): Parsing macros/adapters.sql
2022-10-06 06:38:39.443237 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 06:38:39.444369 (MainThread): Parsing macros/core.sql
2022-10-06 06:38:39.446822 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 06:38:39.451497 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 06:38:39.458188 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 06:38:39.459274 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 06:38:39.470842 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 06:38:39.495650 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 06:38:39.511687 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 06:38:39.512835 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 06:38:39.519959 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 06:38:39.534337 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 06:38:39.544181 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 06:38:39.549732 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 06:38:39.554893 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 06:38:39.557416 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 06:38:39.558373 (MainThread): Parsing macros/etc/query.sql
2022-10-06 06:38:39.558978 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 06:38:39.559964 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 06:38:39.565803 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 06:38:39.566976 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 06:38:39.568552 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 06:38:39.569561 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 06:38:39.608804 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 06:38:39.609883 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 06:38:39.610624 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 06:38:39.611469 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 06:38:39.722565 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.730226 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.732109 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:38:39.734445 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.736716 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:38:39.754798 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:38:39.755926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:38:39.757005 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:38:39.758201 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:38:39.767061 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f39a004-6c6b-4260-b4a9-4b97f4f8518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86626faa90>]}
2022-10-06 06:38:39.769977 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 06:38:39.770283 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f39a004-6c6b-4260-b4a9-4b97f4f8518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866267acd0>]}
2022-10-06 06:38:39.770437 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 06:38:39.771357 (MainThread): 
2022-10-06 06:38:39.771579 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:38:39.772312 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 06:38:39.779153 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 06:38:39.779336 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 06:38:39.779438 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 06:38:39.807704 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.03 seconds
2022-10-06 06:38:39.809065 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 06:38:39.809891 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 06:38:39.813817 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:38:39.813938 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 06:38:39.814046 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 06:38:39.822479 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.822596 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:38:39.822686 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 06:38:39.825556 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.00 seconds
2022-10-06 06:38:39.826432 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 06:38:39.826646 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 06:38:39.829531 (MainThread): Using postgres connection "master".
2022-10-06 06:38:39.829643 (MainThread): On master: BEGIN
2022-10-06 06:38:39.829743 (MainThread): Opening a new connection, currently in state init
2022-10-06 06:38:39.839047 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.839168 (MainThread): Using postgres connection "master".
2022-10-06 06:38:39.839256 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 06:38:39.860214 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 06:38:39.861399 (MainThread): On master: ROLLBACK
2022-10-06 06:38:39.861656 (MainThread): Using postgres connection "master".
2022-10-06 06:38:39.861770 (MainThread): On master: BEGIN
2022-10-06 06:38:39.862083 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 06:38:39.862206 (MainThread): On master: COMMIT
2022-10-06 06:38:39.862310 (MainThread): Using postgres connection "master".
2022-10-06 06:38:39.862406 (MainThread): On master: COMMIT
2022-10-06 06:38:39.862607 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:38:39.862728 (MainThread): On master: Close
2022-10-06 06:38:39.862984 (MainThread): 07:38:39 | Concurrency: 5 threads (target='dev')
2022-10-06 06:38:39.863120 (MainThread): 07:38:39 | 
2022-10-06 06:38:39.864942 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 06:38:39.865115 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 06:38:39.865245 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 06:38:39.865443 (Thread-1): 07:38:39 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 06:38:39.865623 (Thread-2): 07:38:39 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 06:38:39.865791 (Thread-3): 07:38:39 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 06:38:39.866124 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.866968 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.867302 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.867470 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 06:38:39.867603 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 06:38:39.867721 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 06:38:39.868657 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:38:39.870402 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:38:39.871337 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:38:39.872214 (Thread-3): finished collecting timing info
2022-10-06 06:38:39.872418 (Thread-1): finished collecting timing info
2022-10-06 06:38:39.872525 (Thread-2): finished collecting timing info
2022-10-06 06:38:39.901691 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:38:39.908572 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:38:39.914256 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:38:39.914626 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.914726 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 06:38:39.914822 (Thread-3): Opening a new connection, currently in state init
2022-10-06 06:38:39.915096 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.915219 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.915322 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 06:38:39.915441 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 06:38:39.915546 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 06:38:39.915651 (Thread-2): Opening a new connection, currently in state init
2022-10-06 06:38:39.923423 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.923577 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.923694 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.923785 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.923875 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.923956 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.924047 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 06:38:39.924131 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 06:38:39.924212 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 06:38:39.925988 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 06:38:39.929801 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.929910 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 06:38:39.930022 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:38:39.931273 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.931377 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 06:38:39.931487 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:38:39.932662 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.932763 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 06:38:39.932882 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:38:39.934090 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.934191 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 06:38:39.934318 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:38:39.935722 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.935940 (Thread-2): SQL status: ALTER TABLE in 0.01 seconds
2022-10-06 06:38:39.936037 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:38:39.936122 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 06:38:39.938165 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.942270 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:38:39.942421 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 06:38:39.942526 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.942638 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:38:39.942798 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:38:39.943457 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:38:39.943559 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.943642 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:38:39.943740 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:38:39.946841 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:38:39.946946 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.947033 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:38:39.947136 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:38:39.949862 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:38:39.949963 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 06:38:39.950072 (Thread-3): SQL status: COMMIT in 0.01 seconds
2022-10-06 06:38:39.950888 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:38:39.950981 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 06:38:39.951080 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:38:39.951853 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:38:39.951942 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 06:38:39.952045 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:38:39.952708 (Thread-1): finished collecting timing info
2022-10-06 06:38:39.952829 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 06:38:39.952936 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:38:39.953533 (Thread-3): finished collecting timing info
2022-10-06 06:38:39.953641 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 06:38:39.953881 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f39a004-6c6b-4260-b4a9-4b97f4f8518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866273dac0>]}
2022-10-06 06:38:39.954095 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f39a004-6c6b-4260-b4a9-4b97f4f8518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866274e6d0>]}
2022-10-06 06:38:39.954309 (Thread-3): 07:38:39 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 06:38:39.954420 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 06:38:39.954618 (Thread-1): 07:38:39 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.09s]
2022-10-06 06:38:39.954792 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 06:38:39.954977 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 06:38:39.955588 (Thread-2): finished collecting timing info
2022-10-06 06:38:39.955699 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 06:38:39.955956 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f39a004-6c6b-4260-b4a9-4b97f4f8518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86627600a0>]}
2022-10-06 06:38:39.956154 (Thread-2): 07:38:39 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-06 06:38:39.956263 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 06:38:39.956381 (Thread-5): Began running node model.my_new_project.referencing
2022-10-06 06:38:39.956607 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 06:38:39.956749 (Thread-5): 07:38:39 | 4 of 5 START view model public.referencing........................... [RUN]
2022-10-06 06:38:39.956885 (Thread-3): 07:38:39 | 5 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 06:38:39.957120 (Thread-5): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:38:39.957308 (Thread-3): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:38:39.957421 (Thread-5): Compiling model.my_new_project.referencing
2022-10-06 06:38:39.957515 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 06:38:39.959066 (Thread-5): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 06:38:39.960550 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:38:39.961010 (Thread-3): finished collecting timing info
2022-10-06 06:38:39.962812 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:38:39.962969 (Thread-5): finished collecting timing info
2022-10-06 06:38:39.964233 (Thread-5): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 06:38:39.964553 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 06:38:39.964676 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:38:39.964773 (Thread-5): On model.my_new_project.referencing: BEGIN
2022-10-06 06:38:39.964872 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 06:38:39.964969 (Thread-5): Opening a new connection, currently in state init
2022-10-06 06:38:39.965055 (Thread-3): Opening a new connection, currently in state closed
2022-10-06 06:38:39.973069 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.973222 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.973345 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:38:39.973441 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 06:38:39.973531 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 06:38:39.973621 (Thread-5): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    with referencing as (
    select * from "postgres"."public"."customer_cte" c
    join "postgres"."public"."orders_cte" o
    on c.order_id=o.order_id
)
select * from referencing
  );

2022-10-06 06:38:39.974264 (Thread-5): Postgres error: column "order_id" specified more than once

2022-10-06 06:38:39.974365 (Thread-5): On model.my_new_project.referencing: ROLLBACK
2022-10-06 06:38:39.974704 (Thread-5): finished collecting timing info
2022-10-06 06:38:39.974815 (Thread-5): On model.my_new_project.referencing: Close
2022-10-06 06:38:39.975231 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 06:38:39.976615 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:38:39.976726 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 06:38:39.977073 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:38:39.977790 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:38:39.977885 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:38:39.977983 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:38:39.978529 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:38:39.979392 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:38:39.979482 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 06:38:39.975049 (Thread-5): Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "order_id" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 06:38:39.979943 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f39a004-6c6b-4260-b4a9-4b97f4f8518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86627203d0>]}
2022-10-06 06:38:39.980053 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:38:39.980673 (Thread-3): finished collecting timing info
2022-10-06 06:38:39.980789 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 06:38:39.981005 (Thread-5): 07:38:39 | 4 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.02s]
2022-10-06 06:38:39.981120 (Thread-5): Finished running node model.my_new_project.referencing
2022-10-06 06:38:39.981423 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f39a004-6c6b-4260-b4a9-4b97f4f8518d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f867014af10>]}
2022-10-06 06:38:39.981616 (Thread-3): 07:38:39 | 5 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 06:38:39.981716 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 06:38:39.982446 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:38:39.982558 (MainThread): Using postgres connection "master".
2022-10-06 06:38:39.982638 (MainThread): On master: BEGIN
2022-10-06 06:38:39.982722 (MainThread): Opening a new connection, currently in state closed
2022-10-06 06:38:39.990809 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:38:39.990997 (MainThread): On master: COMMIT
2022-10-06 06:38:39.991079 (MainThread): Using postgres connection "master".
2022-10-06 06:38:39.991156 (MainThread): On master: COMMIT
2022-10-06 06:38:39.991326 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:38:39.991427 (MainThread): On master: Close
2022-10-06 06:38:39.991670 (MainThread): 07:38:39 | 
2022-10-06 06:38:39.991772 (MainThread): 07:38:39 | Finished running 4 view models, 1 table model in 0.22s.
2022-10-06 06:38:39.991866 (MainThread): Connection 'master' was properly closed.
2022-10-06 06:38:39.991945 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 06:38:39.992023 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 06:38:39.992099 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 06:38:39.992171 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 06:38:39.995020 (MainThread): 
2022-10-06 06:38:39.995131 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 06:38:39.995229 (MainThread): 
2022-10-06 06:38:39.995322 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 06:38:39.995409 (MainThread):   column "order_id" specified more than once
2022-10-06 06:38:39.995492 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 06:38:39.995584 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 06:38:39.995730 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866267aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86626fa9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8670129160>]}
2022-10-06 06:38:39.995893 (MainThread): Flushing usage events
2022-10-06 06:58:48.605465 (MainThread): Running with dbt=0.21.1
2022-10-06 06:58:48.674996 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 06:58:48.679380 (MainThread): Tracking: tracking
2022-10-06 06:58:48.705842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb452a6e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb452a64130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb452a64610>]}
2022-10-06 06:58:48.715239 (MainThread): Partial parsing not enabled
2022-10-06 06:58:48.724972 (MainThread): Parsing macros/catalog.sql
2022-10-06 06:58:48.727620 (MainThread): Parsing macros/relations.sql
2022-10-06 06:58:48.728637 (MainThread): Parsing macros/adapters.sql
2022-10-06 06:58:48.744621 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 06:58:48.745765 (MainThread): Parsing macros/core.sql
2022-10-06 06:58:48.748249 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 06:58:48.752908 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 06:58:48.759679 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 06:58:48.760787 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 06:58:48.772485 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 06:58:48.797698 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 06:58:48.813962 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 06:58:48.815126 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 06:58:48.822283 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 06:58:48.836912 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 06:58:48.846946 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 06:58:48.852546 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 06:58:48.857782 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 06:58:48.860334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 06:58:48.861294 (MainThread): Parsing macros/etc/query.sql
2022-10-06 06:58:48.861903 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 06:58:48.862897 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 06:58:48.868811 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 06:58:48.869994 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 06:58:48.871583 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 06:58:48.872610 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 06:58:48.912548 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 06:58:48.913639 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 06:58:48.914388 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 06:58:48.915248 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 06:58:49.027012 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.034695 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.036574 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:58:49.039240 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.041527 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:58:49.059669 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:58:49.060791 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:58:49.061924 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:58:49.063122 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 06:58:49.073059 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c860b9b-72e7-4ead-bcb1-285f27989b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb440644130>]}
2022-10-06 06:58:49.076022 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 06:58:49.076327 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c860b9b-72e7-4ead-bcb1-285f27989b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb452a6ebb0>]}
2022-10-06 06:58:49.076479 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 06:58:49.077422 (MainThread): 
2022-10-06 06:58:49.077632 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:58:49.078402 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 06:58:49.085412 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 06:58:49.085666 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 06:58:49.085767 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 06:58:49.127758 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.04 seconds
2022-10-06 06:58:49.129491 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 06:58:49.130337 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 06:58:49.134410 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:58:49.134528 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 06:58:49.134627 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 06:58:49.143385 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.143509 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 06:58:49.143608 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 06:58:49.149054 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 06:58:49.150082 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 06:58:49.150390 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 06:58:49.153580 (MainThread): Using postgres connection "master".
2022-10-06 06:58:49.153714 (MainThread): On master: BEGIN
2022-10-06 06:58:49.153820 (MainThread): Opening a new connection, currently in state init
2022-10-06 06:58:49.163285 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.163408 (MainThread): Using postgres connection "master".
2022-10-06 06:58:49.163502 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 06:58:49.189424 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 06:58:49.190690 (MainThread): On master: ROLLBACK
2022-10-06 06:58:49.190965 (MainThread): Using postgres connection "master".
2022-10-06 06:58:49.191097 (MainThread): On master: BEGIN
2022-10-06 06:58:49.191449 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 06:58:49.191583 (MainThread): On master: COMMIT
2022-10-06 06:58:49.191697 (MainThread): Using postgres connection "master".
2022-10-06 06:58:49.191801 (MainThread): On master: COMMIT
2022-10-06 06:58:49.192014 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:58:49.192147 (MainThread): On master: Close
2022-10-06 06:58:49.192411 (MainThread): 07:58:49 | Concurrency: 5 threads (target='dev')
2022-10-06 06:58:49.192556 (MainThread): 07:58:49 | 
2022-10-06 06:58:49.194988 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 06:58:49.195164 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 06:58:49.195376 (Thread-1): 07:58:49 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 06:58:49.195492 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 06:58:49.195686 (Thread-2): 07:58:49 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 06:58:49.195995 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.196196 (Thread-3): 07:58:49 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 06:58:49.197013 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.197159 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 06:58:49.197429 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.197550 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 06:58:49.198544 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:58:49.198678 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 06:58:49.200438 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:58:49.201390 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:58:49.201725 (Thread-2): finished collecting timing info
2022-10-06 06:58:49.201863 (Thread-3): finished collecting timing info
2022-10-06 06:58:49.201967 (Thread-1): finished collecting timing info
2022-10-06 06:58:49.232555 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 06:58:49.232806 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 06:58:49.234181 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 06:58:49.234646 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.234772 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.234865 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 06:58:49.234957 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.235042 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 06:58:49.235131 (Thread-2): Opening a new connection, currently in state init
2022-10-06 06:58:49.235210 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 06:58:49.235293 (Thread-3): Opening a new connection, currently in state init
2022-10-06 06:58:49.235476 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 06:58:49.244107 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.244375 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.244479 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.244557 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.244653 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.244738 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 06:58:49.244820 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.244898 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 06:58:49.245020 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 06:58:49.247796 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 06:58:49.251818 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.251931 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:58:49.252012 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 06:58:49.252088 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 06:58:49.253428 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.254695 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.254812 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 06:58:49.254895 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:58:49.254983 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 06:58:49.256232 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.256332 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:58:49.256457 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 06:58:49.257671 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.257770 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:58:49.257879 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 06:58:49.259095 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.259226 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:58:49.259348 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 06:58:49.265784 (Thread-3): SQL status: ALTER TABLE in 0.01 seconds
2022-10-06 06:58:49.266468 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:58:49.267113 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:58:49.267197 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:58:49.267295 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.267378 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.267977 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:58:49.268075 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 06:58:49.268161 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 06:58:49.268243 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.268374 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 06:58:49.269339 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:58:49.272870 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 06:58:49.272973 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:58:49.273051 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 06:58:49.273122 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:58:49.273965 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 06:58:49.274824 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 06:58:49.274922 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 06:58:49.275008 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 06:58:49.276708 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:58:49.277369 (Thread-3): finished collecting timing info
2022-10-06 06:58:49.277478 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:58:49.277574 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 06:58:49.277653 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 06:58:49.278256 (Thread-1): finished collecting timing info
2022-10-06 06:58:49.278890 (Thread-2): finished collecting timing info
2022-10-06 06:58:49.279122 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c860b9b-72e7-4ead-bcb1-285f27989b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44077c0d0>]}
2022-10-06 06:58:49.279226 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 06:58:49.279327 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 06:58:49.279587 (Thread-3): 07:58:49 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.08s]
2022-10-06 06:58:49.279790 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c860b9b-72e7-4ead-bcb1-285f27989b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44072e880>]}
2022-10-06 06:58:49.279980 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c860b9b-72e7-4ead-bcb1-285f27989b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44073e6a0>]}
2022-10-06 06:58:49.280087 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 06:58:49.280301 (Thread-1): 07:58:49 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 06:58:49.280478 (Thread-2): 07:58:49 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 06:58:49.280691 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 06:58:49.280827 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 06:58:49.281317 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 06:58:49.281517 (Thread-5): 07:58:49 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 06:58:49.281643 (Thread-4): Began running node model.my_new_project.referencing
2022-10-06 06:58:49.281807 (Thread-4): 07:58:49 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 06:58:49.282010 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:58:49.282194 (Thread-4): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 06:58:49.282283 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 06:58:49.282373 (Thread-4): Compiling model.my_new_project.referencing
2022-10-06 06:58:49.283694 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:58:49.285478 (Thread-4): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 06:58:49.285831 (Thread-4): finished collecting timing info
2022-10-06 06:58:49.285937 (Thread-5): finished collecting timing info
2022-10-06 06:58:49.287186 (Thread-4): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 06:58:49.288388 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 06:58:49.288674 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 06:58:49.288786 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:58:49.288870 (Thread-4): On model.my_new_project.referencing: BEGIN
2022-10-06 06:58:49.288962 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 06:58:49.289054 (Thread-4): Opening a new connection, currently in state init
2022-10-06 06:58:49.289136 (Thread-5): Opening a new connection, currently in state init
2022-10-06 06:58:49.297628 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.297796 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.297922 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 06:58:49.298023 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:58:49.298118 (Thread-4): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select * from customers join orders on customers.order_id=orders.order_id
  );

2022-10-06 06:58:49.298211 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 06:58:49.298866 (Thread-4): Postgres error: column "order_id" specified more than once

2022-10-06 06:58:49.298961 (Thread-4): On model.my_new_project.referencing: ROLLBACK
2022-10-06 06:58:49.299311 (Thread-4): finished collecting timing info
2022-10-06 06:58:49.299427 (Thread-4): On model.my_new_project.referencing: Close
2022-10-06 06:58:49.299874 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 06:58:49.301284 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:58:49.301387 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 06:58:49.301880 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 06:58:49.302580 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:58:49.302677 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:58:49.302784 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 06:58:49.303185 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:58:49.304107 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 06:58:49.304202 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 06:58:49.304546 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 06:58:49.305215 (Thread-5): finished collecting timing info
2022-10-06 06:58:49.305323 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 06:58:49.305580 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c860b9b-72e7-4ead-bcb1-285f27989b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb452afae80>]}
2022-10-06 06:58:49.305875 (Thread-5): 07:58:49 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 06:58:49.305993 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 06:58:49.299674 (Thread-4): Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "order_id" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 06:58:49.307787 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c860b9b-72e7-4ead-bcb1-285f27989b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4407b5af0>]}
2022-10-06 06:58:49.308016 (Thread-4): 07:58:49 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.03s]
2022-10-06 06:58:49.308135 (Thread-4): Finished running node model.my_new_project.referencing
2022-10-06 06:58:49.308872 (MainThread): Acquiring new postgres connection "master".
2022-10-06 06:58:49.309004 (MainThread): Using postgres connection "master".
2022-10-06 06:58:49.309091 (MainThread): On master: BEGIN
2022-10-06 06:58:49.309179 (MainThread): Opening a new connection, currently in state closed
2022-10-06 06:58:49.316833 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 06:58:49.317018 (MainThread): On master: COMMIT
2022-10-06 06:58:49.317104 (MainThread): Using postgres connection "master".
2022-10-06 06:58:49.317183 (MainThread): On master: COMMIT
2022-10-06 06:58:49.317325 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 06:58:49.317414 (MainThread): On master: Close
2022-10-06 06:58:49.317670 (MainThread): 07:58:49 | 
2022-10-06 06:58:49.317783 (MainThread): 07:58:49 | Finished running 4 view models, 1 table model in 0.24s.
2022-10-06 06:58:49.317883 (MainThread): Connection 'master' was properly closed.
2022-10-06 06:58:49.317964 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 06:58:49.318040 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 06:58:49.318116 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 06:58:49.318192 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 06:58:49.318267 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 06:58:49.321221 (MainThread): 
2022-10-06 06:58:49.321339 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 06:58:49.321438 (MainThread): 
2022-10-06 06:58:49.321533 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 06:58:49.321623 (MainThread):   column "order_id" specified more than once
2022-10-06 06:58:49.321705 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 06:58:49.321797 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 06:58:49.321946 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4405d6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4406eaf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb44071e100>]}
2022-10-06 06:58:49.322101 (MainThread): Flushing usage events
2022-10-06 07:14:37.873489 (MainThread): Running with dbt=0.21.1
2022-10-06 07:14:37.950521 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:14:37.952172 (MainThread): Tracking: tracking
2022-10-06 07:14:37.974789 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dab0de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dab1b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dab1b0d0>]}
2022-10-06 07:14:37.983712 (MainThread): Partial parsing not enabled
2022-10-06 07:14:37.993382 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:14:37.996047 (MainThread): Parsing macros/relations.sql
2022-10-06 07:14:37.997097 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:14:38.013183 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:14:38.014321 (MainThread): Parsing macros/core.sql
2022-10-06 07:14:38.016825 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:14:38.021502 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:14:38.028281 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:14:38.029385 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:14:38.041186 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:14:38.067562 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:14:38.083974 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:14:38.085147 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:14:38.092492 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:14:38.107343 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:14:38.117471 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:14:38.123359 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:14:38.128771 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:14:38.131321 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:14:38.132279 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:14:38.132885 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:14:38.133888 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:14:38.139857 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:14:38.141046 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:14:38.142631 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:14:38.143653 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:14:38.183861 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:14:38.184952 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:14:38.185698 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:14:38.186555 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:14:38.299066 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.308318 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.310208 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:14:38.312874 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.315206 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:14:38.333479 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:14:38.334608 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:14:38.335680 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:14:38.336854 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:14:38.346065 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '937dae84-d9fc-45c6-81cc-4b96aee24be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dab20a90>]}
2022-10-06 07:14:38.349498 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:14:38.350109 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '937dae84-d9fc-45c6-81cc-4b96aee24be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dac175b0>]}
2022-10-06 07:14:38.350277 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:14:38.351244 (MainThread): 
2022-10-06 07:14:38.351464 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:14:38.352226 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:14:38.359421 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:14:38.359618 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:14:38.359734 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:14:38.422001 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 07:14:38.423547 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:14:38.424457 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:14:38.428702 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:14:38.428825 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:14:38.428931 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:14:38.438361 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.438502 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:14:38.438610 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:14:38.444114 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 07:14:38.445094 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:14:38.445394 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:14:38.448410 (MainThread): Using postgres connection "master".
2022-10-06 07:14:38.448532 (MainThread): On master: BEGIN
2022-10-06 07:14:38.448635 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:14:38.457971 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.458091 (MainThread): Using postgres connection "master".
2022-10-06 07:14:38.458184 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:14:38.488117 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 07:14:38.489348 (MainThread): On master: ROLLBACK
2022-10-06 07:14:38.489645 (MainThread): Using postgres connection "master".
2022-10-06 07:14:38.489769 (MainThread): On master: BEGIN
2022-10-06 07:14:38.490161 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:14:38.490297 (MainThread): On master: COMMIT
2022-10-06 07:14:38.490411 (MainThread): Using postgres connection "master".
2022-10-06 07:14:38.490515 (MainThread): On master: COMMIT
2022-10-06 07:14:38.490792 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:14:38.490926 (MainThread): On master: Close
2022-10-06 07:14:38.491175 (MainThread): 08:14:38 | Concurrency: 5 threads (target='dev')
2022-10-06 07:14:38.491321 (MainThread): 08:14:38 | 
2022-10-06 07:14:38.494554 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:14:38.494745 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:14:38.494961 (Thread-1): 08:14:38 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:14:38.495083 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:14:38.495272 (Thread-2): 08:14:38 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:14:38.495571 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.495767 (Thread-3): 08:14:38 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:14:38.496738 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.496943 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:14:38.497214 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.497345 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:14:38.498366 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:14:38.498523 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:14:38.500713 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:14:38.501762 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:14:38.502023 (Thread-1): finished collecting timing info
2022-10-06 07:14:38.520022 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:14:38.520200 (Thread-2): finished collecting timing info
2022-10-06 07:14:38.526759 (Thread-3): finished collecting timing info
2022-10-06 07:14:38.533259 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:14:38.534613 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:14:38.534894 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.535020 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:14:38.535136 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:14:38.535379 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.535487 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.535585 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:14:38.535677 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:14:38.535772 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:14:38.535870 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:14:38.543789 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.543939 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.544036 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.544123 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.544218 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.544306 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.544395 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:14:38.544486 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:14:38.544574 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:14:38.546838 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:14:38.550879 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.550991 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:14:38.551073 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:14:38.551148 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:14:38.552491 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.553801 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.553908 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.554002 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:14:38.554095 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:14:38.555317 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.555474 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:14:38.555972 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.556074 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.557271 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.557370 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.558599 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.558705 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:14:38.565489 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:14:38.565586 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:14:38.565713 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.565832 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:14:38.566301 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.566399 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.567027 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:14:38.567125 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:14:38.567770 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:14:38.567875 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.571340 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:14:38.571454 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.571541 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:14:38.571626 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:14:38.571727 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:14:38.572311 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:14:38.573144 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:14:38.573242 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:14:38.573324 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:14:38.574120 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:14:38.574237 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:14:38.574785 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 07:14:38.575418 (Thread-2): finished collecting timing info
2022-10-06 07:14:38.575532 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:14:38.575770 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937dae84-d9fc-45c6-81cc-4b96aee24be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dac91af0>]}
2022-10-06 07:14:38.575862 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:14:38.576075 (Thread-2): 08:14:38 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 07:14:38.576152 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:14:38.576729 (Thread-3): finished collecting timing info
2022-10-06 07:14:38.576868 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:14:38.577545 (Thread-1): finished collecting timing info
2022-10-06 07:14:38.577673 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:14:38.577919 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:14:38.578018 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:14:38.578242 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937dae84-d9fc-45c6-81cc-4b96aee24be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c85e25e0>]}
2022-10-06 07:14:38.578420 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937dae84-d9fc-45c6-81cc-4b96aee24be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c85a6460>]}
2022-10-06 07:14:38.578555 (Thread-5): 08:14:38 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:14:38.578795 (Thread-1): 08:14:38 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 07:14:38.578945 (Thread-3): 08:14:38 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.08s]
2022-10-06 07:14:38.579187 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:14:38.579312 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:14:38.579434 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:14:38.579548 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:14:38.581138 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:14:38.581340 (Thread-2): Began running node model.my_new_project.referencing
2022-10-06 07:14:38.581519 (Thread-2): 08:14:38 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:14:38.581770 (Thread-2): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:14:38.581881 (Thread-2): Compiling model.my_new_project.referencing
2022-10-06 07:14:38.583974 (Thread-2): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:14:38.584592 (Thread-5): finished collecting timing info
2022-10-06 07:14:38.586365 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:14:38.586622 (Thread-2): finished collecting timing info
2022-10-06 07:14:38.587867 (Thread-2): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:14:38.588050 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:14:38.588188 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:14:38.588321 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:14:38.588424 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:14:38.588517 (Thread-2): On model.my_new_project.referencing: BEGIN
2022-10-06 07:14:38.588700 (Thread-2): Opening a new connection, currently in state closed
2022-10-06 07:14:38.596581 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.596731 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.596867 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:14:38.596967 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:14:38.597065 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:14:38.597156 (Thread-2): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select * from customers
  );

2022-10-06 07:14:38.598887 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:14:38.600360 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:14:38.600471 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:14:38.601048 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.601144 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:14:38.601814 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:14:38.602929 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:14:38.603036 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:14:38.603128 (Thread-2): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 07:14:38.603217 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:14:38.603807 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:14:38.603904 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:14:38.604773 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:14:38.605451 (Thread-2): On model.my_new_project.referencing: COMMIT
2022-10-06 07:14:38.605545 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:14:38.605634 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:14:38.605739 (Thread-2): On model.my_new_project.referencing: COMMIT
2022-10-06 07:14:38.605941 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:14:38.606559 (Thread-5): finished collecting timing info
2022-10-06 07:14:38.606682 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:14:38.606786 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:14:38.607689 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:14:38.607793 (Thread-2): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */
drop view if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 07:14:38.608046 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937dae84-d9fc-45c6-81cc-4b96aee24be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c85d1610>]}
2022-10-06 07:14:38.608311 (Thread-5): 08:14:38 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 07:14:38.608429 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:14:38.608674 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:14:38.609634 (Thread-2): finished collecting timing info
2022-10-06 07:14:38.609906 (Thread-2): On model.my_new_project.referencing: Close
2022-10-06 07:14:38.610165 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '937dae84-d9fc-45c6-81cc-4b96aee24be5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dabd5970>]}
2022-10-06 07:14:38.610388 (Thread-2): 08:14:38 | 5 of 5 OK created view model public.referencing...................... [CREATE VIEW in 0.03s]
2022-10-06 07:14:38.610496 (Thread-2): Finished running node model.my_new_project.referencing
2022-10-06 07:14:38.611212 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:14:38.611332 (MainThread): Using postgres connection "master".
2022-10-06 07:14:38.611412 (MainThread): On master: BEGIN
2022-10-06 07:14:38.611493 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:14:38.619082 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:14:38.619199 (MainThread): On master: COMMIT
2022-10-06 07:14:38.619282 (MainThread): Using postgres connection "master".
2022-10-06 07:14:38.619357 (MainThread): On master: COMMIT
2022-10-06 07:14:38.619583 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:14:38.619676 (MainThread): On master: Close
2022-10-06 07:14:38.619879 (MainThread): 08:14:38 | 
2022-10-06 07:14:38.619981 (MainThread): 08:14:38 | Finished running 1 table model, 4 view models in 0.27s.
2022-10-06 07:14:38.620073 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:14:38.620151 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 07:14:38.620228 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:14:38.620302 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 07:14:38.620376 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:14:38.623393 (MainThread): 
2022-10-06 07:14:38.623547 (MainThread): Completed successfully
2022-10-06 07:14:38.623655 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-10-06 07:14:38.623825 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dac17af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4dabddf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4c84f16a0>]}
2022-10-06 07:14:38.623993 (MainThread): Flushing usage events
2022-10-06 07:15:21.887872 (MainThread): Running with dbt=0.21.1
2022-10-06 07:15:21.959247 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:15:21.960801 (MainThread): Tracking: tracking
2022-10-06 07:15:21.982230 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0129bde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0129cb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0129cba00>]}
2022-10-06 07:15:21.991226 (MainThread): Partial parsing not enabled
2022-10-06 07:15:22.000267 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:15:22.002841 (MainThread): Parsing macros/relations.sql
2022-10-06 07:15:22.003892 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:15:22.020490 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:15:22.021729 (MainThread): Parsing macros/core.sql
2022-10-06 07:15:22.024306 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:15:22.029068 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:15:22.035807 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:15:22.036909 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:15:22.048556 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:15:22.073266 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:15:22.089346 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:15:22.103512 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:15:22.111218 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:15:22.139498 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:15:22.149894 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:15:22.155680 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:15:22.160933 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:15:22.163504 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:15:22.164465 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:15:22.165080 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:15:22.166079 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:15:22.171956 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:15:22.173144 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:15:22.174747 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:15:22.175762 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:15:22.214529 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:15:22.215617 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:15:22.216367 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:15:22.217219 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:15:22.330001 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.338855 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.340758 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:15:22.343427 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.345792 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:15:22.364030 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:15:22.365145 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:15:22.366210 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:15:22.367385 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:15:22.376429 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c40c6e5e-a921-4d36-8abd-665e35de9782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc020482fd0>]}
2022-10-06 07:15:22.379320 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:15:22.379624 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c40c6e5e-a921-4d36-8abd-665e35de9782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc012a4ca00>]}
2022-10-06 07:15:22.379785 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:15:22.380731 (MainThread): 
2022-10-06 07:15:22.380996 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:15:22.381803 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:15:22.388629 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:15:22.388797 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:15:22.388901 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:15:22.451721 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 07:15:22.453301 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:15:22.454262 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:15:22.458646 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:15:22.458779 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:15:22.458884 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:15:22.468617 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.468746 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:15:22.468841 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:15:22.472907 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 07:15:22.473891 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:15:22.474182 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:15:22.477231 (MainThread): Using postgres connection "master".
2022-10-06 07:15:22.477349 (MainThread): On master: BEGIN
2022-10-06 07:15:22.477453 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:15:22.486793 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.486918 (MainThread): Using postgres connection "master".
2022-10-06 07:15:22.487011 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:15:22.511969 (MainThread): SQL status: SELECT 5 in 0.02 seconds
2022-10-06 07:15:22.513286 (MainThread): On master: ROLLBACK
2022-10-06 07:15:22.513557 (MainThread): Using postgres connection "master".
2022-10-06 07:15:22.513674 (MainThread): On master: BEGIN
2022-10-06 07:15:22.513995 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:15:22.514124 (MainThread): On master: COMMIT
2022-10-06 07:15:22.514237 (MainThread): Using postgres connection "master".
2022-10-06 07:15:22.514341 (MainThread): On master: COMMIT
2022-10-06 07:15:22.514605 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:15:22.514728 (MainThread): On master: Close
2022-10-06 07:15:22.514956 (MainThread): 08:15:22 | Concurrency: 5 threads (target='dev')
2022-10-06 07:15:22.515087 (MainThread): 08:15:22 | 
2022-10-06 07:15:22.517134 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:15:22.517310 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:15:22.517483 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:15:22.517693 (Thread-1): 08:15:22 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:15:22.517897 (Thread-2): 08:15:22 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:15:22.518090 (Thread-3): 08:15:22 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:15:22.518394 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.519252 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.519592 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.519777 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:15:22.519928 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:15:22.520062 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:15:22.521130 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:15:22.523348 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:15:22.524542 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:15:22.525073 (Thread-2): finished collecting timing info
2022-10-06 07:15:22.525236 (Thread-1): finished collecting timing info
2022-10-06 07:15:22.525358 (Thread-3): finished collecting timing info
2022-10-06 07:15:22.550403 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:15:22.557957 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:15:22.556335 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:15:22.558639 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.558773 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:15:22.558897 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.559005 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:15:22.559098 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.559191 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:15:22.559412 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:15:22.559510 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:15:22.559616 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:15:22.572786 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.573009 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.573112 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:15:22.573388 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.573537 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.573643 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:15:22.573754 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.573850 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.573933 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:15:22.576831 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:15:22.581227 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.581356 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:15:22.581449 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:15:22.581528 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:15:22.582907 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.584160 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.584299 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:15:22.584399 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:15:22.584710 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:15:22.585986 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.586092 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:15:22.586184 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:15:22.586263 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:15:22.587495 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.588750 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.588854 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:15:22.588941 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:15:22.589029 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:15:22.595805 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:15:22.596002 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.596087 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:15:22.596613 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:15:22.596723 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:15:22.597391 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:15:22.597487 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:15:22.598150 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:15:22.598251 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.601826 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:15:22.601942 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.602027 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:15:22.602110 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:15:22.602189 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:15:22.602801 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:15:22.603647 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:15:22.603745 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:15:22.603827 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:15:22.604647 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:15:22.604783 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:15:22.605045 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 07:15:22.605696 (Thread-2): finished collecting timing info
2022-10-06 07:15:22.605810 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:15:22.606061 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40c6e5e-a921-4d36-8abd-665e35de9782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc020552850>]}
2022-10-06 07:15:22.606285 (Thread-2): 08:15:22 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-06 07:15:22.606393 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:15:22.606637 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:15:22.606808 (Thread-5): 08:15:22 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:15:22.606909 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:15:22.607576 (Thread-3): finished collecting timing info
2022-10-06 07:15:22.607783 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:15:22.607880 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:15:22.607964 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:15:22.608075 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:15:22.608287 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40c6e5e-a921-4d36-8abd-665e35de9782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc012a937c0>]}
2022-10-06 07:15:22.608914 (Thread-1): finished collecting timing info
2022-10-06 07:15:22.610341 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:15:22.610623 (Thread-3): 08:15:22 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 07:15:22.610748 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:15:22.610955 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:15:22.611411 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40c6e5e-a921-4d36-8abd-665e35de9782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc020580040>]}
2022-10-06 07:15:22.611789 (Thread-1): 08:15:22 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.09s]
2022-10-06 07:15:22.611935 (Thread-5): finished collecting timing info
2022-10-06 07:15:22.612070 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:15:22.614054 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:15:22.614453 (Thread-2): Began running node model.my_new_project.referencing
2022-10-06 07:15:22.614627 (Thread-2): 08:15:22 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:15:22.614852 (Thread-2): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:15:22.614960 (Thread-2): Compiling model.my_new_project.referencing
2022-10-06 07:15:22.616911 (Thread-2): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:15:22.617167 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:15:22.617272 (Thread-2): finished collecting timing info
2022-10-06 07:15:22.617384 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:15:22.618682 (Thread-2): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:15:22.618794 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:15:22.619072 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:15:22.619163 (Thread-2): On model.my_new_project.referencing: BEGIN
2022-10-06 07:15:22.619247 (Thread-2): Opening a new connection, currently in state closed
2022-10-06 07:15:22.627212 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.627422 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.627554 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:15:22.627659 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:15:22.627756 (Thread-2): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select * from customers c join orders o using('order_id')
  );

2022-10-06 07:15:22.627851 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:15:22.628179 (Thread-2): Postgres error: syntax error at or near "'order_id'"
LINE 16: select * from customers c join orders o using('order_id')
                                                       ^

2022-10-06 07:15:22.628280 (Thread-2): On model.my_new_project.referencing: ROLLBACK
2022-10-06 07:15:22.628637 (Thread-2): finished collecting timing info
2022-10-06 07:15:22.628756 (Thread-2): On model.my_new_project.referencing: Close
2022-10-06 07:15:22.629570 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:15:22.631054 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:15:22.631154 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:15:22.631600 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:15:22.632345 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:15:22.632436 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:15:22.632552 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:15:22.632906 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:15:22.633720 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:15:22.633812 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:15:22.634044 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:15:22.634792 (Thread-5): finished collecting timing info
2022-10-06 07:15:22.634906 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:15:22.635195 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40c6e5e-a921-4d36-8abd-665e35de9782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc012a5c850>]}
2022-10-06 07:15:22.635427 (Thread-5): 08:15:22 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 07:15:22.635591 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:15:22.628989 (Thread-2): Database Error in model referencing (models/referencing.sql)
  syntax error at or near "'order_id'"
  LINE 16: select * from customers c join orders o using('order_id')
                                                         ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "'order_id'"
LINE 16: select * from customers c join orders o using('order_id')
                                                       ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  syntax error at or near "'order_id'"
  LINE 16: select * from customers c join orders o using('order_id')
                                                         ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:15:22.637325 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40c6e5e-a921-4d36-8abd-665e35de9782', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc012ac9a60>]}
2022-10-06 07:15:22.637528 (Thread-2): 08:15:22 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.02s]
2022-10-06 07:15:22.637640 (Thread-2): Finished running node model.my_new_project.referencing
2022-10-06 07:15:22.638393 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:15:22.638526 (MainThread): Using postgres connection "master".
2022-10-06 07:15:22.638613 (MainThread): On master: BEGIN
2022-10-06 07:15:22.638700 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:15:22.648970 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:15:22.649160 (MainThread): On master: COMMIT
2022-10-06 07:15:22.649250 (MainThread): Using postgres connection "master".
2022-10-06 07:15:22.649331 (MainThread): On master: COMMIT
2022-10-06 07:15:22.649542 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:15:22.649640 (MainThread): On master: Close
2022-10-06 07:15:22.649897 (MainThread): 08:15:22 | 
2022-10-06 07:15:22.650008 (MainThread): 08:15:22 | Finished running 1 table model, 4 view models in 0.27s.
2022-10-06 07:15:22.650109 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:15:22.650188 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 07:15:22.650265 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:15:22.650341 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 07:15:22.650417 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:15:22.653307 (MainThread): 
2022-10-06 07:15:22.653434 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 07:15:22.653534 (MainThread): 
2022-10-06 07:15:22.653628 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 07:15:22.653717 (MainThread):   syntax error at or near "'order_id'"
2022-10-06 07:15:22.653801 (MainThread):   LINE 16: select * from customers c join orders o using('order_id')
2022-10-06 07:15:22.653885 (MainThread):                                                          ^
2022-10-06 07:15:22.653966 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:15:22.654067 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 07:15:22.654212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc012ac9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc0205abe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc020503c10>]}
2022-10-06 07:15:22.654366 (MainThread): Flushing usage events
2022-10-06 07:23:00.051080 (MainThread): Running with dbt=0.21.1
2022-10-06 07:23:00.120815 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:23:00.122664 (MainThread): Tracking: tracking
2022-10-06 07:23:00.149268 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2b0f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2b0b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2b0ba60>]}
2022-10-06 07:23:00.158348 (MainThread): Partial parsing not enabled
2022-10-06 07:23:00.168338 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:23:00.171084 (MainThread): Parsing macros/relations.sql
2022-10-06 07:23:00.172195 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:23:00.188897 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:23:00.190054 (MainThread): Parsing macros/core.sql
2022-10-06 07:23:00.192576 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:23:00.197402 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:23:00.204408 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:23:00.205537 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:23:00.217531 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:23:00.244989 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:23:00.262016 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:23:00.263189 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:23:00.270638 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:23:00.286189 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:23:00.296719 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:23:00.302703 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:23:00.308234 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:23:00.310823 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:23:00.311793 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:23:00.312408 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:23:00.313423 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:23:00.319537 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:23:00.320731 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:23:00.322325 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:23:00.323354 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:23:00.365257 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:23:00.366360 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:23:00.367106 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:23:00.367964 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:23:00.479533 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.487207 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.489098 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:23:00.491782 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.494086 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:23:00.512242 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:23:00.513357 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:23:00.514429 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:23:00.515616 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:23:00.525969 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5230e3cd-8fc7-4af8-8fee-5147406bdab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2be50a0>]}
2022-10-06 07:23:00.529658 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:23:00.530365 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5230e3cd-8fc7-4af8-8fee-5147406bdab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2b0fd60>]}
2022-10-06 07:23:00.530529 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:23:00.531511 (MainThread): 
2022-10-06 07:23:00.531754 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:23:00.532493 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:23:00.539437 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:23:00.539620 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:23:00.539729 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:23:00.596863 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 07:23:00.598669 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:23:00.599546 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:23:00.603900 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:23:00.604045 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:23:00.604155 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:23:00.613652 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.613801 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:23:00.613910 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:23:00.619423 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 07:23:00.620417 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:23:00.620714 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:23:00.623856 (MainThread): Using postgres connection "master".
2022-10-06 07:23:00.623977 (MainThread): On master: BEGIN
2022-10-06 07:23:00.624082 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:23:00.633439 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.633559 (MainThread): Using postgres connection "master".
2022-10-06 07:23:00.633653 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:23:00.655915 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 07:23:00.657145 (MainThread): On master: ROLLBACK
2022-10-06 07:23:00.657423 (MainThread): Using postgres connection "master".
2022-10-06 07:23:00.657544 (MainThread): On master: BEGIN
2022-10-06 07:23:00.657882 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:23:00.658027 (MainThread): On master: COMMIT
2022-10-06 07:23:00.658141 (MainThread): Using postgres connection "master".
2022-10-06 07:23:00.658245 (MainThread): On master: COMMIT
2022-10-06 07:23:00.658459 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:23:00.658588 (MainThread): On master: Close
2022-10-06 07:23:00.658839 (MainThread): 08:23:00 | Concurrency: 5 threads (target='dev')
2022-10-06 07:23:00.658983 (MainThread): 08:23:00 | 
2022-10-06 07:23:00.661340 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:23:00.661522 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:23:00.661661 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:23:00.661857 (Thread-1): 08:23:00 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:23:00.662041 (Thread-2): 08:23:00 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:23:00.662259 (Thread-3): 08:23:00 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:23:00.662589 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.663413 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.663740 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.663919 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:23:00.664059 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:23:00.664180 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:23:00.665224 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:23:00.667169 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:23:00.668356 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:23:00.669094 (Thread-2): finished collecting timing info
2022-10-06 07:23:00.687480 (Thread-1): finished collecting timing info
2022-10-06 07:23:00.687621 (Thread-3): finished collecting timing info
2022-10-06 07:23:00.687417 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:23:00.699573 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:23:00.700961 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:23:00.701385 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.701516 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.701605 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:23:00.701696 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.701785 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:23:00.701874 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:23:00.701954 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:23:00.702038 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:23:00.702227 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:23:00.716294 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.716483 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.716588 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.716681 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.716767 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:23:00.716884 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:23:00.717186 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.717287 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.717371 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:23:00.720748 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:23:00.725199 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.725326 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:23:00.725408 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:23:00.725485 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:23:00.726873 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.728123 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.728261 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:23:00.728363 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:23:00.728837 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:23:00.730113 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.730220 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:23:00.730313 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:23:00.730391 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:23:00.731611 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.732916 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.733026 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:23:00.733112 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:23:00.733199 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:23:00.740001 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:23:00.740158 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.740247 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:23:00.740337 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:23:00.740458 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:23:00.741125 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:23:00.741225 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:23:00.741875 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:23:00.741976 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.745472 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:23:00.745587 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.745675 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:23:00.745760 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:23:00.745843 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:23:00.746331 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:23:00.747172 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:23:00.747269 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:23:00.747346 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:23:00.748171 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:23:00.748294 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:23:00.749177 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 07:23:00.749804 (Thread-2): finished collecting timing info
2022-10-06 07:23:00.749912 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:23:00.750011 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:23:00.750103 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:23:00.750669 (Thread-1): finished collecting timing info
2022-10-06 07:23:00.751315 (Thread-3): finished collecting timing info
2022-10-06 07:23:00.751542 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5230e3cd-8fc7-4af8-8fee-5147406bdab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2ccd5b0>]}
2022-10-06 07:23:00.751641 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:23:00.751737 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:23:00.751974 (Thread-2): 08:23:00 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-06 07:23:00.752202 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5230e3cd-8fc7-4af8-8fee-5147406bdab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a043bf70>]}
2022-10-06 07:23:00.752391 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5230e3cd-8fc7-4af8-8fee-5147406bdab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a0416ac0>]}
2022-10-06 07:23:00.752516 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:23:00.752742 (Thread-3): 08:23:00 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 07:23:00.752950 (Thread-1): 08:23:00 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.09s]
2022-10-06 07:23:00.753099 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:23:00.753240 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:23:00.753640 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:23:00.753762 (Thread-4): Began running node model.my_new_project.referencing
2022-10-06 07:23:00.753899 (Thread-5): 08:23:00 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:23:00.754027 (Thread-4): 08:23:00 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:23:00.754238 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:23:00.754415 (Thread-4): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:23:00.754527 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:23:00.754620 (Thread-4): Compiling model.my_new_project.referencing
2022-10-06 07:23:00.755961 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:23:00.757949 (Thread-4): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:23:00.758553 (Thread-5): finished collecting timing info
2022-10-06 07:23:00.760045 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:23:00.760283 (Thread-4): finished collecting timing info
2022-10-06 07:23:00.762006 (Thread-4): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:23:00.762311 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:23:00.762424 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:23:00.762538 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:23:00.762632 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:23:00.762719 (Thread-4): On model.my_new_project.referencing: BEGIN
2022-10-06 07:23:00.762889 (Thread-4): Opening a new connection, currently in state init
2022-10-06 07:23:00.771514 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.771625 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.771720 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:23:00.771814 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:23:00.771901 (Thread-4): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select * from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 07:23:00.771994 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:23:00.773175 (Thread-4): Postgres error: column "order_id" specified more than once

2022-10-06 07:23:00.773277 (Thread-4): On model.my_new_project.referencing: ROLLBACK
2022-10-06 07:23:00.773760 (Thread-4): finished collecting timing info
2022-10-06 07:23:00.773887 (Thread-4): On model.my_new_project.referencing: Close
2022-10-06 07:23:00.775205 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:23:00.776963 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:23:00.777144 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:23:00.777792 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:23:00.778784 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:23:00.778948 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:23:00.779057 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:23:00.779431 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:23:00.780466 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:23:00.780598 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:23:00.780819 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:23:00.781518 (Thread-5): finished collecting timing info
2022-10-06 07:23:00.781670 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:23:00.781947 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5230e3cd-8fc7-4af8-8fee-5147406bdab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2cf10a0>]}
2022-10-06 07:23:00.782174 (Thread-5): 08:23:00 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 07:23:00.782333 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:23:00.774130 (Thread-4): Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "order_id" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:23:00.783203 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5230e3cd-8fc7-4af8-8fee-5147406bdab2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5a043f100>]}
2022-10-06 07:23:00.783400 (Thread-4): 08:23:00 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.03s]
2022-10-06 07:23:00.783507 (Thread-4): Finished running node model.my_new_project.referencing
2022-10-06 07:23:00.784244 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:23:00.784365 (MainThread): Using postgres connection "master".
2022-10-06 07:23:00.784445 (MainThread): On master: BEGIN
2022-10-06 07:23:00.784524 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:23:00.792617 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:23:00.792836 (MainThread): On master: COMMIT
2022-10-06 07:23:00.792927 (MainThread): Using postgres connection "master".
2022-10-06 07:23:00.793009 (MainThread): On master: COMMIT
2022-10-06 07:23:00.793177 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:23:00.793307 (MainThread): On master: Close
2022-10-06 07:23:00.793662 (MainThread): 08:23:00 | 
2022-10-06 07:23:00.793774 (MainThread): 08:23:00 | Finished running 1 table model, 4 view models in 0.26s.
2022-10-06 07:23:00.793883 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:23:00.793964 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 07:23:00.794041 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 07:23:00.794116 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 07:23:00.794196 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:23:00.794271 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:23:00.797442 (MainThread): 
2022-10-06 07:23:00.797585 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 07:23:00.797679 (MainThread): 
2022-10-06 07:23:00.797770 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 07:23:00.797856 (MainThread):   column "order_id" specified more than once
2022-10-06 07:23:00.797939 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:23:00.798032 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 07:23:00.798175 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2b540d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2c8cd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b2cbe100>]}
2022-10-06 07:23:00.798334 (MainThread): Flushing usage events
2022-10-06 07:27:42.679043 (MainThread): Running with dbt=0.21.1
2022-10-06 07:27:42.748366 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:27:42.750039 (MainThread): Tracking: tracking
2022-10-06 07:27:42.778716 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992bb3be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992bbe3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992c71220>]}
2022-10-06 07:27:42.787812 (MainThread): Partial parsing not enabled
2022-10-06 07:27:42.797619 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:27:42.800340 (MainThread): Parsing macros/relations.sql
2022-10-06 07:27:42.801401 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:27:42.818206 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:27:42.819392 (MainThread): Parsing macros/core.sql
2022-10-06 07:27:42.822040 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:27:42.826862 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:27:42.833839 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:27:42.834983 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:27:42.847180 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:27:42.874049 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:27:42.891114 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:27:42.892308 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:27:42.899718 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:27:42.915152 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:27:42.925720 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:27:42.931531 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:27:42.936952 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:27:42.939582 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:27:42.940565 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:27:42.941190 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:27:42.942213 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:27:42.948389 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:27:42.949599 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:27:42.951254 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:27:42.952304 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:27:42.994734 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:27:42.995862 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:27:42.996628 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:27:42.997508 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:27:43.111135 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.118845 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.120737 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:27:43.123418 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.125711 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:27:43.144066 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:27:43.145189 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:27:43.146270 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:27:43.147457 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:27:43.157385 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '917ae47e-a7bc-46b5-88e7-fddee384b6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a03e56d0>]}
2022-10-06 07:27:43.161259 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:27:43.161986 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '917ae47e-a7bc-46b5-88e7-fddee384b6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0449100>]}
2022-10-06 07:27:43.162174 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:27:43.163171 (MainThread): 
2022-10-06 07:27:43.163386 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:27:43.164175 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:27:43.171341 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:27:43.171515 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:27:43.171622 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:27:43.230857 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 07:27:43.232699 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:27:43.233614 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:27:43.237984 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:27:43.238108 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:27:43.238213 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:27:43.247444 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.247558 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:27:43.247657 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:27:43.253220 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 07:27:43.254181 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:27:43.254473 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:27:43.257610 (MainThread): Using postgres connection "master".
2022-10-06 07:27:43.257736 (MainThread): On master: BEGIN
2022-10-06 07:27:43.257843 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:27:43.267190 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.267321 (MainThread): Using postgres connection "master".
2022-10-06 07:27:43.267415 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:27:43.286365 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 07:27:43.287715 (MainThread): On master: ROLLBACK
2022-10-06 07:27:43.288071 (MainThread): Using postgres connection "master".
2022-10-06 07:27:43.288186 (MainThread): On master: BEGIN
2022-10-06 07:27:43.288540 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:27:43.288658 (MainThread): On master: COMMIT
2022-10-06 07:27:43.288763 (MainThread): Using postgres connection "master".
2022-10-06 07:27:43.288859 (MainThread): On master: COMMIT
2022-10-06 07:27:43.289069 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:27:43.289187 (MainThread): On master: Close
2022-10-06 07:27:43.289450 (MainThread): 08:27:43 | Concurrency: 5 threads (target='dev')
2022-10-06 07:27:43.289589 (MainThread): 08:27:43 | 
2022-10-06 07:27:43.291940 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:27:43.292148 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:27:43.292315 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:27:43.292547 (Thread-1): 08:27:43 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:27:43.292758 (Thread-2): 08:27:43 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:27:43.292956 (Thread-3): 08:27:43 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:27:43.293321 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.294223 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.294391 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:27:43.294649 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.294778 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:27:43.295823 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:27:43.295960 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:27:43.298271 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:27:43.299839 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:27:43.300318 (Thread-1): finished collecting timing info
2022-10-06 07:27:43.300479 (Thread-2): finished collecting timing info
2022-10-06 07:27:43.318466 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:27:43.332018 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:27:43.338620 (Thread-3): finished collecting timing info
2022-10-06 07:27:43.340500 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:27:43.340704 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.340868 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:27:43.358356 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:27:43.358519 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.358799 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:27:43.358951 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.359060 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:27:43.359173 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:27:43.359395 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:27:43.367553 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.367675 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.367769 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.367877 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.367977 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.368072 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.368168 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:27:43.368265 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:27:43.368361 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:27:43.370962 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:27:43.375526 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.375655 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:27:43.375751 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:27:43.375839 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:27:43.377406 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.378841 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.379001 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:27:43.379119 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:27:43.379390 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:27:43.380759 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.380875 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:27:43.380969 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:27:43.381056 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:27:43.382368 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.383736 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.383853 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:27:43.383956 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:27:43.384052 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:27:43.391216 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:27:43.391327 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:27:43.391457 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.392134 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:27:43.392233 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:27:43.392324 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:27:43.392416 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.393054 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:27:43.393178 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:27:43.393274 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.393388 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:27:43.394016 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:27:43.397622 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:27:43.397729 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:27:43.397809 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:27:43.397885 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:27:43.398731 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:27:43.399611 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:27:43.399721 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:27:43.399811 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:27:43.401456 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:27:43.402136 (Thread-3): finished collecting timing info
2022-10-06 07:27:43.402248 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:27:43.402348 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:27:43.402957 (Thread-1): finished collecting timing info
2022-10-06 07:27:43.403066 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 07:27:43.403317 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '917ae47e-a7bc-46b5-88e7-fddee384b6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0544fd0>]}
2022-10-06 07:27:43.403406 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:27:43.404005 (Thread-2): finished collecting timing info
2022-10-06 07:27:43.404240 (Thread-3): 08:27:43 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.11s]
2022-10-06 07:27:43.404446 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '917ae47e-a7bc-46b5-88e7-fddee384b6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0413910>]}
2022-10-06 07:27:43.404534 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:27:43.404757 (Thread-1): 08:27:43 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.11s]
2022-10-06 07:27:43.404845 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:27:43.404992 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:27:43.405403 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '917ae47e-a7bc-46b5-88e7-fddee384b6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0521af0>]}
2022-10-06 07:27:43.405567 (Thread-5): Began running node model.my_new_project.referencing
2022-10-06 07:27:43.405739 (Thread-5): 08:27:43 | 4 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:27:43.405933 (Thread-2): 08:27:43 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.11s]
2022-10-06 07:27:43.406145 (Thread-5): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:27:43.406271 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:27:43.406380 (Thread-5): Compiling model.my_new_project.referencing
2022-10-06 07:27:43.406571 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:27:43.408488 (Thread-5): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:27:43.408690 (Thread-3): 08:27:43 | 5 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:27:43.409023 (Thread-3): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:27:43.409156 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:27:43.410793 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:27:43.411056 (Thread-5): finished collecting timing info
2022-10-06 07:27:43.412838 (Thread-5): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:27:43.413094 (Thread-3): finished collecting timing info
2022-10-06 07:27:43.414426 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:27:43.414615 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:27:43.414742 (Thread-5): On model.my_new_project.referencing: BEGIN
2022-10-06 07:27:43.414842 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:27:43.414952 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:27:43.415126 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:27:43.415216 (Thread-3): Opening a new connection, currently in state closed
2022-10-06 07:27:43.422755 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.422902 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.423018 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:27:43.423115 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:27:43.423208 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:27:43.423299 (Thread-5): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select * except c.order_id from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 07:27:43.423634 (Thread-5): Postgres error: syntax error at or near "c"
LINE 16: select * except c.order_id from customers c join orders o on...
                         ^

2022-10-06 07:27:43.423729 (Thread-5): On model.my_new_project.referencing: ROLLBACK
2022-10-06 07:27:43.424091 (Thread-5): finished collecting timing info
2022-10-06 07:27:43.424212 (Thread-5): On model.my_new_project.referencing: Close
2022-10-06 07:27:43.424961 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:27:43.426401 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:27:43.426514 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:27:43.426984 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:27:43.427665 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:27:43.427784 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:27:43.427863 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:27:43.424453 (Thread-5): Database Error in model referencing (models/referencing.sql)
  syntax error at or near "c"
  LINE 16: select * except c.order_id from customers c join orders o on...
                           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "c"
LINE 16: select * except c.order_id from customers c join orders o on...
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  syntax error at or near "c"
  LINE 16: select * except c.order_id from customers c join orders o on...
                           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:27:43.430184 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '917ae47e-a7bc-46b5-88e7-fddee384b6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb992ce08b0>]}
2022-10-06 07:27:43.430409 (Thread-5): 08:27:43 | 4 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.02s]
2022-10-06 07:27:43.430528 (Thread-5): Finished running node model.my_new_project.referencing
2022-10-06 07:27:43.435873 (Thread-3): SQL status: COMMIT in 0.01 seconds
2022-10-06 07:27:43.436956 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:27:43.437083 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:27:43.437341 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:27:43.438397 (Thread-3): finished collecting timing info
2022-10-06 07:27:43.438592 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:27:43.438866 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '917ae47e-a7bc-46b5-88e7-fddee384b6c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0552130>]}
2022-10-06 07:27:43.439091 (Thread-3): 08:27:43 | 5 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 07:27:43.439208 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:27:43.439966 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:27:43.440091 (MainThread): Using postgres connection "master".
2022-10-06 07:27:43.440175 (MainThread): On master: BEGIN
2022-10-06 07:27:43.440262 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:27:43.448573 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:27:43.448694 (MainThread): On master: COMMIT
2022-10-06 07:27:43.448782 (MainThread): Using postgres connection "master".
2022-10-06 07:27:43.448862 (MainThread): On master: COMMIT
2022-10-06 07:27:43.449087 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:27:43.449190 (MainThread): On master: Close
2022-10-06 07:27:43.449412 (MainThread): 08:27:43 | 
2022-10-06 07:27:43.449520 (MainThread): 08:27:43 | Finished running 4 view models, 1 table model in 0.29s.
2022-10-06 07:27:43.449617 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:27:43.449700 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 07:27:43.449778 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 07:27:43.449856 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:27:43.449932 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:27:43.453400 (MainThread): 
2022-10-06 07:27:43.453584 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 07:27:43.453685 (MainThread): 
2022-10-06 07:27:43.453788 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 07:27:43.453878 (MainThread):   syntax error at or near "c"
2022-10-06 07:27:43.453966 (MainThread):   LINE 16: select * except c.order_id from customers c join orders o on...
2022-10-06 07:27:43.454050 (MainThread):                            ^
2022-10-06 07:27:43.454142 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:27:43.454243 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 07:27:43.454422 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a0405fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a041a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9a04e8520>]}
2022-10-06 07:27:43.454598 (MainThread): Flushing usage events
2022-10-06 07:32:12.490083 (MainThread): Running with dbt=0.21.1
2022-10-06 07:32:12.563094 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:32:12.564779 (MainThread): Tracking: tracking
2022-10-06 07:32:12.590679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950ab73cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950ac35c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950ac35700>]}
2022-10-06 07:32:12.599454 (MainThread): Partial parsing not enabled
2022-10-06 07:32:12.609225 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:32:12.611799 (MainThread): Parsing macros/relations.sql
2022-10-06 07:32:12.612813 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:32:12.628733 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:32:12.629870 (MainThread): Parsing macros/core.sql
2022-10-06 07:32:12.632397 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:32:12.637064 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:32:12.643864 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:32:12.644968 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:32:12.656796 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:32:12.681789 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:32:12.698078 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:32:12.699246 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:32:12.706491 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:32:12.720989 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:32:12.730914 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:32:12.736569 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:32:12.741785 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:32:12.744355 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:32:12.745323 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:32:12.745934 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:32:12.746937 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:32:12.752966 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:32:12.754163 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:32:12.755792 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:32:12.756834 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:32:12.795901 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:32:12.796999 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:32:12.797764 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:32:12.798637 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:32:12.910867 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:12.919450 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:12.921321 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:32:12.923964 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:12.926241 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:32:12.944799 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:32:12.945950 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:32:12.947043 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:32:12.948257 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:32:12.957798 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22094115-b440-4acb-8249-bb3b48e2183c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f950ac8f580>]}
2022-10-06 07:32:12.961364 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:32:12.961956 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22094115-b440-4acb-8249-bb3b48e2183c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95103d5100>]}
2022-10-06 07:32:12.962129 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:32:12.963108 (MainThread): 
2022-10-06 07:32:12.963324 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:32:12.964091 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:32:12.970882 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:32:12.971054 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:32:12.971153 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:32:13.033921 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 07:32:13.035667 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:32:13.036540 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:32:13.040611 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:32:13.040728 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:32:13.040833 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:32:13.050637 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.050752 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:32:13.050843 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:32:13.056571 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 07:32:13.057525 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:32:13.057819 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:32:13.060821 (MainThread): Using postgres connection "master".
2022-10-06 07:32:13.060941 (MainThread): On master: BEGIN
2022-10-06 07:32:13.061045 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:32:13.071531 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.071655 (MainThread): Using postgres connection "master".
2022-10-06 07:32:13.071753 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:32:13.093867 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 07:32:13.094989 (MainThread): On master: ROLLBACK
2022-10-06 07:32:13.095264 (MainThread): Using postgres connection "master".
2022-10-06 07:32:13.095373 (MainThread): On master: BEGIN
2022-10-06 07:32:13.095686 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:32:13.095808 (MainThread): On master: COMMIT
2022-10-06 07:32:13.095911 (MainThread): Using postgres connection "master".
2022-10-06 07:32:13.096007 (MainThread): On master: COMMIT
2022-10-06 07:32:13.096213 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:32:13.096335 (MainThread): On master: Close
2022-10-06 07:32:13.096568 (MainThread): 08:32:13 | Concurrency: 5 threads (target='dev')
2022-10-06 07:32:13.096703 (MainThread): 08:32:13 | 
2022-10-06 07:32:13.098909 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:32:13.099086 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:32:13.099243 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:32:13.099447 (Thread-1): 08:32:13 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:32:13.099636 (Thread-2): 08:32:13 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:32:13.099824 (Thread-3): 08:32:13 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:32:13.100119 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:13.100977 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:13.101230 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:13.101400 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:32:13.101541 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:32:13.101659 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:32:13.102723 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:32:13.104809 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:32:13.105847 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:32:13.106649 (Thread-2): finished collecting timing info
2022-10-06 07:32:13.124832 (Thread-3): finished collecting timing info
2022-10-06 07:32:13.125307 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:32:13.131692 (Thread-1): finished collecting timing info
2022-10-06 07:32:13.137383 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:32:13.138912 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:32:13.139443 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:13.139575 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:13.139659 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:32:13.139789 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:32:13.139917 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:32:13.140010 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:13.140095 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:32:13.140276 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:32:13.140463 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:32:13.152075 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.152253 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.152403 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:13.152508 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:13.152603 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.152694 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:32:13.152787 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:32:13.152901 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:13.153039 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:32:13.154848 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:32:13.158999 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:13.159115 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:32:13.159205 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:32:13.159286 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:32:13.160633 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:13.161899 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:13.162008 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:32:13.162104 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:32:13.162194 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:32:13.163429 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:13.163600 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:32:13.164129 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:32:13.164229 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:32:13.165439 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:13.165539 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:32:13.166731 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:13.166833 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:32:13.173520 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:32:13.173700 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:32:13.173852 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:13.173936 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:32:13.174493 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:32:13.174597 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:32:13.175256 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:32:13.175353 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:32:13.176013 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:32:13.176115 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:13.179657 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:32:13.179764 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:13.179851 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:32:13.179932 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:32:13.180014 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:32:13.180555 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:32:13.181383 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:32:13.181494 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:32:13.181575 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:32:13.182364 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:32:13.182499 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:32:13.182731 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 07:32:13.183382 (Thread-2): finished collecting timing info
2022-10-06 07:32:13.183493 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:32:13.183730 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22094115-b440-4acb-8249-bb3b48e2183c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95103a38b0>]}
2022-10-06 07:32:13.183942 (Thread-2): 08:32:13 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 07:32:13.184050 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:32:13.184294 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:32:13.184466 (Thread-5): 08:32:13 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:32:13.184676 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:32:13.184782 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:32:13.186088 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:32:13.186196 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:32:13.186316 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:32:13.186963 (Thread-1): finished collecting timing info
2022-10-06 07:32:13.187557 (Thread-3): finished collecting timing info
2022-10-06 07:32:13.187739 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:32:13.187832 (Thread-5): finished collecting timing info
2022-10-06 07:32:13.187934 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:32:13.189271 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:32:13.189462 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22094115-b440-4acb-8249-bb3b48e2183c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9510435220>]}
2022-10-06 07:32:13.189735 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22094115-b440-4acb-8249-bb3b48e2183c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9510441910>]}
2022-10-06 07:32:13.189998 (Thread-1): 08:32:13 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.09s]
2022-10-06 07:32:13.190116 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:32:13.190312 (Thread-3): 08:32:13 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 07:32:13.190428 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:32:13.190527 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:32:13.190667 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:32:13.190845 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:32:13.191108 (Thread-2): Began running node model.my_new_project.referencing
2022-10-06 07:32:13.191264 (Thread-2): 08:32:13 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:32:13.191455 (Thread-2): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:32:13.191550 (Thread-2): Compiling model.my_new_project.referencing
2022-10-06 07:32:13.193444 (Thread-2): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:32:13.193910 (Thread-2): finished collecting timing info
2022-10-06 07:32:13.195195 (Thread-2): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:32:13.195438 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:32:13.195527 (Thread-2): On model.my_new_project.referencing: BEGIN
2022-10-06 07:32:13.195615 (Thread-2): Opening a new connection, currently in state closed
2022-10-06 07:32:13.198187 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.198294 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:32:13.198382 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:32:13.200012 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:32:13.201451 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:32:13.201576 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:32:13.202146 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:32:13.202921 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:32:13.203076 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:32:13.203162 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:32:13.203333 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.203455 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:32:13.203542 (Thread-2): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select * except (c.order_id) from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 07:32:13.203691 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:32:13.204842 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:32:13.204955 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:32:13.205065 (Thread-2): Postgres error: syntax error at or near "c"
LINE 16: select * except (c.order_id) from customers c join orders o ...
                          ^

2022-10-06 07:32:13.205174 (Thread-2): On model.my_new_project.referencing: ROLLBACK
2022-10-06 07:32:13.205302 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:32:13.205599 (Thread-2): finished collecting timing info
2022-10-06 07:32:13.206285 (Thread-5): finished collecting timing info
2022-10-06 07:32:13.206411 (Thread-2): On model.my_new_project.referencing: Close
2022-10-06 07:32:13.206525 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:32:13.207076 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22094115-b440-4acb-8249-bb3b48e2183c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95181056a0>]}
2022-10-06 07:32:13.207310 (Thread-5): 08:32:13 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 07:32:13.207440 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:32:13.206767 (Thread-2): Database Error in model referencing (models/referencing.sql)
  syntax error at or near "c"
  LINE 16: select * except (c.order_id) from customers c join orders o ...
                            ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "c"
LINE 16: select * except (c.order_id) from customers c join orders o ...
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  syntax error at or near "c"
  LINE 16: select * except (c.order_id) from customers c join orders o ...
                            ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:32:13.210458 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22094115-b440-4acb-8249-bb3b48e2183c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95180e8250>]}
2022-10-06 07:32:13.210658 (Thread-2): 08:32:13 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.02s]
2022-10-06 07:32:13.210764 (Thread-2): Finished running node model.my_new_project.referencing
2022-10-06 07:32:13.211481 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:32:13.211600 (MainThread): Using postgres connection "master".
2022-10-06 07:32:13.211679 (MainThread): On master: BEGIN
2022-10-06 07:32:13.211760 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:32:13.219241 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:32:13.219441 (MainThread): On master: COMMIT
2022-10-06 07:32:13.219537 (MainThread): Using postgres connection "master".
2022-10-06 07:32:13.219621 (MainThread): On master: COMMIT
2022-10-06 07:32:13.219787 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:32:13.219889 (MainThread): On master: Close
2022-10-06 07:32:13.220241 (MainThread): 08:32:13 | 
2022-10-06 07:32:13.220374 (MainThread): 08:32:13 | Finished running 1 table model, 4 view models in 0.26s.
2022-10-06 07:32:13.220482 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:32:13.220564 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 07:32:13.220642 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:32:13.220719 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 07:32:13.220794 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:32:13.223724 (MainThread): 
2022-10-06 07:32:13.223843 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 07:32:13.223941 (MainThread): 
2022-10-06 07:32:13.224035 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 07:32:13.224125 (MainThread):   syntax error at or near "c"
2022-10-06 07:32:13.224208 (MainThread):   LINE 16: select * except (c.order_id) from customers c join orders o ...
2022-10-06 07:32:13.224291 (MainThread):                             ^
2022-10-06 07:32:13.224372 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:32:13.224465 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 07:32:13.224610 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9510453df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9510435220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f951045bc70>]}
2022-10-06 07:32:13.224759 (MainThread): Flushing usage events
2022-10-06 07:47:48.924447 (MainThread): Running with dbt=0.21.1
2022-10-06 07:47:48.996842 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:47:48.999192 (MainThread): Tracking: tracking
2022-10-06 07:47:49.031371 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5a53ec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5a4c67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5a5342b0>]}
2022-10-06 07:47:49.042483 (MainThread): Partial parsing not enabled
2022-10-06 07:47:49.053415 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:47:49.056086 (MainThread): Parsing macros/relations.sql
2022-10-06 07:47:49.057095 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:47:49.073352 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:47:49.074536 (MainThread): Parsing macros/core.sql
2022-10-06 07:47:49.077085 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:47:49.082017 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:47:49.089004 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:47:49.090164 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:47:49.102216 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:47:49.127716 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:47:49.144436 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:47:49.145668 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:47:49.153036 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:47:49.167868 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:47:49.177956 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:47:49.183699 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:47:49.189008 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:47:49.191621 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:47:49.192599 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:47:49.193225 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:47:49.194243 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:47:49.200339 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:47:49.201548 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:47:49.203159 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:47:49.204201 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:47:49.244125 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:47:49.245262 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:47:49.246040 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:47:49.246930 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:47:49.362788 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.371743 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.373619 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:47:49.376296 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.378566 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:49.396661 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:49.397786 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:49.398888 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:49.400058 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:49.410033 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24a745b7-9870-4d92-af7f-41f1dfa5477b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f48a72a90>]}
2022-10-06 07:47:49.413336 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:47:49.413923 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24a745b7-9870-4d92-af7f-41f1dfa5477b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f6813e100>]}
2022-10-06 07:47:49.414104 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:47:49.415100 (MainThread): 
2022-10-06 07:47:49.415325 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:47:49.416084 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:47:49.422909 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:47:49.423074 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:47:49.423179 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:47:49.481451 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 07:47:49.483297 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:47:49.484201 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:47:49.488476 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:47:49.488606 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:47:49.488707 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:47:49.497790 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.497919 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:47:49.498018 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:47:49.503615 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 07:47:49.504598 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:47:49.504890 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:47:49.508033 (MainThread): Using postgres connection "master".
2022-10-06 07:47:49.508156 (MainThread): On master: BEGIN
2022-10-06 07:47:49.508260 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:47:49.517780 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.517905 (MainThread): Using postgres connection "master".
2022-10-06 07:47:49.517998 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:47:49.540031 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 07:47:49.541172 (MainThread): On master: ROLLBACK
2022-10-06 07:47:49.541438 (MainThread): Using postgres connection "master".
2022-10-06 07:47:49.541552 (MainThread): On master: BEGIN
2022-10-06 07:47:49.541881 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:47:49.542015 (MainThread): On master: COMMIT
2022-10-06 07:47:49.542122 (MainThread): Using postgres connection "master".
2022-10-06 07:47:49.542217 (MainThread): On master: COMMIT
2022-10-06 07:47:49.542419 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:47:49.542538 (MainThread): On master: Close
2022-10-06 07:47:49.542791 (MainThread): 08:47:49 | Concurrency: 5 threads (target='dev')
2022-10-06 07:47:49.542927 (MainThread): 08:47:49 | 
2022-10-06 07:47:49.545242 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:47:49.545420 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:47:49.545618 (Thread-1): 08:47:49 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:47:49.545730 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:47:49.545913 (Thread-2): 08:47:49 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:47:49.546209 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.546403 (Thread-3): 08:47:49 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:47:49.546614 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:47:49.547378 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.547661 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.548647 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:47:49.548793 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:47:49.548921 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:47:49.550645 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:47:49.551634 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:47:49.551977 (Thread-1): finished collecting timing info
2022-10-06 07:47:49.558316 (Thread-2): finished collecting timing info
2022-10-06 07:47:49.569689 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:47:49.569960 (Thread-3): finished collecting timing info
2022-10-06 07:47:49.583006 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:47:49.584470 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:47:49.585107 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.585259 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.585360 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:47:49.585474 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.585572 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:47:49.585675 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:47:49.585760 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:47:49.585845 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:47:49.586059 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:47:49.598044 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.598176 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.598266 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.598355 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.598449 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.598538 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.598629 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:47:49.598734 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:47:49.598828 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:47:49.603180 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:47:49.607501 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.607624 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:47:49.607724 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:47:49.607807 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:47:49.609160 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.610475 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.610587 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:47:49.610681 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:47:49.610775 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:47:49.612007 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.612172 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:47:49.612667 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:47:49.612768 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:47:49.613988 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.615232 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.615321 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:47:49.615420 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:47:49.615510 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:47:49.622289 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:47:49.622415 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.622498 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:47:49.622823 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:47:49.623451 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:47:49.623547 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:47:49.623638 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.623710 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:47:49.624356 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:47:49.624452 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:47:49.627940 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:49.628045 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.628155 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:47:49.628244 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:47:49.628578 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:47:49.629401 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:49.629498 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:47:49.629579 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:47:49.630394 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:49.630521 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:47:49.637635 (Thread-1): SQL status: DROP VIEW in 0.01 seconds
2022-10-06 07:47:49.638386 (Thread-1): finished collecting timing info
2022-10-06 07:47:49.638520 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:47:49.638639 (Thread-3): SQL status: DROP VIEW in 0.01 seconds
2022-10-06 07:47:49.638920 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a745b7-9870-4d92-af7f-41f1dfa5477b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5a591eb0>]}
2022-10-06 07:47:49.639645 (Thread-3): finished collecting timing info
2022-10-06 07:47:49.639755 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2022-10-06 07:47:49.640089 (Thread-1): 08:47:49 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.09s]
2022-10-06 07:47:49.640281 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:47:49.641036 (Thread-2): finished collecting timing info
2022-10-06 07:47:49.641235 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:47:49.641382 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:47:49.641662 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a745b7-9870-4d92-af7f-41f1dfa5477b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f48af2070>]}
2022-10-06 07:47:49.642033 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a745b7-9870-4d92-af7f-41f1dfa5477b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5a5f8ac0>]}
2022-10-06 07:47:49.642267 (Thread-3): 08:47:49 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 07:47:49.642488 (Thread-2): 08:47:49 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.10s]
2022-10-06 07:47:49.642618 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:47:49.642743 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:47:49.643302 (Thread-5): Began running node model.my_new_project.referencing
2022-10-06 07:47:49.643531 (Thread-5): 08:47:49 | 4 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:47:49.643675 (Thread-1): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:47:49.643882 (Thread-1): 08:47:49 | 5 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:47:49.644107 (Thread-5): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:47:49.644325 (Thread-1): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:49.644434 (Thread-5): Compiling model.my_new_project.referencing
2022-10-06 07:47:49.644547 (Thread-1): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:47:49.646654 (Thread-5): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:47:49.648266 (Thread-1): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:47:49.648863 (Thread-1): finished collecting timing info
2022-10-06 07:47:49.650572 (Thread-1): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:47:49.650776 (Thread-5): finished collecting timing info
2022-10-06 07:47:49.652291 (Thread-5): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:47:49.652794 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:49.652931 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:47:49.653021 (Thread-1): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:47:49.653132 (Thread-5): On model.my_new_project.referencing: BEGIN
2022-10-06 07:47:49.653279 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:47:49.653383 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:47:49.662516 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.662744 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.662869 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:47:49.663094 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:49.663390 (Thread-5): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.emnail,o.order_name from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 07:47:49.663495 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:47:49.665521 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:47:49.667163 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:49.667338 (Thread-5): Postgres error: column c.emnail does not exist
LINE 16: select c.first_name,c.last_name,c.emnail,o.order_name from c...
                                         ^
HINT:  Perhaps you meant to reference the column "c.email".

2022-10-06 07:47:49.667442 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:47:49.667552 (Thread-5): On model.my_new_project.referencing: ROLLBACK
2022-10-06 07:47:49.668513 (Thread-5): finished collecting timing info
2022-10-06 07:47:49.668735 (Thread-5): On model.my_new_project.referencing: Close
2022-10-06 07:47:49.668859 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:47:49.669816 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:47:49.669982 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:49.670078 (Thread-1): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:47:49.670405 (Thread-5): Database Error in model referencing (models/referencing.sql)
  column c.emnail does not exist
  LINE 16: select c.first_name,c.last_name,c.emnail,o.order_name from c...
                                           ^
  HINT:  Perhaps you meant to reference the column "c.email".
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedColumn: column c.emnail does not exist
LINE 16: select c.first_name,c.last_name,c.emnail,o.order_name from c...
                                         ^
HINT:  Perhaps you meant to reference the column "c.email".


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  column c.emnail does not exist
  LINE 16: select c.first_name,c.last_name,c.emnail,o.order_name from c...
                                           ^
  HINT:  Perhaps you meant to reference the column "c.email".
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:47:49.674310 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a745b7-9870-4d92-af7f-41f1dfa5477b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f48af8ee0>]}
2022-10-06 07:47:49.674619 (Thread-5): 08:47:49 | 4 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.03s]
2022-10-06 07:47:49.674756 (Thread-5): Finished running node model.my_new_project.referencing
2022-10-06 07:47:49.679571 (Thread-1): SQL status: COMMIT in 0.01 seconds
2022-10-06 07:47:49.680530 (Thread-1): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:49.680628 (Thread-1): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:47:49.680963 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:47:49.681731 (Thread-1): finished collecting timing info
2022-10-06 07:47:49.681866 (Thread-1): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:47:49.682130 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24a745b7-9870-4d92-af7f-41f1dfa5477b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5a5a11c0>]}
2022-10-06 07:47:49.682364 (Thread-1): 08:47:49 | 5 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.04s]
2022-10-06 07:47:49.682485 (Thread-1): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:47:49.683349 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:47:49.683491 (MainThread): Using postgres connection "master".
2022-10-06 07:47:49.683582 (MainThread): On master: BEGIN
2022-10-06 07:47:49.683676 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:47:49.691844 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:49.692045 (MainThread): On master: COMMIT
2022-10-06 07:47:49.692133 (MainThread): Using postgres connection "master".
2022-10-06 07:47:49.692216 (MainThread): On master: COMMIT
2022-10-06 07:47:49.692393 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:47:49.692500 (MainThread): On master: Close
2022-10-06 07:47:49.692749 (MainThread): 08:47:49 | 
2022-10-06 07:47:49.692858 (MainThread): 08:47:49 | Finished running 4 view models, 1 table model in 0.28s.
2022-10-06 07:47:49.692957 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:47:49.693036 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:47:49.693115 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 07:47:49.693192 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 07:47:49.693267 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:47:49.696478 (MainThread): 
2022-10-06 07:47:49.696605 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 07:47:49.696706 (MainThread): 
2022-10-06 07:47:49.696807 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 07:47:49.696896 (MainThread):   column c.emnail does not exist
2022-10-06 07:47:49.696979 (MainThread):   LINE 16: select c.first_name,c.last_name,c.emnail,o.order_name from c...
2022-10-06 07:47:49.697062 (MainThread):                                            ^
2022-10-06 07:47:49.697143 (MainThread):   HINT:  Perhaps you meant to reference the column "c.email".
2022-10-06 07:47:49.697224 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:47:49.697316 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 07:47:49.697474 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f48a2bc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f48af2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f5a541220>]}
2022-10-06 07:47:49.697629 (MainThread): Flushing usage events
2022-10-06 07:47:59.498305 (MainThread): Running with dbt=0.21.1
2022-10-06 07:47:59.554882 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:47:59.556403 (MainThread): Tracking: tracking
2022-10-06 07:47:59.580968 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd39208fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd392085b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd392085970>]}
2022-10-06 07:47:59.589547 (MainThread): Partial parsing not enabled
2022-10-06 07:47:59.598172 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:47:59.600722 (MainThread): Parsing macros/relations.sql
2022-10-06 07:47:59.601741 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:47:59.617572 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:47:59.618686 (MainThread): Parsing macros/core.sql
2022-10-06 07:47:59.621142 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:47:59.625703 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:47:59.632345 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:47:59.633440 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:47:59.645307 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:47:59.670252 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:47:59.686272 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:47:59.687419 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:47:59.694490 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:47:59.708789 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:47:59.718635 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:47:59.724168 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:47:59.729315 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:47:59.731883 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:47:59.732850 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:47:59.733478 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:47:59.734468 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:47:59.740290 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:47:59.741458 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:47:59.743035 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:47:59.744049 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:47:59.782994 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:47:59.784096 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:47:59.784840 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:47:59.785687 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:47:59.898032 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:47:59.905713 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:47:59.907591 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:47:59.910226 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:47:59.912517 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:47:59.930660 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:59.931804 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:59.932896 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:59.934084 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:47:59.943000 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1e9d1d8-915e-4595-8f0f-2cfb874c7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd370402dc0>]}
2022-10-06 07:47:59.946356 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:47:59.946997 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1e9d1d8-915e-4595-8f0f-2cfb874c7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37037fcd0>]}
2022-10-06 07:47:59.947189 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:47:59.948199 (MainThread): 
2022-10-06 07:47:59.948439 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:47:59.949200 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:47:59.955321 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:47:59.955426 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:47:59.955519 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:47:59.968529 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.01 seconds
2022-10-06 07:47:59.970171 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:47:59.971005 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:47:59.974601 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:47:59.974713 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:47:59.974802 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:47:59.983343 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:47:59.983525 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:47:59.983615 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:47:59.987760 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.00 seconds
2022-10-06 07:47:59.988652 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:47:59.988939 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:47:59.991650 (MainThread): Using postgres connection "master".
2022-10-06 07:47:59.991759 (MainThread): On master: BEGIN
2022-10-06 07:47:59.991847 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:47:59.999917 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:48:00.000163 (MainThread): Using postgres connection "master".
2022-10-06 07:48:00.000265 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:48:00.022381 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 07:48:00.023463 (MainThread): On master: ROLLBACK
2022-10-06 07:48:00.023726 (MainThread): Using postgres connection "master".
2022-10-06 07:48:00.023817 (MainThread): On master: BEGIN
2022-10-06 07:48:00.024130 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:48:00.024241 (MainThread): On master: COMMIT
2022-10-06 07:48:00.024325 (MainThread): Using postgres connection "master".
2022-10-06 07:48:00.024401 (MainThread): On master: COMMIT
2022-10-06 07:48:00.024581 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:48:00.024678 (MainThread): On master: Close
2022-10-06 07:48:00.024887 (MainThread): 08:48:00 | Concurrency: 5 threads (target='dev')
2022-10-06 07:48:00.025009 (MainThread): 08:48:00 | 
2022-10-06 07:48:00.027058 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:48:00.027227 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:48:00.027434 (Thread-1): 08:48:00 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:48:00.027543 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:48:00.027719 (Thread-2): 08:48:00 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:48:00.027999 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:48:00.028159 (Thread-3): 08:48:00 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:48:00.028986 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:48:00.029145 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:48:00.029392 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:48:00.029520 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:48:00.030503 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:48:00.030640 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:48:00.032903 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:48:00.034198 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:48:00.034807 (Thread-1): finished collecting timing info
2022-10-06 07:48:00.041244 (Thread-3): finished collecting timing info
2022-10-06 07:48:00.041372 (Thread-2): finished collecting timing info
2022-10-06 07:48:00.051580 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:48:00.053439 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:48:00.065519 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:48:00.066061 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:48:00.066173 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:48:00.066270 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:48:00.066489 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:48:00.066624 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:48:00.066746 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:48:00.066852 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:48:00.066948 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:48:00.067035 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:48:00.074894 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:48:00.075046 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:48:00.075167 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:48:00.075268 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:48:00.075362 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:48:00.075453 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:48:00.076573 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:48:00.076659 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:48:00.076732 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:48:00.078979 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:48:00.082986 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:48:00.083165 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:48:00.083263 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:48:00.083344 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:48:00.085069 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:48:00.086369 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:48:00.086480 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:48:00.086562 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:48:00.086715 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:48:00.087896 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:48:00.088022 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:48:00.088104 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:48:00.089283 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:48:00.089387 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:48:00.089500 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:48:00.090674 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:48:00.090777 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:48:00.090884 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:48:00.097285 (Thread-1): SQL status: ALTER TABLE in 0.01 seconds
2022-10-06 07:48:00.097506 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:48:00.098219 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:48:00.098326 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:48:00.098428 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:48:00.098520 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:48:00.099166 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:48:00.099263 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:48:00.099347 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:48:00.099431 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:48:00.099562 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:48:00.099997 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:48:00.103620 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:48:00.103725 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:48:00.103835 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:48:00.104639 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:48:00.104726 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:48:00.104824 (Thread-3): SQL status: COMMIT in 0.01 seconds
2022-10-06 07:48:00.105578 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:48:00.105666 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:48:00.105766 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:48:00.106406 (Thread-1): finished collecting timing info
2022-10-06 07:48:00.106520 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:48:00.106762 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e9d1d8-915e-4595-8f0f-2cfb874c7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3921456a0>]}
2022-10-06 07:48:00.106977 (Thread-1): 08:48:00 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 07:48:00.107084 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:48:00.107297 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:48:00.107896 (Thread-3): finished collecting timing info
2022-10-06 07:48:00.108002 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:48:00.108112 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 07:48:00.108702 (Thread-2): finished collecting timing info
2022-10-06 07:48:00.108815 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:48:00.109031 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e9d1d8-915e-4595-8f0f-2cfb874c7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd370477f10>]}
2022-10-06 07:48:00.109217 (Thread-2): 08:48:00 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 07:48:00.109316 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:48:00.109521 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e9d1d8-915e-4595-8f0f-2cfb874c7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3921452b0>]}
2022-10-06 07:48:00.109689 (Thread-3): 08:48:00 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.08s]
2022-10-06 07:48:00.109784 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:48:00.110186 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:48:00.110359 (Thread-5): 08:48:00 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:48:00.110563 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:48:00.110665 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:48:00.111967 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:48:00.112116 (Thread-4): Began running node model.my_new_project.referencing
2022-10-06 07:48:00.112262 (Thread-4): 08:48:00 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:48:00.112447 (Thread-4): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:48:00.112608 (Thread-4): Compiling model.my_new_project.referencing
2022-10-06 07:48:00.114413 (Thread-4): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:48:00.114822 (Thread-5): finished collecting timing info
2022-10-06 07:48:00.116159 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:48:00.116297 (Thread-4): finished collecting timing info
2022-10-06 07:48:00.117734 (Thread-4): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:48:00.118058 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:48:00.118155 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:48:00.118269 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:48:00.118372 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:48:00.118463 (Thread-4): On model.my_new_project.referencing: BEGIN
2022-10-06 07:48:00.118667 (Thread-4): Opening a new connection, currently in state init
2022-10-06 07:48:00.126572 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:48:00.126703 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:48:00.126811 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:48:00.126902 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:48:00.126987 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:48:00.127073 (Thread-4): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.email,o.order_name from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 07:48:00.129655 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:48:00.131057 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:48:00.131158 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:48:00.131760 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:48:00.132462 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:48:00.132557 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:48:00.132638 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:48:00.133236 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:48:00.134284 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:48:00.134432 (Thread-4): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:48:00.134536 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:48:00.135930 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:48:00.136077 (Thread-4): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 07:48:00.139871 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:48:00.140515 (Thread-5): finished collecting timing info
2022-10-06 07:48:00.140630 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:48:00.140727 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:48:00.141355 (Thread-4): On model.my_new_project.referencing: COMMIT
2022-10-06 07:48:00.141447 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:48:00.141685 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e9d1d8-915e-4595-8f0f-2cfb874c7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3920fb910>]}
2022-10-06 07:48:00.141774 (Thread-4): On model.my_new_project.referencing: COMMIT
2022-10-06 07:48:00.142263 (Thread-5): 08:48:00 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 07:48:00.142388 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:48:00.142530 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:48:00.143585 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:48:00.143759 (Thread-4): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */
drop view if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 07:48:00.144028 (Thread-4): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:48:00.144719 (Thread-4): finished collecting timing info
2022-10-06 07:48:00.144836 (Thread-4): On model.my_new_project.referencing: Close
2022-10-06 07:48:00.145055 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1e9d1d8-915e-4595-8f0f-2cfb874c7902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3703a8340>]}
2022-10-06 07:48:00.145248 (Thread-4): 08:48:00 | 5 of 5 OK created view model public.referencing...................... [CREATE VIEW in 0.03s]
2022-10-06 07:48:00.145347 (Thread-4): Finished running node model.my_new_project.referencing
2022-10-06 07:48:00.146022 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:48:00.146142 (MainThread): Using postgres connection "master".
2022-10-06 07:48:00.146223 (MainThread): On master: BEGIN
2022-10-06 07:48:00.146304 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:48:00.154487 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:48:00.154674 (MainThread): On master: COMMIT
2022-10-06 07:48:00.154761 (MainThread): Using postgres connection "master".
2022-10-06 07:48:00.154840 (MainThread): On master: COMMIT
2022-10-06 07:48:00.155012 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:48:00.155117 (MainThread): On master: Close
2022-10-06 07:48:00.155364 (MainThread): 08:48:00 | 
2022-10-06 07:48:00.155474 (MainThread): 08:48:00 | Finished running 4 view models, 1 table model in 0.21s.
2022-10-06 07:48:00.155571 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:48:00.155651 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 07:48:00.155728 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 07:48:00.155803 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 07:48:00.155876 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:48:00.155955 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:48:00.159115 (MainThread): 
2022-10-06 07:48:00.159236 (MainThread): Completed successfully
2022-10-06 07:48:00.159340 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-10-06 07:48:00.159487 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd37037fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3704363a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd370436d30>]}
2022-10-06 07:48:00.159641 (MainThread): Flushing usage events
2022-10-06 07:52:47.968425 (MainThread): Running with dbt=0.21.1
2022-10-06 07:52:48.038530 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 07:52:48.041662 (MainThread): Tracking: tracking
2022-10-06 07:52:48.066093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96babdfeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96babdc490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96babdc460>]}
2022-10-06 07:52:48.074773 (MainThread): Partial parsing not enabled
2022-10-06 07:52:48.084429 (MainThread): Parsing macros/catalog.sql
2022-10-06 07:52:48.087077 (MainThread): Parsing macros/relations.sql
2022-10-06 07:52:48.088065 (MainThread): Parsing macros/adapters.sql
2022-10-06 07:52:48.103860 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 07:52:48.104975 (MainThread): Parsing macros/core.sql
2022-10-06 07:52:48.107447 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 07:52:48.112057 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 07:52:48.118746 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 07:52:48.119845 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 07:52:48.131449 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 07:52:48.156340 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 07:52:48.172437 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 07:52:48.173581 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 07:52:48.180693 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 07:52:48.195127 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 07:52:48.205065 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 07:52:48.210643 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 07:52:48.215834 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 07:52:48.218382 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 07:52:48.219333 (MainThread): Parsing macros/etc/query.sql
2022-10-06 07:52:48.219939 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 07:52:48.220929 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 07:52:48.226790 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 07:52:48.227962 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 07:52:48.229545 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 07:52:48.230571 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 07:52:48.270073 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 07:52:48.271155 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 07:52:48.271899 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 07:52:48.272749 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 07:52:48.384237 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.391887 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.393744 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:52:48.396372 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.398640 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:52:48.416721 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:52:48.417834 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:52:48.418900 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:52:48.420080 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 07:52:48.430479 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf6a9dfb-191d-46b2-8ad4-f62953909872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a81bd8b0>]}
2022-10-06 07:52:48.433633 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 07:52:48.433935 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf6a9dfb-191d-46b2-8ad4-f62953909872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a8165f70>]}
2022-10-06 07:52:48.434090 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 07:52:48.435013 (MainThread): 
2022-10-06 07:52:48.435225 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:52:48.435918 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 07:52:48.442639 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 07:52:48.442818 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 07:52:48.442913 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 07:52:48.495561 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.05 seconds
2022-10-06 07:52:48.497359 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 07:52:48.498244 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 07:52:48.502542 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:52:48.502660 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 07:52:48.502761 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 07:52:48.511294 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.511448 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 07:52:48.511554 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 07:52:48.517026 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2022-10-06 07:52:48.518096 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 07:52:48.518400 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 07:52:48.521616 (MainThread): Using postgres connection "master".
2022-10-06 07:52:48.521738 (MainThread): On master: BEGIN
2022-10-06 07:52:48.521843 (MainThread): Opening a new connection, currently in state init
2022-10-06 07:52:48.531385 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.531506 (MainThread): Using postgres connection "master".
2022-10-06 07:52:48.531601 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 07:52:48.556766 (MainThread): SQL status: SELECT 5 in 0.03 seconds
2022-10-06 07:52:48.558077 (MainThread): On master: ROLLBACK
2022-10-06 07:52:48.558341 (MainThread): Using postgres connection "master".
2022-10-06 07:52:48.558464 (MainThread): On master: BEGIN
2022-10-06 07:52:48.558784 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 07:52:48.558921 (MainThread): On master: COMMIT
2022-10-06 07:52:48.559036 (MainThread): Using postgres connection "master".
2022-10-06 07:52:48.559139 (MainThread): On master: COMMIT
2022-10-06 07:52:48.559344 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:52:48.559473 (MainThread): On master: Close
2022-10-06 07:52:48.559724 (MainThread): 08:52:48 | Concurrency: 5 threads (target='dev')
2022-10-06 07:52:48.559871 (MainThread): 08:52:48 | 
2022-10-06 07:52:48.562184 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 07:52:48.562364 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 07:52:48.562501 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 07:52:48.562702 (Thread-1): 08:52:48 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 07:52:48.562878 (Thread-2): 08:52:48 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 07:52:48.563063 (Thread-3): 08:52:48 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 07:52:48.563364 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.564180 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.564414 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.564550 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 07:52:48.564684 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 07:52:48.564798 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 07:52:48.565776 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:52:48.567580 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:52:48.568544 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:52:48.569291 (Thread-2): finished collecting timing info
2022-10-06 07:52:48.587951 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 07:52:48.588190 (Thread-3): finished collecting timing info
2022-10-06 07:52:48.588368 (Thread-1): finished collecting timing info
2022-10-06 07:52:48.599950 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 07:52:48.601396 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 07:52:48.601627 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.601772 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 07:52:48.601918 (Thread-2): Opening a new connection, currently in state init
2022-10-06 07:52:48.602137 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.602253 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.602349 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 07:52:48.602453 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 07:52:48.602618 (Thread-3): Opening a new connection, currently in state init
2022-10-06 07:52:48.602709 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 07:52:48.613254 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.613400 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.613522 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.613613 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 07:52:48.613721 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.613813 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.613938 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 07:52:48.614044 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.614149 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 07:52:48.617585 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 07:52:48.621948 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.622081 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:52:48.622178 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 07:52:48.622260 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 07:52:48.623747 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.625143 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.625266 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:52:48.625358 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 07:52:48.625507 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 07:52:48.626682 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.626846 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 07:52:48.627351 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:52:48.627448 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:52:48.628689 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.629934 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.630024 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:52:48.630120 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 07:52:48.630208 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 07:52:48.636972 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:52:48.637094 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:52:48.637197 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.637849 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:52:48.637953 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:52:48.638049 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 07:52:48.638145 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.638813 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:52:48.638938 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 07:52:48.639032 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.639141 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 07:52:48.639438 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:52:48.643055 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 07:52:48.643159 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:52:48.643241 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 07:52:48.643313 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:52:48.644159 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 07:52:48.645005 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 07:52:48.645103 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 07:52:48.645189 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 07:52:48.647319 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 07:52:48.647975 (Thread-2): finished collecting timing info
2022-10-06 07:52:48.648081 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:52:48.648176 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 07:52:48.648777 (Thread-1): finished collecting timing info
2022-10-06 07:52:48.648922 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 07:52:48.649026 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:52:48.649258 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6a9dfb-191d-46b2-8ad4-f62953909872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a82d6490>]}
2022-10-06 07:52:48.649854 (Thread-3): finished collecting timing info
2022-10-06 07:52:48.650042 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6a9dfb-191d-46b2-8ad4-f62953909872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96983df640>]}
2022-10-06 07:52:48.650267 (Thread-2): 08:52:48 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-06 07:52:48.650368 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 07:52:48.650514 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 07:52:48.650712 (Thread-1): 08:52:48 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.09s]
2022-10-06 07:52:48.650927 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6a9dfb-191d-46b2-8ad4-f62953909872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f969831f8e0>]}
2022-10-06 07:52:48.651148 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 07:52:48.651418 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 07:52:48.651571 (Thread-5): 08:52:48 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 07:52:48.651760 (Thread-3): 08:52:48 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 07:52:48.651974 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:52:48.652115 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 07:52:48.652221 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 07:52:48.653632 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:52:48.653888 (Thread-2): Began running node model.my_new_project.referencing
2022-10-06 07:52:48.654154 (Thread-2): 08:52:48 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 07:52:48.654384 (Thread-2): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 07:52:48.654498 (Thread-2): Compiling model.my_new_project.referencing
2022-10-06 07:52:48.656670 (Thread-2): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 07:52:48.657042 (Thread-5): finished collecting timing info
2022-10-06 07:52:48.658894 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 07:52:48.659063 (Thread-2): finished collecting timing info
2022-10-06 07:52:48.660315 (Thread-2): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 07:52:48.660546 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:52:48.660637 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 07:52:48.660747 (Thread-5): Opening a new connection, currently in state init
2022-10-06 07:52:48.660943 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:52:48.661033 (Thread-2): On model.my_new_project.referencing: BEGIN
2022-10-06 07:52:48.661115 (Thread-2): Opening a new connection, currently in state closed
2022-10-06 07:52:48.668226 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.668364 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.668459 (Thread-2): Using postgres connection "model.my_new_project.referencing".
2022-10-06 07:52:48.668554 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:52:48.668644 (Thread-2): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select * from customers c join orders o on o.order_id=c.order_id
alter view referencing drop column customers.order_id
  );

2022-10-06 07:52:48.668735 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 07:52:48.669248 (Thread-2): Postgres error: syntax error at or near "alter"
LINE 17: alter view referencing drop column customers.order_id
         ^

2022-10-06 07:52:48.669363 (Thread-2): On model.my_new_project.referencing: ROLLBACK
2022-10-06 07:52:48.669765 (Thread-2): finished collecting timing info
2022-10-06 07:52:48.669914 (Thread-2): On model.my_new_project.referencing: Close
2022-10-06 07:52:48.670913 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 07:52:48.672684 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:52:48.672969 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 07:52:48.673513 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 07:52:48.674345 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:52:48.674445 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:52:48.674541 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 07:52:48.674891 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:52:48.675879 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 07:52:48.675973 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 07:52:48.676301 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 07:52:48.676975 (Thread-5): finished collecting timing info
2022-10-06 07:52:48.677094 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 07:52:48.677365 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6a9dfb-191d-46b2-8ad4-f62953909872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96983471f0>]}
2022-10-06 07:52:48.677593 (Thread-5): 08:52:48 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 07:52:48.677751 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 07:52:48.670210 (Thread-2): Database Error in model referencing (models/referencing.sql)
  syntax error at or near "alter"
  LINE 17: alter view referencing drop column customers.order_id
           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "alter"
LINE 17: alter view referencing drop column customers.order_id
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  syntax error at or near "alter"
  LINE 17: alter view referencing drop column customers.order_id
           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:52:48.679023 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf6a9dfb-191d-46b2-8ad4-f62953909872', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a81fea00>]}
2022-10-06 07:52:48.679220 (Thread-2): 08:52:48 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.02s]
2022-10-06 07:52:48.679326 (Thread-2): Finished running node model.my_new_project.referencing
2022-10-06 07:52:48.680035 (MainThread): Acquiring new postgres connection "master".
2022-10-06 07:52:48.680155 (MainThread): Using postgres connection "master".
2022-10-06 07:52:48.680235 (MainThread): On master: BEGIN
2022-10-06 07:52:48.680314 (MainThread): Opening a new connection, currently in state closed
2022-10-06 07:52:48.687775 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 07:52:48.687989 (MainThread): On master: COMMIT
2022-10-06 07:52:48.688076 (MainThread): Using postgres connection "master".
2022-10-06 07:52:48.688161 (MainThread): On master: COMMIT
2022-10-06 07:52:48.688322 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 07:52:48.688418 (MainThread): On master: Close
2022-10-06 07:52:48.688804 (MainThread): 08:52:48 | 
2022-10-06 07:52:48.688932 (MainThread): 08:52:48 | Finished running 1 table model, 4 view models in 0.25s.
2022-10-06 07:52:48.689034 (MainThread): Connection 'master' was properly closed.
2022-10-06 07:52:48.689114 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 07:52:48.689191 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 07:52:48.689267 (MainThread): Connection 'model.my_new_project.orders_cte' was properly closed.
2022-10-06 07:52:48.689341 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 07:52:48.692324 (MainThread): 
2022-10-06 07:52:48.692444 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 07:52:48.692545 (MainThread): 
2022-10-06 07:52:48.692640 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 07:52:48.692727 (MainThread):   syntax error at or near "alter"
2022-10-06 07:52:48.692810 (MainThread):   LINE 17: alter view referencing drop column customers.order_id
2022-10-06 07:52:48.692892 (MainThread):            ^
2022-10-06 07:52:48.692973 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 07:52:48.693069 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 07:52:48.693219 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a81bd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a82b6220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96a82b6820>]}
2022-10-06 07:52:48.693373 (MainThread): Flushing usage events
2022-10-06 08:37:56.901325 (MainThread): Running with dbt=0.21.1
2022-10-06 08:37:56.974471 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 08:37:56.975977 (MainThread): Tracking: tracking
2022-10-06 08:37:57.003946 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa802c9eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa802c9efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa802c9ec40>]}
2022-10-06 08:37:57.018017 (MainThread): Partial parsing not enabled
2022-10-06 08:37:57.027867 (MainThread): Parsing macros/catalog.sql
2022-10-06 08:37:57.030310 (MainThread): Parsing macros/relations.sql
2022-10-06 08:37:57.031313 (MainThread): Parsing macros/adapters.sql
2022-10-06 08:37:57.047077 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 08:37:57.048204 (MainThread): Parsing macros/core.sql
2022-10-06 08:37:57.050762 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 08:37:57.055368 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 08:37:57.061899 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 08:37:57.063013 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 08:37:57.074642 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 08:37:57.099636 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 08:37:57.115736 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 08:37:57.116883 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 08:37:57.123976 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 08:37:57.138635 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 08:37:57.148624 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 08:37:57.154207 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 08:37:57.159421 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 08:37:57.161967 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 08:37:57.162922 (MainThread): Parsing macros/etc/query.sql
2022-10-06 08:37:57.163526 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 08:37:57.164516 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 08:37:57.170403 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 08:37:57.171566 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 08:37:57.173142 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 08:37:57.174161 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 08:37:57.213627 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 08:37:57.214711 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 08:37:57.215453 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 08:37:57.216301 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 08:37:57.327120 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.334745 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.336594 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:37:57.339218 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.341471 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:37:57.359477 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:37:57.360577 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:37:57.361638 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:37:57.362804 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:37:57.373065 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7736ec7d-57ef-4539-a341-ee9568d6b1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa802c9e250>]}
2022-10-06 08:37:57.376361 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 08:37:57.376697 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7736ec7d-57ef-4539-a341-ee9568d6b1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e0094310>]}
2022-10-06 08:37:57.376854 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 08:37:57.377798 (MainThread): 
2022-10-06 08:37:57.378003 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:37:57.378735 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 08:37:57.385501 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 08:37:57.385669 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 08:37:57.385767 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 08:37:57.453369 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.07 seconds
2022-10-06 08:37:57.454823 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 08:37:57.455710 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 08:37:57.460003 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:37:57.460126 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 08:37:57.460233 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 08:37:57.469695 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.469815 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:37:57.469914 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 08:37:57.475517 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 08:37:57.476444 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 08:37:57.476732 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 08:37:57.479761 (MainThread): Using postgres connection "master".
2022-10-06 08:37:57.479880 (MainThread): On master: BEGIN
2022-10-06 08:37:57.479983 (MainThread): Opening a new connection, currently in state init
2022-10-06 08:37:57.489486 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.489605 (MainThread): Using postgres connection "master".
2022-10-06 08:37:57.489699 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 08:37:57.511780 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 08:37:57.512995 (MainThread): On master: ROLLBACK
2022-10-06 08:37:57.513275 (MainThread): Using postgres connection "master".
2022-10-06 08:37:57.513393 (MainThread): On master: BEGIN
2022-10-06 08:37:57.513722 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 08:37:57.513852 (MainThread): On master: COMMIT
2022-10-06 08:37:57.513965 (MainThread): Using postgres connection "master".
2022-10-06 08:37:57.514067 (MainThread): On master: COMMIT
2022-10-06 08:37:57.514273 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:37:57.514402 (MainThread): On master: Close
2022-10-06 08:37:57.514652 (MainThread): 09:37:57 | Concurrency: 5 threads (target='dev')
2022-10-06 08:37:57.514796 (MainThread): 09:37:57 | 
2022-10-06 08:37:57.517044 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 08:37:57.517227 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 08:37:57.517462 (Thread-1): 09:37:57 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 08:37:57.517579 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 08:37:57.517775 (Thread-2): 09:37:57 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 08:37:57.518058 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.518255 (Thread-3): 09:37:57 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 08:37:57.519086 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.519252 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 08:37:57.519555 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.519695 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 08:37:57.520766 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:37:57.520907 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 08:37:57.523070 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:37:57.524490 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:37:57.524884 (Thread-1): finished collecting timing info
2022-10-06 08:37:57.525042 (Thread-2): finished collecting timing info
2022-10-06 08:37:57.530817 (Thread-3): finished collecting timing info
2022-10-06 08:37:57.550218 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:37:57.551886 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:37:57.558758 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:37:57.559417 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.559543 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 08:37:57.559651 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 08:37:57.559875 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.559975 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 08:37:57.560066 (Thread-3): Opening a new connection, currently in state init
2022-10-06 08:37:57.560179 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.560502 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 08:37:57.560910 (Thread-2): Opening a new connection, currently in state init
2022-10-06 08:37:57.573072 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.573245 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.573332 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.573421 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.573505 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.573583 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.573665 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 08:37:57.573746 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 08:37:57.573831 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 08:37:57.581648 (Thread-2): SQL status: SELECT 2 in 0.01 seconds
2022-10-06 08:37:57.581770 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:37:57.586157 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.586265 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:37:57.587702 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.587819 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 08:37:57.589086 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.589205 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 08:37:57.589332 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 08:37:57.589822 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:37:57.591193 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.591305 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:37:57.591398 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 08:37:57.591479 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:37:57.592790 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.594134 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.594242 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 08:37:57.594327 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:37:57.594412 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 08:37:57.601165 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:37:57.601262 (Thread-3): SQL status: ALTER TABLE in 0.01 seconds
2022-10-06 08:37:57.601405 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.602115 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:37:57.602221 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:37:57.602303 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:37:57.602396 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.603082 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:37:57.603186 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:37:57.603265 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:37:57.603353 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.606916 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:37:57.607026 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:37:57.607110 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:37:57.607196 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 08:37:57.608013 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:37:57.608164 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 08:37:57.608548 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:37:57.609366 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:37:57.609461 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:37:57.609542 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 08:37:57.610198 (Thread-3): finished collecting timing info
2022-10-06 08:37:57.610341 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 08:37:57.610582 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7736ec7d-57ef-4539-a341-ee9568d6b1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa802d58670>]}
2022-10-06 08:37:57.610799 (Thread-3): 09:37:57 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.09s]
2022-10-06 08:37:57.610908 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 08:37:57.611280 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 08:37:57.611893 (Thread-2): finished collecting timing info
2022-10-06 08:37:57.612000 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:37:57.612097 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 08:37:57.612677 (Thread-1): finished collecting timing info
2022-10-06 08:37:57.612912 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7736ec7d-57ef-4539-a341-ee9568d6b1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7f031bb80>]}
2022-10-06 08:37:57.612998 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 08:37:57.613193 (Thread-2): 09:37:57 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.09s]
2022-10-06 08:37:57.613388 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7736ec7d-57ef-4539-a341-ee9568d6b1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e01c75b0>]}
2022-10-06 08:37:57.613487 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 08:37:57.613672 (Thread-1): 09:37:57 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.10s]
2022-10-06 08:37:57.613902 (Thread-5): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 08:37:57.614022 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 08:37:57.614225 (Thread-5): 09:37:57 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 08:37:57.614496 (Thread-5): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:37:57.614637 (Thread-5): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 08:37:57.615945 (Thread-5): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:37:57.616114 (Thread-3): Began running node model.my_new_project.referencing
2022-10-06 08:37:57.616258 (Thread-3): 09:37:57 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 08:37:57.616503 (Thread-3): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:37:57.616600 (Thread-3): Compiling model.my_new_project.referencing
2022-10-06 08:37:57.618386 (Thread-3): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 08:37:57.618488 (Thread-5): finished collecting timing info
2022-10-06 08:37:57.619767 (Thread-5): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:37:57.619968 (Thread-3): finished collecting timing info
2022-10-06 08:37:57.621187 (Thread-3): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 08:37:57.621329 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:37:57.621428 (Thread-5): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 08:37:57.621522 (Thread-5): Opening a new connection, currently in state init
2022-10-06 08:37:57.621733 (Thread-3): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:37:57.621819 (Thread-3): On model.my_new_project.referencing: BEGIN
2022-10-06 08:37:57.621904 (Thread-3): Opening a new connection, currently in state closed
2022-10-06 08:37:57.629921 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.630170 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.630315 (Thread-3): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:37:57.630437 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:37:57.630539 (Thread-3): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
alter table select * from customers c join orders o on o.order_id=c.order_id drop column c.order_id
  );

2022-10-06 08:37:57.630637 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 08:37:57.630924 (Thread-3): Postgres error: syntax error at or near "alter"
LINE 16: alter table select * from customers c join orders o on o.ord...
         ^

2022-10-06 08:37:57.631017 (Thread-3): On model.my_new_project.referencing: ROLLBACK
2022-10-06 08:37:57.631358 (Thread-3): finished collecting timing info
2022-10-06 08:37:57.631472 (Thread-3): On model.my_new_project.referencing: Close
2022-10-06 08:37:57.632260 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 08:37:57.633670 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:37:57.633773 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 08:37:57.634112 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:37:57.634801 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:37:57.634891 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:37:57.634991 (Thread-5): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:37:57.635298 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:37:57.636213 (Thread-5): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:37:57.636310 (Thread-5): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 08:37:57.636510 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:37:57.637138 (Thread-5): finished collecting timing info
2022-10-06 08:37:57.637249 (Thread-5): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 08:37:57.637509 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7736ec7d-57ef-4539-a341-ee9568d6b1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e01c75b0>]}
2022-10-06 08:37:57.637801 (Thread-5): 09:37:57 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 08:37:57.637925 (Thread-5): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 08:37:57.631714 (Thread-3): Database Error in model referencing (models/referencing.sql)
  syntax error at or near "alter"
  LINE 16: alter table select * from customers c join orders o on o.ord...
           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "alter"
LINE 16: alter table select * from customers c join orders o on o.ord...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  syntax error at or near "alter"
  LINE 16: alter table select * from customers c join orders o on o.ord...
           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 08:37:57.639725 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7736ec7d-57ef-4539-a341-ee9568d6b1cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e012f6a0>]}
2022-10-06 08:37:57.639936 (Thread-3): 09:37:57 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.02s]
2022-10-06 08:37:57.640046 (Thread-3): Finished running node model.my_new_project.referencing
2022-10-06 08:37:57.640827 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:37:57.640961 (MainThread): Using postgres connection "master".
2022-10-06 08:37:57.641043 (MainThread): On master: BEGIN
2022-10-06 08:37:57.641127 (MainThread): Opening a new connection, currently in state closed
2022-10-06 08:37:57.649018 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:37:57.649197 (MainThread): On master: COMMIT
2022-10-06 08:37:57.649278 (MainThread): Using postgres connection "master".
2022-10-06 08:37:57.649354 (MainThread): On master: COMMIT
2022-10-06 08:37:57.649498 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:37:57.649589 (MainThread): On master: Close
2022-10-06 08:37:57.649842 (MainThread): 09:37:57 | 
2022-10-06 08:37:57.649947 (MainThread): 09:37:57 | Finished running 4 view models, 1 table model in 0.27s.
2022-10-06 08:37:57.650041 (MainThread): Connection 'master' was properly closed.
2022-10-06 08:37:57.650121 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 08:37:57.650198 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 08:37:57.650272 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 08:37:57.650345 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 08:37:57.653168 (MainThread): 
2022-10-06 08:37:57.653289 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 08:37:57.653387 (MainThread): 
2022-10-06 08:37:57.653483 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 08:37:57.653568 (MainThread):   syntax error at or near "alter"
2022-10-06 08:37:57.653650 (MainThread):   LINE 16: alter table select * from customers c join orders o on o.ord...
2022-10-06 08:37:57.653729 (MainThread):            ^
2022-10-06 08:37:57.653808 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 08:37:57.653897 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 08:37:57.654040 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e00b1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e01739a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7e01a6100>]}
2022-10-06 08:37:57.654189 (MainThread): Flushing usage events
2022-10-06 08:38:15.804132 (MainThread): Running with dbt=0.21.1
2022-10-06 08:38:15.872336 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 08:38:15.873803 (MainThread): Tracking: tracking
2022-10-06 08:38:15.897246 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea7efdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea7f3b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea7ef190>]}
2022-10-06 08:38:15.906032 (MainThread): Partial parsing not enabled
2022-10-06 08:38:15.915204 (MainThread): Parsing macros/catalog.sql
2022-10-06 08:38:15.917829 (MainThread): Parsing macros/relations.sql
2022-10-06 08:38:15.918919 (MainThread): Parsing macros/adapters.sql
2022-10-06 08:38:15.935584 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 08:38:15.936742 (MainThread): Parsing macros/core.sql
2022-10-06 08:38:15.939356 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 08:38:15.944106 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 08:38:15.950893 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 08:38:15.952020 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 08:38:15.964051 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 08:38:15.991253 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 08:38:16.008167 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 08:38:16.009346 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 08:38:16.016778 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 08:38:16.032085 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 08:38:16.042496 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 08:38:16.048460 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 08:38:16.053970 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 08:38:16.056564 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 08:38:16.057548 (MainThread): Parsing macros/etc/query.sql
2022-10-06 08:38:16.058163 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 08:38:16.059182 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 08:38:16.065245 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 08:38:16.066448 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 08:38:16.068069 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 08:38:16.069106 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 08:38:16.110703 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 08:38:16.111808 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 08:38:16.112562 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 08:38:16.113431 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 08:38:16.225754 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.233429 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.235293 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:38:16.237943 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.240213 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:38:16.258295 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:38:16.259408 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:38:16.260480 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:38:16.261659 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:38:16.270593 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '975e57a9-1a38-4090-a4ed-30e77e423b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c830d160>]}
2022-10-06 08:38:16.273879 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 08:38:16.274240 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '975e57a9-1a38-4090-a4ed-30e77e423b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea7ef400>]}
2022-10-06 08:38:16.274406 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 08:38:16.275368 (MainThread): 
2022-10-06 08:38:16.275589 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:38:16.276360 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 08:38:16.283103 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 08:38:16.283271 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 08:38:16.283376 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 08:38:16.340465 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 08:38:16.341965 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 08:38:16.342854 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 08:38:16.347168 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:38:16.347295 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 08:38:16.347403 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 08:38:16.356758 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.356877 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:38:16.356969 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 08:38:16.362297 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 08:38:16.363267 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 08:38:16.363560 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 08:38:16.366550 (MainThread): Using postgres connection "master".
2022-10-06 08:38:16.366671 (MainThread): On master: BEGIN
2022-10-06 08:38:16.366777 (MainThread): Opening a new connection, currently in state init
2022-10-06 08:38:16.376155 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.376274 (MainThread): Using postgres connection "master".
2022-10-06 08:38:16.376372 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 08:38:16.398129 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 08:38:16.399272 (MainThread): On master: ROLLBACK
2022-10-06 08:38:16.399538 (MainThread): Using postgres connection "master".
2022-10-06 08:38:16.399651 (MainThread): On master: BEGIN
2022-10-06 08:38:16.399962 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 08:38:16.400081 (MainThread): On master: COMMIT
2022-10-06 08:38:16.400189 (MainThread): Using postgres connection "master".
2022-10-06 08:38:16.400286 (MainThread): On master: COMMIT
2022-10-06 08:38:16.400492 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:38:16.400614 (MainThread): On master: Close
2022-10-06 08:38:16.400845 (MainThread): 09:38:16 | Concurrency: 5 threads (target='dev')
2022-10-06 08:38:16.400976 (MainThread): 09:38:16 | 
2022-10-06 08:38:16.403257 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 08:38:16.403461 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 08:38:16.403593 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 08:38:16.403806 (Thread-1): 09:38:16 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 08:38:16.403985 (Thread-2): 09:38:16 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 08:38:16.404143 (Thread-3): 09:38:16 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 08:38:16.404483 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.405329 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.405659 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.405848 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 08:38:16.405988 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 08:38:16.406110 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 08:38:16.407135 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:38:16.409245 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:38:16.410486 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:38:16.411380 (Thread-1): finished collecting timing info
2022-10-06 08:38:16.411541 (Thread-2): finished collecting timing info
2022-10-06 08:38:16.411662 (Thread-3): finished collecting timing info
2022-10-06 08:38:16.434845 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:38:16.442838 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:38:16.443112 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:38:16.443749 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.443877 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 08:38:16.443984 (Thread-3): Opening a new connection, currently in state init
2022-10-06 08:38:16.444240 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.444377 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.444477 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 08:38:16.444583 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 08:38:16.444689 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 08:38:16.444794 (Thread-2): Opening a new connection, currently in state init
2022-10-06 08:38:16.451892 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.451999 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.452093 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.452177 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.452274 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.452361 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.452445 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 08:38:16.452531 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 08:38:16.452613 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 08:38:16.455728 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 08:38:16.460192 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.460419 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:38:16.460526 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 08:38:16.460610 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:38:16.462147 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.463464 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.463581 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 08:38:16.463668 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:38:16.463758 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 08:38:16.465029 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.465142 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:38:16.465263 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 08:38:16.466501 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.466609 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:38:16.466731 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 08:38:16.467939 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.468037 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:38:16.468154 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 08:38:16.474806 (Thread-3): SQL status: ALTER TABLE in 0.01 seconds
2022-10-06 08:38:16.475023 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:38:16.475769 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:38:16.475889 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.475979 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:38:16.476085 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.476170 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:38:16.476815 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:38:16.476914 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:38:16.477031 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.477136 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:38:16.477641 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:38:16.481216 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:38:16.481322 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 08:38:16.481432 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:38:16.482245 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:38:16.482334 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 08:38:16.482435 (Thread-3): SQL status: COMMIT in 0.01 seconds
2022-10-06 08:38:16.483192 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:38:16.483284 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 08:38:16.483854 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:38:16.484502 (Thread-1): finished collecting timing info
2022-10-06 08:38:16.484610 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 08:38:16.484707 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 08:38:16.485321 (Thread-2): finished collecting timing info
2022-10-06 08:38:16.485427 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:38:16.485559 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 08:38:16.485777 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975e57a9-1a38-4090-a4ed-30e77e423b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c84046a0>]}
2022-10-06 08:38:16.486348 (Thread-3): finished collecting timing info
2022-10-06 08:38:16.486563 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975e57a9-1a38-4090-a4ed-30e77e423b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c842d4c0>]}
2022-10-06 08:38:16.486790 (Thread-1): 09:38:16 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 08:38:16.486876 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 08:38:16.487049 (Thread-2): 09:38:16 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 08:38:16.487160 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 08:38:16.487377 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975e57a9-1a38-4090-a4ed-30e77e423b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c8451c40>]}
2022-10-06 08:38:16.487502 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 08:38:16.487881 (Thread-3): 09:38:16 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.08s]
2022-10-06 08:38:16.488030 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 08:38:16.488175 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 08:38:16.488344 (Thread-3): 09:38:16 | 4 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 08:38:16.488553 (Thread-3): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:38:16.488660 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 08:38:16.489963 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:38:16.490213 (Thread-4): Began running node model.my_new_project.referencing
2022-10-06 08:38:16.490376 (Thread-4): 09:38:16 | 5 of 5 START view model public.referencing........................... [RUN]
2022-10-06 08:38:16.490615 (Thread-4): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:38:16.490732 (Thread-4): Compiling model.my_new_project.referencing
2022-10-06 08:38:16.492770 (Thread-4): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 08:38:16.493044 (Thread-3): finished collecting timing info
2022-10-06 08:38:16.494476 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:38:16.494792 (Thread-4): finished collecting timing info
2022-10-06 08:38:16.494965 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:38:16.496722 (Thread-4): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 08:38:16.496859 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 08:38:16.497021 (Thread-3): Opening a new connection, currently in state closed
2022-10-06 08:38:16.497297 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:38:16.497392 (Thread-4): On model.my_new_project.referencing: BEGIN
2022-10-06 08:38:16.497480 (Thread-4): Opening a new connection, currently in state init
2022-10-06 08:38:16.505434 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.505546 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.505636 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:38:16.505735 (Thread-4): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:38:16.505826 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 08:38:16.505928 (Thread-4): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
alter table select * from customers c join orders o on o.order_id=c.order_id drop column c.order_id
select * from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 08:38:16.506330 (Thread-4): Postgres error: syntax error at or near "alter"
LINE 16: alter table select * from customers c join orders o on o.ord...
         ^

2022-10-06 08:38:16.506422 (Thread-4): On model.my_new_project.referencing: ROLLBACK
2022-10-06 08:38:16.506841 (Thread-4): finished collecting timing info
2022-10-06 08:38:16.506958 (Thread-4): On model.my_new_project.referencing: Close
2022-10-06 08:38:16.507184 (Thread-4): Database Error in model referencing (models/referencing.sql)
  syntax error at or near "alter"
  LINE 16: alter table select * from customers c join orders o on o.ord...
           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "alter"
LINE 16: alter table select * from customers c join orders o on o.ord...
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  syntax error at or near "alter"
  LINE 16: alter table select * from customers c join orders o on o.ord...
           ^
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 08:38:16.510410 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975e57a9-1a38-4090-a4ed-30e77e423b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d8646fa0>]}
2022-10-06 08:38:16.510696 (Thread-4): 09:38:16 | 5 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.02s]
2022-10-06 08:38:16.510825 (Thread-4): Finished running node model.my_new_project.referencing
2022-10-06 08:38:16.516254 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:38:16.517895 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:38:16.518008 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 08:38:16.518360 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:38:16.519094 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:38:16.519196 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:38:16.519287 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:38:16.519690 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:38:16.520526 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:38:16.520624 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 08:38:16.520905 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:38:16.521582 (Thread-3): finished collecting timing info
2022-10-06 08:38:16.521711 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 08:38:16.521961 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '975e57a9-1a38-4090-a4ed-30e77e423b8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c84441c0>]}
2022-10-06 08:38:16.522188 (Thread-3): 09:38:16 | 4 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 08:38:16.522303 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 08:38:16.523079 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:38:16.523203 (MainThread): Using postgres connection "master".
2022-10-06 08:38:16.523293 (MainThread): On master: BEGIN
2022-10-06 08:38:16.523382 (MainThread): Opening a new connection, currently in state closed
2022-10-06 08:38:16.531431 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:38:16.531629 (MainThread): On master: COMMIT
2022-10-06 08:38:16.531721 (MainThread): Using postgres connection "master".
2022-10-06 08:38:16.531802 (MainThread): On master: COMMIT
2022-10-06 08:38:16.531977 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:38:16.532079 (MainThread): On master: Close
2022-10-06 08:38:16.532337 (MainThread): 09:38:16 | 
2022-10-06 08:38:16.532449 (MainThread): 09:38:16 | Finished running 4 view models, 1 table model in 0.26s.
2022-10-06 08:38:16.532545 (MainThread): Connection 'master' was properly closed.
2022-10-06 08:38:16.532625 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 08:38:16.532703 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 08:38:16.532779 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 08:38:16.532854 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 08:38:16.535988 (MainThread): 
2022-10-06 08:38:16.536112 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 08:38:16.536210 (MainThread): 
2022-10-06 08:38:16.536302 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 08:38:16.536387 (MainThread):   syntax error at or near "alter"
2022-10-06 08:38:16.536470 (MainThread):   LINE 16: alter table select * from customers c join orders o on o.ord...
2022-10-06 08:38:16.536552 (MainThread):            ^
2022-10-06 08:38:16.536633 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 08:38:16.536723 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 08:38:16.536867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9c82f7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9ea7ef760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9d8616610>]}
2022-10-06 08:38:16.537019 (MainThread): Flushing usage events
2022-10-06 08:43:54.435627 (MainThread): Running with dbt=0.21.1
2022-10-06 08:43:54.509516 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 08:43:54.511167 (MainThread): Tracking: tracking
2022-10-06 08:43:54.536995 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff122c73cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff122d2c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff122d2cbb0>]}
2022-10-06 08:43:54.545865 (MainThread): Partial parsing not enabled
2022-10-06 08:43:54.555697 (MainThread): Parsing macros/catalog.sql
2022-10-06 08:43:54.558272 (MainThread): Parsing macros/relations.sql
2022-10-06 08:43:54.559281 (MainThread): Parsing macros/adapters.sql
2022-10-06 08:43:54.574905 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 08:43:54.576027 (MainThread): Parsing macros/core.sql
2022-10-06 08:43:54.578584 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 08:43:54.583143 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 08:43:54.589688 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 08:43:54.590774 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 08:43:54.602412 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 08:43:54.627038 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 08:43:54.643050 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 08:43:54.644223 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 08:43:54.651368 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 08:43:54.665902 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 08:43:54.675818 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 08:43:54.681427 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 08:43:54.686604 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 08:43:54.689168 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 08:43:54.690131 (MainThread): Parsing macros/etc/query.sql
2022-10-06 08:43:54.690749 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 08:43:54.691751 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 08:43:54.697821 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 08:43:54.711280 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 08:43:54.729868 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 08:43:54.746456 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 08:43:54.812719 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 08:43:54.813894 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 08:43:54.814696 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 08:43:54.815609 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 08:43:54.928924 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:54.937890 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:54.939791 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:43:54.942516 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:54.944883 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:43:54.963546 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:43:54.964723 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:43:54.965836 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:43:54.967064 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:43:54.977392 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0e812ee-161a-4b7c-bcfe-88651f10da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff110199190>]}
2022-10-06 08:43:54.981270 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 08:43:54.982036 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0e812ee-161a-4b7c-bcfe-88651f10da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10011b1c0>]}
2022-10-06 08:43:54.982215 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 08:43:54.983172 (MainThread): 
2022-10-06 08:43:54.983388 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:43:54.984129 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 08:43:54.990203 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 08:43:54.990309 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 08:43:54.990403 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 08:43:55.046945 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 08:43:55.048427 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 08:43:55.049324 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 08:43:55.053489 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:43:55.053623 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 08:43:55.053727 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 08:43:55.062451 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.062584 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:43:55.062692 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 08:43:55.068117 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 08:43:55.069146 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 08:43:55.069449 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 08:43:55.072639 (MainThread): Using postgres connection "master".
2022-10-06 08:43:55.072773 (MainThread): On master: BEGIN
2022-10-06 08:43:55.072882 (MainThread): Opening a new connection, currently in state init
2022-10-06 08:43:55.082316 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.082460 (MainThread): Using postgres connection "master".
2022-10-06 08:43:55.082552 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 08:43:55.102876 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 08:43:55.104097 (MainThread): On master: ROLLBACK
2022-10-06 08:43:55.104373 (MainThread): Using postgres connection "master".
2022-10-06 08:43:55.104489 (MainThread): On master: BEGIN
2022-10-06 08:43:55.104815 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 08:43:55.104946 (MainThread): On master: COMMIT
2022-10-06 08:43:55.105051 (MainThread): Using postgres connection "master".
2022-10-06 08:43:55.105146 (MainThread): On master: COMMIT
2022-10-06 08:43:55.105352 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:43:55.105474 (MainThread): On master: Close
2022-10-06 08:43:55.105719 (MainThread): 09:43:55 | Concurrency: 5 threads (target='dev')
2022-10-06 08:43:55.105855 (MainThread): 09:43:55 | 
2022-10-06 08:43:55.108137 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 08:43:55.108326 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 08:43:55.108456 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 08:43:55.108650 (Thread-1): 09:43:55 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 08:43:55.108833 (Thread-2): 09:43:55 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 08:43:55.109026 (Thread-3): 09:43:55 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 08:43:55.109349 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:55.110190 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:55.110462 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:55.110643 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 08:43:55.110781 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 08:43:55.110899 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 08:43:55.111864 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:43:55.113634 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:43:55.114577 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:43:55.115430 (Thread-2): finished collecting timing info
2022-10-06 08:43:55.127899 (Thread-3): finished collecting timing info
2022-10-06 08:43:55.134509 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:43:55.146125 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:43:55.146323 (Thread-1): finished collecting timing info
2022-10-06 08:43:55.148203 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:43:55.148599 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:55.148741 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:55.148831 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 08:43:55.148941 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 08:43:55.149048 (Thread-3): Opening a new connection, currently in state init
2022-10-06 08:43:55.149165 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:55.149243 (Thread-2): Opening a new connection, currently in state init
2022-10-06 08:43:55.149436 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 08:43:55.149607 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 08:43:55.157252 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.157357 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.157464 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:55.157560 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:55.157649 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 08:43:55.157737 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 08:43:55.158028 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.158112 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:55.158188 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 08:43:55.160134 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 08:43:55.164485 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:55.164653 (Thread-3): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:43:55.164744 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 08:43:55.164823 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:43:55.166248 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:55.167563 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:55.167670 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:43:55.167763 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 08:43:55.167850 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 08:43:55.169056 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:55.169221 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 08:43:55.169546 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:43:55.169643 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:43:55.170850 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:55.170966 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:43:55.172159 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:55.172262 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 08:43:55.178950 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:43:55.179082 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 08:43:55.179232 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:55.179362 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:43:55.179650 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:43:55.180334 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:43:55.180429 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:55.180511 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:43:55.180609 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:43:55.181270 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:43:55.181370 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:55.181452 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:43:55.181558 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:43:55.185102 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:43:55.185218 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 08:43:55.185332 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:43:55.186170 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:43:55.186259 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 08:43:55.186363 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:43:55.187159 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:43:55.187257 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 08:43:55.188221 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:43:55.188878 (Thread-3): finished collecting timing info
2022-10-06 08:43:55.188996 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 08:43:55.189239 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e812ee-161a-4b7c-bcfe-88651f10da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1102c00a0>]}
2022-10-06 08:43:55.189346 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:43:55.189929 (Thread-1): finished collecting timing info
2022-10-06 08:43:55.190038 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 08:43:55.190260 (Thread-3): 09:43:55 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.08s]
2022-10-06 08:43:55.190474 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e812ee-161a-4b7c-bcfe-88651f10da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1102c0130>]}
2022-10-06 08:43:55.190598 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 08:43:55.190723 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2022-10-06 08:43:55.191316 (Thread-2): finished collecting timing info
2022-10-06 08:43:55.191429 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 08:43:55.191626 (Thread-1): 09:43:55 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 08:43:55.191838 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e812ee-161a-4b7c-bcfe-88651f10da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1102b7460>]}
2022-10-06 08:43:55.192027 (Thread-2): 09:43:55 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 08:43:55.192184 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 08:43:55.192336 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 08:43:55.192541 (Thread-5): Began running node model.my_new_project.referencing
2022-10-06 08:43:55.192724 (Thread-5): 09:43:55 | 4 of 5 START view model public.referencing........................... [RUN]
2022-10-06 08:43:55.192948 (Thread-5): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:43:55.193114 (Thread-5): Compiling model.my_new_project.referencing
2022-10-06 08:43:55.194920 (Thread-5): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 08:43:55.195077 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 08:43:55.195245 (Thread-3): 09:43:55 | 5 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 08:43:55.195517 (Thread-3): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:43:55.195661 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 08:43:55.197204 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:43:55.197508 (Thread-5): finished collecting timing info
2022-10-06 08:43:55.199002 (Thread-5): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 08:43:55.199237 (Thread-3): finished collecting timing info
2022-10-06 08:43:55.200987 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:43:55.201315 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:43:55.201443 (Thread-5): On model.my_new_project.referencing: BEGIN
2022-10-06 08:43:55.201544 (Thread-5): Opening a new connection, currently in state init
2022-10-06 08:43:55.201815 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:43:55.201922 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 08:43:55.202013 (Thread-3): Opening a new connection, currently in state closed
2022-10-06 08:43:55.209952 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.210069 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.210163 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:43:55.210269 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:43:55.210356 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 08:43:55.210451 (Thread-5): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select *,o.order_id as orders_order_id from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 08:43:55.211127 (Thread-5): Postgres error: column "order_id" specified more than once

2022-10-06 08:43:55.211241 (Thread-5): On model.my_new_project.referencing: ROLLBACK
2022-10-06 08:43:55.211685 (Thread-5): finished collecting timing info
2022-10-06 08:43:55.211813 (Thread-5): On model.my_new_project.referencing: Close
2022-10-06 08:43:55.212497 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 08:43:55.214167 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:43:55.214339 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 08:43:55.214810 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:43:55.215558 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:43:55.215675 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:43:55.215845 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:43:55.216305 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:43:55.217602 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:43:55.217756 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 08:43:55.218039 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:43:55.218841 (Thread-3): finished collecting timing info
2022-10-06 08:43:55.219012 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 08:43:55.219281 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e812ee-161a-4b7c-bcfe-88651f10da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1101f0af0>]}
2022-10-06 08:43:55.219523 (Thread-3): 09:43:55 | 5 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.02s]
2022-10-06 08:43:55.219696 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 08:43:55.212065 (Thread-5): Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.DuplicateColumn: column "order_id" specified more than once


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model referencing (models/referencing.sql)
  column "order_id" specified more than once
  compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 08:43:55.221436 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0e812ee-161a-4b7c-bcfe-88651f10da8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff11019e700>]}
2022-10-06 08:43:55.221634 (Thread-5): 09:43:55 | 4 of 5 ERROR creating view model public.referencing.................. [ERROR in 0.03s]
2022-10-06 08:43:55.221741 (Thread-5): Finished running node model.my_new_project.referencing
2022-10-06 08:43:55.222470 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:43:55.222599 (MainThread): Using postgres connection "master".
2022-10-06 08:43:55.222685 (MainThread): On master: BEGIN
2022-10-06 08:43:55.222771 (MainThread): Opening a new connection, currently in state closed
2022-10-06 08:43:55.230411 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:43:55.230575 (MainThread): On master: COMMIT
2022-10-06 08:43:55.230661 (MainThread): Using postgres connection "master".
2022-10-06 08:43:55.230740 (MainThread): On master: COMMIT
2022-10-06 08:43:55.230888 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:43:55.230984 (MainThread): On master: Close
2022-10-06 08:43:55.231254 (MainThread): 09:43:55 | 
2022-10-06 08:43:55.231365 (MainThread): 09:43:55 | Finished running 4 view models, 1 table model in 0.25s.
2022-10-06 08:43:55.231464 (MainThread): Connection 'master' was properly closed.
2022-10-06 08:43:55.231545 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 08:43:55.231624 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 08:43:55.231700 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 08:43:55.231776 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 08:43:55.234823 (MainThread): 
2022-10-06 08:43:55.234953 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 08:43:55.235054 (MainThread): 
2022-10-06 08:43:55.235148 (MainThread): Database Error in model referencing (models/referencing.sql)
2022-10-06 08:43:55.235236 (MainThread):   column "order_id" specified more than once
2022-10-06 08:43:55.235318 (MainThread):   compiled SQL at target/run/my_new_project/models/referencing.sql
2022-10-06 08:43:55.235412 (MainThread): 
Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
2022-10-06 08:43:55.235562 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff10011bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1102973a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff110297cd0>]}
2022-10-06 08:43:55.235716 (MainThread): Flushing usage events
2022-10-06 08:45:32.053349 (MainThread): Running with dbt=0.21.1
2022-10-06 08:45:32.122975 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 08:45:32.124745 (MainThread): Tracking: tracking
2022-10-06 08:45:32.147207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e2bd3cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e2c8cca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e2c8c160>]}
2022-10-06 08:45:32.156331 (MainThread): Partial parsing not enabled
2022-10-06 08:45:32.166392 (MainThread): Parsing macros/catalog.sql
2022-10-06 08:45:32.169016 (MainThread): Parsing macros/relations.sql
2022-10-06 08:45:32.170045 (MainThread): Parsing macros/adapters.sql
2022-10-06 08:45:32.186704 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 08:45:32.187887 (MainThread): Parsing macros/core.sql
2022-10-06 08:45:32.190530 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 08:45:32.195315 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 08:45:32.202207 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 08:45:32.203353 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 08:45:32.215633 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 08:45:32.242031 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 08:45:32.258933 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 08:45:32.260120 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 08:45:32.267530 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 08:45:32.282701 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 08:45:32.293088 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 08:45:32.299053 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 08:45:32.304469 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 08:45:32.307090 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 08:45:32.308078 (MainThread): Parsing macros/etc/query.sql
2022-10-06 08:45:32.308703 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 08:45:32.309737 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 08:45:32.315837 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 08:45:32.317082 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 08:45:32.318746 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 08:45:32.319789 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 08:45:32.361180 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 08:45:32.362353 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 08:45:32.363120 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 08:45:32.363984 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 08:45:32.477156 (MainThread): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.484918 (MainThread): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.486977 (MainThread): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:45:32.489768 (MainThread): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.492087 (MainThread): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:45:32.510513 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:45:32.511710 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:45:32.512833 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:45:32.514033 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 08:45:32.524300 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4057a694-e98f-4e83-99f0-4bde83df37df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e2ca2a90>]}
2022-10-06 08:45:32.527924 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 08:45:32.528643 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4057a694-e98f-4e83-99f0-4bde83df37df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b00981f0>]}
2022-10-06 08:45:32.528811 (MainThread): Found 5 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 08:45:32.529778 (MainThread): 
2022-10-06 08:45:32.529998 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:45:32.530763 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 08:45:32.537627 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 08:45:32.537802 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 08:45:32.537904 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 08:45:32.600775 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 08:45:32.602307 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 08:45:32.603217 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 08:45:32.607539 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:45:32.607669 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 08:45:32.607779 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 08:45:32.617134 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.617247 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 08:45:32.617341 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 08:45:32.623287 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 08:45:32.624237 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 08:45:32.624534 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 08:45:32.627561 (MainThread): Using postgres connection "master".
2022-10-06 08:45:32.627700 (MainThread): On master: BEGIN
2022-10-06 08:45:32.627805 (MainThread): Opening a new connection, currently in state init
2022-10-06 08:45:32.637581 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.637699 (MainThread): Using postgres connection "master".
2022-10-06 08:45:32.637796 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 08:45:32.654690 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 08:45:32.655849 (MainThread): On master: ROLLBACK
2022-10-06 08:45:32.656103 (MainThread): Using postgres connection "master".
2022-10-06 08:45:32.656212 (MainThread): On master: BEGIN
2022-10-06 08:45:32.656541 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 08:45:32.656660 (MainThread): On master: COMMIT
2022-10-06 08:45:32.656768 (MainThread): Using postgres connection "master".
2022-10-06 08:45:32.656865 (MainThread): On master: COMMIT
2022-10-06 08:45:32.657061 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:45:32.657175 (MainThread): On master: Close
2022-10-06 08:45:32.657409 (MainThread): 09:45:32 | Concurrency: 5 threads (target='dev')
2022-10-06 08:45:32.657546 (MainThread): 09:45:32 | 
2022-10-06 08:45:32.659858 (Thread-1): Began running node model.my_new_project.customer_cte
2022-10-06 08:45:32.660028 (Thread-2): Began running node model.my_new_project.my_first_dbt_model
2022-10-06 08:45:32.660190 (Thread-3): Began running node model.my_new_project.orders_cte
2022-10-06 08:45:32.660404 (Thread-1): 09:45:32 | 1 of 5 START view model public.customer_cte.......................... [RUN]
2022-10-06 08:45:32.660603 (Thread-2): 09:45:32 | 2 of 5 START table model public.my_first_dbt_model................... [RUN]
2022-10-06 08:45:32.660793 (Thread-3): 09:45:32 | 3 of 5 START view model public.orders_cte............................ [RUN]
2022-10-06 08:45:32.661098 (Thread-1): Acquiring new postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.661908 (Thread-2): Acquiring new postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.662213 (Thread-3): Acquiring new postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.662374 (Thread-1): Compiling model.my_new_project.customer_cte
2022-10-06 08:45:32.662506 (Thread-2): Compiling model.my_new_project.my_first_dbt_model
2022-10-06 08:45:32.662624 (Thread-3): Compiling model.my_new_project.orders_cte
2022-10-06 08:45:32.663567 (Thread-1): Writing injected SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:45:32.665903 (Thread-2): Writing injected SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:45:32.667005 (Thread-3): Writing injected SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:45:32.667733 (Thread-2): finished collecting timing info
2022-10-06 08:45:32.674259 (Thread-1): finished collecting timing info
2022-10-06 08:45:32.674392 (Thread-3): finished collecting timing info
2022-10-06 08:45:32.686048 (Thread-2): Writing runtime SQL for node "model.my_new_project.my_first_dbt_model"
2022-10-06 08:45:32.697537 (Thread-1): Writing runtime SQL for node "model.my_new_project.customer_cte"
2022-10-06 08:45:32.699044 (Thread-3): Writing runtime SQL for node "model.my_new_project.orders_cte"
2022-10-06 08:45:32.699553 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.699691 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.699786 (Thread-2): On model.my_new_project.my_first_dbt_model: BEGIN
2022-10-06 08:45:32.699878 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.699961 (Thread-3): On model.my_new_project.orders_cte: BEGIN
2022-10-06 08:45:32.700050 (Thread-2): Opening a new connection, currently in state init
2022-10-06 08:45:32.700130 (Thread-1): On model.my_new_project.customer_cte: BEGIN
2022-10-06 08:45:32.700210 (Thread-3): Opening a new connection, currently in state init
2022-10-06 08:45:32.700398 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 08:45:32.710143 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.710253 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.710340 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.710425 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.710514 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.710606 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 08:45:32.710697 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.710779 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */


  create  table "postgres"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
2022-10-06 08:45:32.710896 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 08:45:32.714078 (Thread-2): SQL status: SELECT 2 in 0.00 seconds
2022-10-06 08:45:32.714298 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 08:45:32.718334 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.718436 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 08:45:32.719794 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.719911 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
2022-10-06 08:45:32.721100 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.721209 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 08:45:32.721340 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 08:45:32.721807 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.723058 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.723161 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.723247 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
alter table "postgres"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
2022-10-06 08:45:32.723323 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.724500 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.725734 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.725840 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.725923 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 08:45:32.726009 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 08:45:32.732567 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:45:32.732761 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.732851 (Thread-2): On model.my_new_project.my_first_dbt_model: COMMIT
2022-10-06 08:45:32.733332 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.734008 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:45:32.734104 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.734197 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.734279 (Thread-3): On model.my_new_project.orders_cte: COMMIT
2022-10-06 08:45:32.734356 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:45:32.734996 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:45:32.738586 (Thread-2): Using postgres connection "model.my_new_project.my_first_dbt_model".
2022-10-06 08:45:32.738713 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.738790 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:45:32.738874 (Thread-2): On model.my_new_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_first_dbt_model"} */
drop table if exists "postgres"."public"."my_first_dbt_model__dbt_backup" cascade
2022-10-06 08:45:32.738955 (Thread-1): On model.my_new_project.customer_cte: COMMIT
2022-10-06 08:45:32.739782 (Thread-3): Using postgres connection "model.my_new_project.orders_cte".
2022-10-06 08:45:32.739937 (Thread-3): On model.my_new_project.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 08:45:32.740569 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:45:32.741376 (Thread-1): Using postgres connection "model.my_new_project.customer_cte".
2022-10-06 08:45:32.741465 (Thread-1): On model.my_new_project.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 08:45:32.741566 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:45:32.742194 (Thread-3): finished collecting timing info
2022-10-06 08:45:32.742309 (Thread-3): On model.my_new_project.orders_cte: Close
2022-10-06 08:45:32.742544 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4057a694-e98f-4e83-99f0-4bde83df37df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d03c5580>]}
2022-10-06 08:45:32.742757 (Thread-3): 09:45:32 | 3 of 5 OK created view model public.orders_cte....................... [CREATE VIEW in 0.08s]
2022-10-06 08:45:32.742862 (Thread-3): Finished running node model.my_new_project.orders_cte
2022-10-06 08:45:32.743054 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:45:32.743717 (Thread-1): finished collecting timing info
2022-10-06 08:45:32.743826 (Thread-1): On model.my_new_project.customer_cte: Close
2022-10-06 08:45:32.743922 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 08:45:32.744519 (Thread-2): finished collecting timing info
2022-10-06 08:45:32.744756 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4057a694-e98f-4e83-99f0-4bde83df37df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b0185af0>]}
2022-10-06 08:45:32.744865 (Thread-2): On model.my_new_project.my_first_dbt_model: Close
2022-10-06 08:45:32.745087 (Thread-1): 09:45:32 | 1 of 5 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 08:45:32.745226 (Thread-1): Finished running node model.my_new_project.customer_cte
2022-10-06 08:45:32.745463 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4057a694-e98f-4e83-99f0-4bde83df37df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b0185610>]}
2022-10-06 08:45:32.745723 (Thread-2): 09:45:32 | 2 of 5 OK created table model public.my_first_dbt_model.............. [SELECT 2 in 0.08s]
2022-10-06 08:45:32.745965 (Thread-2): Finished running node model.my_new_project.my_first_dbt_model
2022-10-06 08:45:32.746116 (Thread-5): Began running node model.my_new_project.referencing
2022-10-06 08:45:32.746408 (Thread-3): Began running node model.my_new_project.my_second_dbt_model
2022-10-06 08:45:32.746572 (Thread-5): 09:45:32 | 4 of 5 START view model public.referencing........................... [RUN]
2022-10-06 08:45:32.746718 (Thread-3): 09:45:32 | 5 of 5 START view model public.my_second_dbt_model................... [RUN]
2022-10-06 08:45:32.747005 (Thread-5): Acquiring new postgres connection "model.my_new_project.referencing".
2022-10-06 08:45:32.747119 (Thread-5): Compiling model.my_new_project.referencing
2022-10-06 08:45:32.749173 (Thread-5): Writing injected SQL for node "model.my_new_project.referencing"
2022-10-06 08:45:32.749480 (Thread-3): Acquiring new postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:45:32.749738 (Thread-3): Compiling model.my_new_project.my_second_dbt_model
2022-10-06 08:45:32.751711 (Thread-3): Writing injected SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:45:32.751995 (Thread-5): finished collecting timing info
2022-10-06 08:45:32.753370 (Thread-5): Writing runtime SQL for node "model.my_new_project.referencing"
2022-10-06 08:45:32.753500 (Thread-3): finished collecting timing info
2022-10-06 08:45:32.754733 (Thread-3): Writing runtime SQL for node "model.my_new_project.my_second_dbt_model"
2022-10-06 08:45:32.754955 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:45:32.755045 (Thread-5): On model.my_new_project.referencing: BEGIN
2022-10-06 08:45:32.755152 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:45:32.755238 (Thread-5): Opening a new connection, currently in state init
2022-10-06 08:45:32.755328 (Thread-3): On model.my_new_project.my_second_dbt_model: BEGIN
2022-10-06 08:45:32.755503 (Thread-3): Opening a new connection, currently in state closed
2022-10-06 08:45:32.762977 (Thread-5): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.763111 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.763212 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:45:32.763313 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:45:32.763406 (Thread-5): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */

  create view "postgres"."public"."referencing__dbt_tmp" as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.email,c.date_of_birth,c.current_job,o.order_name,o.order_qty,o.order_price
from customers c join orders o on o.order_id=c.order_id
  );

2022-10-06 08:45:32.763496 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */

  create view "postgres"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "postgres"."public"."my_first_dbt_model"
where id = 1
  );

2022-10-06 08:45:32.765349 (Thread-3): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 08:45:32.767088 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:45:32.767337 (Thread-5): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 08:45:32.767464 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
alter table "postgres"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
2022-10-06 08:45:32.768722 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:45:32.768861 (Thread-5): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 08:45:32.769159 (Thread-3): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.769891 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:45:32.769982 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:45:32.770061 (Thread-3): On model.my_new_project.my_second_dbt_model: COMMIT
2022-10-06 08:45:32.770152 (Thread-5): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 08:45:32.770756 (Thread-5): On model.my_new_project.referencing: COMMIT
2022-10-06 08:45:32.770844 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:45:32.770923 (Thread-5): On model.my_new_project.referencing: COMMIT
2022-10-06 08:45:32.771013 (Thread-3): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:45:32.771751 (Thread-3): Using postgres connection "model.my_new_project.my_second_dbt_model".
2022-10-06 08:45:32.771842 (Thread-3): On model.my_new_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.my_second_dbt_model"} */
drop view if exists "postgres"."public"."my_second_dbt_model__dbt_backup" cascade
2022-10-06 08:45:32.771944 (Thread-5): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:45:32.772799 (Thread-5): Using postgres connection "model.my_new_project.referencing".
2022-10-06 08:45:32.772893 (Thread-5): On model.my_new_project.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.referencing"} */
drop view if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 08:45:32.772997 (Thread-3): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:45:32.773588 (Thread-3): finished collecting timing info
2022-10-06 08:45:32.773705 (Thread-3): On model.my_new_project.my_second_dbt_model: Close
2022-10-06 08:45:32.773807 (Thread-5): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 08:45:32.774397 (Thread-5): finished collecting timing info
2022-10-06 08:45:32.774501 (Thread-5): On model.my_new_project.referencing: Close
2022-10-06 08:45:32.774722 (Thread-5): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4057a694-e98f-4e83-99f0-4bde83df37df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82d03c9bb0>]}
2022-10-06 08:45:32.774924 (Thread-3): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4057a694-e98f-4e83-99f0-4bde83df37df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82e2d154c0>]}
2022-10-06 08:45:32.775124 (Thread-3): 09:45:32 | 5 of 5 OK created view model public.my_second_dbt_model.............. [CREATE VIEW in 0.03s]
2022-10-06 08:45:32.775230 (Thread-3): Finished running node model.my_new_project.my_second_dbt_model
2022-10-06 08:45:32.775455 (Thread-5): 09:45:32 | 4 of 5 OK created view model public.referencing...................... [CREATE VIEW in 0.03s]
2022-10-06 08:45:32.775632 (Thread-5): Finished running node model.my_new_project.referencing
2022-10-06 08:45:32.776441 (MainThread): Acquiring new postgres connection "master".
2022-10-06 08:45:32.776551 (MainThread): Using postgres connection "master".
2022-10-06 08:45:32.776627 (MainThread): On master: BEGIN
2022-10-06 08:45:32.776704 (MainThread): Opening a new connection, currently in state closed
2022-10-06 08:45:32.784883 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 08:45:32.785056 (MainThread): On master: COMMIT
2022-10-06 08:45:32.785142 (MainThread): Using postgres connection "master".
2022-10-06 08:45:32.785217 (MainThread): On master: COMMIT
2022-10-06 08:45:32.785386 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 08:45:32.785483 (MainThread): On master: Close
2022-10-06 08:45:32.785737 (MainThread): 09:45:32 | 
2022-10-06 08:45:32.785842 (MainThread): 09:45:32 | Finished running 4 view models, 1 table model in 0.26s.
2022-10-06 08:45:32.785935 (MainThread): Connection 'master' was properly closed.
2022-10-06 08:45:32.786010 (MainThread): Connection 'model.my_new_project.customer_cte' was properly closed.
2022-10-06 08:45:32.786085 (MainThread): Connection 'model.my_new_project.my_first_dbt_model' was properly closed.
2022-10-06 08:45:32.786161 (MainThread): Connection 'model.my_new_project.my_second_dbt_model' was properly closed.
2022-10-06 08:45:32.786233 (MainThread): Connection 'model.my_new_project.referencing' was properly closed.
2022-10-06 08:45:32.789152 (MainThread): 
2022-10-06 08:45:32.789267 (MainThread): Completed successfully
2022-10-06 08:45:32.789371 (MainThread): 
Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-10-06 08:45:32.789519 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b00989a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b01429d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f82b0177100>]}
2022-10-06 08:45:32.789671 (MainThread): Flushing usage events
2022-10-06 13:53:48.900652 (MainThread): Running with dbt=0.21.1
2022-10-06 13:53:49.006470 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 13:53:49.012214 (MainThread): Tracking: tracking
2022-10-06 13:53:49.040989 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bab15cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0babdf6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0babdf430>]}
2022-10-06 13:53:49.049688 (MainThread): Partial parsing not enabled
2022-10-06 13:53:49.059159 (MainThread): Parsing macros/catalog.sql
2022-10-06 13:53:49.061737 (MainThread): Parsing macros/relations.sql
2022-10-06 13:53:49.062788 (MainThread): Parsing macros/adapters.sql
2022-10-06 13:53:49.079866 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 13:53:49.081034 (MainThread): Parsing macros/core.sql
2022-10-06 13:53:49.083578 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 13:53:49.088436 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 13:53:49.095491 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 13:53:49.096641 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 13:53:49.108817 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 13:53:49.138384 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 13:53:49.155766 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 13:53:49.156964 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 13:53:49.164746 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 13:53:49.180766 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 13:53:49.191561 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 13:53:49.198047 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 13:53:49.203979 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 13:53:49.206595 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 13:53:49.207565 (MainThread): Parsing macros/etc/query.sql
2022-10-06 13:53:49.208179 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 13:53:49.209218 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 13:53:49.215420 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 13:53:49.216628 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 13:53:49.218244 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 13:53:49.219294 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 13:53:49.262451 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 13:53:49.263615 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 13:53:49.264387 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 13:53:49.265271 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 13:53:49.377382 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.385213 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.387166 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 13:53:49.403714 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4644583d-c438-40cd-bf10-154bfe581a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a84750d0>]}
2022-10-06 13:53:49.407553 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 13:53:49.407814 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4644583d-c438-40cd-bf10-154bfe581a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a84521c0>]}
2022-10-06 13:53:49.407970 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 13:53:49.408761 (MainThread): 
2022-10-06 13:53:49.408971 (MainThread): Acquiring new postgres connection "master".
2022-10-06 13:53:49.409624 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 13:53:49.416344 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 13:53:49.416515 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 13:53:49.416619 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 13:53:49.517531 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.10 seconds
2022-10-06 13:53:49.519774 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 13:53:49.520807 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 13:53:49.526013 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 13:53:49.526165 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 13:53:49.526293 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 13:53:49.536475 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 13:53:49.536609 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 13:53:49.536718 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 13:53:49.544031 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2022-10-06 13:53:49.545191 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 13:53:49.545504 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 13:53:49.548796 (MainThread): Using postgres connection "master".
2022-10-06 13:53:49.548935 (MainThread): On master: BEGIN
2022-10-06 13:53:49.549050 (MainThread): Opening a new connection, currently in state init
2022-10-06 13:53:49.559161 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 13:53:49.559293 (MainThread): Using postgres connection "master".
2022-10-06 13:53:49.559395 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 13:53:49.589446 (MainThread): SQL status: SELECT 5 in 0.03 seconds
2022-10-06 13:53:49.590936 (MainThread): On master: ROLLBACK
2022-10-06 13:53:49.591241 (MainThread): Using postgres connection "master".
2022-10-06 13:53:49.591375 (MainThread): On master: BEGIN
2022-10-06 13:53:49.591713 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 13:53:49.591851 (MainThread): On master: COMMIT
2022-10-06 13:53:49.591967 (MainThread): Using postgres connection "master".
2022-10-06 13:53:49.592071 (MainThread): On master: COMMIT
2022-10-06 13:53:49.592287 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 13:53:49.592415 (MainThread): On master: Close
2022-10-06 13:53:49.592661 (MainThread): 14:53:49 | Concurrency: 5 threads (target='dev')
2022-10-06 13:53:49.592808 (MainThread): 14:53:49 | 
2022-10-06 13:53:49.595273 (Thread-1): Began running node model.view_for_bi_guys.customer_cte
2022-10-06 13:53:49.595519 (Thread-2): Began running node model.view_for_bi_guys.orders_cte
2022-10-06 13:53:49.595830 (Thread-1): 14:53:49 | 1 of 3 START view model public.customer_cte.......................... [RUN]
2022-10-06 13:53:49.596071 (Thread-2): 14:53:49 | 2 of 3 START view model public.orders_cte............................ [RUN]
2022-10-06 13:53:49.596423 (Thread-1): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.596739 (Thread-2): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.596908 (Thread-1): Compiling model.view_for_bi_guys.customer_cte
2022-10-06 13:53:49.597048 (Thread-2): Compiling model.view_for_bi_guys.orders_cte
2022-10-06 13:53:49.598348 (Thread-1): Writing injected SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 13:53:49.599583 (Thread-2): Writing injected SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 13:53:49.600278 (Thread-1): finished collecting timing info
2022-10-06 13:53:49.600435 (Thread-2): finished collecting timing info
2022-10-06 13:53:49.626181 (Thread-2): Writing runtime SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 13:53:49.626752 (Thread-1): Writing runtime SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 13:53:49.627263 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.627392 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.627486 (Thread-1): On model.view_for_bi_guys.customer_cte: BEGIN
2022-10-06 13:53:49.627581 (Thread-2): On model.view_for_bi_guys.orders_cte: BEGIN
2022-10-06 13:53:49.627674 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 13:53:49.627758 (Thread-2): Opening a new connection, currently in state init
2022-10-06 13:53:49.637655 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 13:53:49.637780 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 13:53:49.637883 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.637988 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.638087 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 13:53:49.638186 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 13:53:49.646148 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 13:53:49.646258 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 13:53:49.650869 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.652356 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.652480 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 13:53:49.652589 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 13:53:49.653630 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 13:53:49.653735 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 13:53:49.655732 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.657067 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.657183 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 13:53:49.657282 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 13:53:49.657834 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 13:53:49.657936 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 13:53:49.662470 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 13:53:49.663220 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 13:53:49.663333 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.663428 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.663518 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 13:53:49.663606 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 13:53:49.664859 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 13:53:49.668002 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 13:53:49.668116 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 13:53:49.668203 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 13:53:49.669140 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 13:53:49.669281 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 13:53:49.673091 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 13:53:49.673829 (Thread-2): finished collecting timing info
2022-10-06 13:53:49.673961 (Thread-2): On model.view_for_bi_guys.orders_cte: Close
2022-10-06 13:53:49.674230 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4644583d-c438-40cd-bf10-154bfe581a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a8493bb0>]}
2022-10-06 13:53:49.674333 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 13:53:49.674604 (Thread-2): 14:53:49 | 2 of 3 OK created view model public.orders_cte....................... [CREATE VIEW in 0.08s]
2022-10-06 13:53:49.675329 (Thread-1): finished collecting timing info
2022-10-06 13:53:49.675489 (Thread-2): Finished running node model.view_for_bi_guys.orders_cte
2022-10-06 13:53:49.675627 (Thread-1): On model.view_for_bi_guys.customer_cte: Close
2022-10-06 13:53:49.676027 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4644583d-c438-40cd-bf10-154bfe581a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a84b4fa0>]}
2022-10-06 13:53:49.676259 (Thread-1): 14:53:49 | 1 of 3 OK created view model public.customer_cte..................... [CREATE VIEW in 0.08s]
2022-10-06 13:53:49.676377 (Thread-1): Finished running node model.view_for_bi_guys.customer_cte
2022-10-06 13:53:49.676791 (Thread-4): Began running node model.view_for_bi_guys.referencing
2022-10-06 13:53:49.677000 (Thread-4): 14:53:49 | 3 of 3 START table model public.referencing.......................... [RUN]
2022-10-06 13:53:49.677251 (Thread-4): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 13:53:49.677386 (Thread-4): Compiling model.view_for_bi_guys.referencing
2022-10-06 13:53:49.679569 (Thread-4): Writing injected SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 13:53:49.680054 (Thread-4): finished collecting timing info
2022-10-06 13:53:49.693587 (Thread-4): Writing runtime SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 13:53:49.694091 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 13:53:49.694197 (Thread-4): On model.view_for_bi_guys.referencing: BEGIN
2022-10-06 13:53:49.694292 (Thread-4): Opening a new connection, currently in state init
2022-10-06 13:53:49.703116 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 13:53:49.703296 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 13:53:49.703388 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */


  create  table "postgres"."public"."referencing__dbt_tmp"
  as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.email,c.date_of_birth,c.current_job,o.order_name,o.order_qty,o.order_price
from customers c join orders o on o.order_id=c.order_id
  );
2022-10-06 13:53:49.709127 (Thread-4): SQL status: SELECT 3 in 0.01 seconds
2022-10-06 13:53:49.710805 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 13:53:49.710928 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 13:53:49.712609 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 13:53:49.716568 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 13:53:49.716693 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 13:53:49.716790 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 13:53:49.717488 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-06 13:53:49.718526 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 13:53:49.718641 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
drop table if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 13:53:49.718994 (Thread-4): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 13:53:49.719740 (Thread-4): finished collecting timing info
2022-10-06 13:53:49.719876 (Thread-4): On model.view_for_bi_guys.referencing: Close
2022-10-06 13:53:49.720142 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4644583d-c438-40cd-bf10-154bfe581a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a8475400>]}
2022-10-06 13:53:49.720384 (Thread-4): 14:53:49 | 3 of 3 OK created table model public.referencing..................... [SELECT 3 in 0.04s]
2022-10-06 13:53:49.720514 (Thread-4): Finished running node model.view_for_bi_guys.referencing
2022-10-06 13:53:49.721294 (MainThread): Acquiring new postgres connection "master".
2022-10-06 13:53:49.721451 (MainThread): Using postgres connection "master".
2022-10-06 13:53:49.721554 (MainThread): On master: BEGIN
2022-10-06 13:53:49.721655 (MainThread): Opening a new connection, currently in state closed
2022-10-06 13:53:49.730979 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 13:53:49.731173 (MainThread): On master: COMMIT
2022-10-06 13:53:49.731269 (MainThread): Using postgres connection "master".
2022-10-06 13:53:49.731358 (MainThread): On master: COMMIT
2022-10-06 13:53:49.731526 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 13:53:49.731631 (MainThread): On master: Close
2022-10-06 13:53:49.731902 (MainThread): 14:53:49 | 
2022-10-06 13:53:49.732024 (MainThread): 14:53:49 | Finished running 2 view models, 1 table model in 0.32s.
2022-10-06 13:53:49.732131 (MainThread): Connection 'master' was properly closed.
2022-10-06 13:53:49.732220 (MainThread): Connection 'model.view_for_bi_guys.customer_cte' was properly closed.
2022-10-06 13:53:49.732305 (MainThread): Connection 'model.view_for_bi_guys.orders_cte' was properly closed.
2022-10-06 13:53:49.732388 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 13:53:49.735689 (MainThread): 
2022-10-06 13:53:49.735827 (MainThread): Completed successfully
2022-10-06 13:53:49.735943 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 13:53:49.736105 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0a851da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0babd5fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bac548e0>]}
2022-10-06 13:53:49.736279 (MainThread): Flushing usage events
2022-10-06 14:52:41.011954 (MainThread): Running with dbt=0.21.1
2022-10-06 14:52:41.088458 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 14:52:41.090215 (MainThread): Tracking: tracking
2022-10-06 14:52:41.117176 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5ab64c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5ac29ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5ac29610>]}
2022-10-06 14:52:41.125714 (MainThread): Partial parsing not enabled
2022-10-06 14:52:41.134822 (MainThread): Parsing macros/catalog.sql
2022-10-06 14:52:41.137404 (MainThread): Parsing macros/relations.sql
2022-10-06 14:52:41.138420 (MainThread): Parsing macros/adapters.sql
2022-10-06 14:52:41.154336 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 14:52:41.155481 (MainThread): Parsing macros/core.sql
2022-10-06 14:52:41.157974 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 14:52:41.162644 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 14:52:41.169430 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 14:52:41.170538 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 14:52:41.182364 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 14:52:41.207401 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 14:52:41.223741 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 14:52:41.224915 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 14:52:41.232207 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 14:52:41.246912 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 14:52:41.257167 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 14:52:41.262921 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 14:52:41.268225 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 14:52:41.270897 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 14:52:41.271891 (MainThread): Parsing macros/etc/query.sql
2022-10-06 14:52:41.272512 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 14:52:41.273523 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 14:52:41.279662 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 14:52:41.280888 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 14:52:41.282565 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 14:52:41.283619 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 14:52:41.323975 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 14:52:41.325219 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 14:52:41.326002 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 14:52:41.326931 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 14:52:41.442325 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.450401 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.452536 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.469723 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5964ceb5-18c7-4d45-bf18-6145a1bce086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a380a50d0>]}
2022-10-06 14:52:41.473062 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 14:52:41.473328 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5964ceb5-18c7-4d45-bf18-6145a1bce086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a38083280>]}
2022-10-06 14:52:41.473489 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 14:52:41.474268 (MainThread): 
2022-10-06 14:52:41.474488 (MainThread): Acquiring new postgres connection "master".
2022-10-06 14:52:41.475107 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 14:52:41.481147 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 14:52:41.481311 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 14:52:41.481412 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 14:52:41.569546 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.09 seconds
2022-10-06 14:52:41.571528 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 14:52:41.572453 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 14:52:41.577168 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 14:52:41.577310 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 14:52:41.577431 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 14:52:41.586378 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:41.586533 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 14:52:41.586635 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 14:52:41.593079 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2022-10-06 14:52:41.594162 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 14:52:41.594422 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 14:52:41.597601 (MainThread): Using postgres connection "master".
2022-10-06 14:52:41.597724 (MainThread): On master: BEGIN
2022-10-06 14:52:41.597831 (MainThread): Opening a new connection, currently in state init
2022-10-06 14:52:41.606823 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:41.607006 (MainThread): Using postgres connection "master".
2022-10-06 14:52:41.607110 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 14:52:41.628175 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 14:52:41.629506 (MainThread): On master: ROLLBACK
2022-10-06 14:52:41.629799 (MainThread): Using postgres connection "master".
2022-10-06 14:52:41.629918 (MainThread): On master: BEGIN
2022-10-06 14:52:41.630256 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 14:52:41.630384 (MainThread): On master: COMMIT
2022-10-06 14:52:41.630495 (MainThread): Using postgres connection "master".
2022-10-06 14:52:41.630592 (MainThread): On master: COMMIT
2022-10-06 14:52:41.630799 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:41.630927 (MainThread): On master: Close
2022-10-06 14:52:41.631179 (MainThread): 15:52:41 | Concurrency: 5 threads (target='dev')
2022-10-06 14:52:41.631316 (MainThread): 15:52:41 | 
2022-10-06 14:52:41.633620 (Thread-1): Began running node model.view_for_bi_guys.customer_cte
2022-10-06 14:52:41.633800 (Thread-2): Began running node model.view_for_bi_guys.orders_cte
2022-10-06 14:52:41.634026 (Thread-1): 15:52:41 | 1 of 3 START view model public.customer_cte.......................... [RUN]
2022-10-06 14:52:41.634229 (Thread-2): 15:52:41 | 2 of 3 START view model public.orders_cte............................ [RUN]
2022-10-06 14:52:41.634546 (Thread-1): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.634798 (Thread-2): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.634953 (Thread-1): Compiling model.view_for_bi_guys.customer_cte
2022-10-06 14:52:41.635083 (Thread-2): Compiling model.view_for_bi_guys.orders_cte
2022-10-06 14:52:41.636141 (Thread-1): Writing injected SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 14:52:41.637028 (Thread-2): Writing injected SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 14:52:41.637544 (Thread-1): finished collecting timing info
2022-10-06 14:52:41.637679 (Thread-2): finished collecting timing info
2022-10-06 14:52:41.654940 (Thread-1): Writing runtime SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 14:52:41.656877 (Thread-2): Writing runtime SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 14:52:41.657389 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.657538 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.657638 (Thread-2): On model.view_for_bi_guys.orders_cte: BEGIN
2022-10-06 14:52:41.657739 (Thread-1): On model.view_for_bi_guys.customer_cte: BEGIN
2022-10-06 14:52:41.657835 (Thread-2): Opening a new connection, currently in state init
2022-10-06 14:52:41.657920 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 14:52:41.665643 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:41.665757 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:41.665852 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.665948 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.666040 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 14:52:41.666133 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 14:52:41.670414 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 14:52:41.670613 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 14:52:41.675008 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.676387 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.676508 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 14:52:41.676604 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 14:52:41.677291 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:41.677397 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:41.679318 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.680572 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.680687 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 14:52:41.680780 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 14:52:41.681165 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:41.681266 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:41.685609 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 14:52:41.686438 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 14:52:41.686574 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.686671 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.686759 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 14:52:41.686844 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 14:52:41.687800 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:41.687904 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:41.691210 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:41.692150 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:41.692252 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 14:52:41.692344 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 14:52:41.695761 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 14:52:41.696522 (Thread-2): finished collecting timing info
2022-10-06 14:52:41.696651 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 14:52:41.696772 (Thread-2): On model.view_for_bi_guys.orders_cte: Close
2022-10-06 14:52:41.697481 (Thread-1): finished collecting timing info
2022-10-06 14:52:41.697634 (Thread-1): On model.view_for_bi_guys.customer_cte: Close
2022-10-06 14:52:41.697890 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5964ceb5-18c7-4d45-bf18-6145a1bce086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a4848a310>]}
2022-10-06 14:52:41.698095 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5964ceb5-18c7-4d45-bf18-6145a1bce086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a48462fd0>]}
2022-10-06 14:52:41.698342 (Thread-2): 15:52:41 | 2 of 3 OK created view model public.orders_cte....................... [CREATE VIEW in 0.06s]
2022-10-06 14:52:41.698561 (Thread-1): 15:52:41 | 1 of 3 OK created view model public.customer_cte..................... [CREATE VIEW in 0.06s]
2022-10-06 14:52:41.698694 (Thread-2): Finished running node model.view_for_bi_guys.orders_cte
2022-10-06 14:52:41.698909 (Thread-1): Finished running node model.view_for_bi_guys.customer_cte
2022-10-06 14:52:41.699317 (Thread-4): Began running node model.view_for_bi_guys.referencing
2022-10-06 14:52:41.699519 (Thread-4): 15:52:41 | 3 of 3 START table model public.referencing.......................... [RUN]
2022-10-06 14:52:41.699743 (Thread-4): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.699855 (Thread-4): Compiling model.view_for_bi_guys.referencing
2022-10-06 14:52:41.701741 (Thread-4): Writing injected SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 14:52:41.702096 (Thread-4): finished collecting timing info
2022-10-06 14:52:41.715290 (Thread-4): Writing runtime SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 14:52:41.715716 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.715811 (Thread-4): On model.view_for_bi_guys.referencing: BEGIN
2022-10-06 14:52:41.715902 (Thread-4): Opening a new connection, currently in state init
2022-10-06 14:52:41.723641 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:41.723819 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.723910 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */


  create  table "postgres"."public"."referencing__dbt_tmp"
  as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.email,c.date_of_birth,c.current_job,o.order_name,o.order_qty,o.order_price
from customers c join orders o on o.order_id=c.order_id
  );
2022-10-06 14:52:41.726923 (Thread-4): SQL status: SELECT 3 in 0.00 seconds
2022-10-06 14:52:41.728506 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.728619 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing" rename to "referencing__dbt_backup"
2022-10-06 14:52:41.728991 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:41.730157 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.730253 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 14:52:41.730824 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:41.734352 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 14:52:41.734463 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.734548 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 14:52:41.735414 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:41.736324 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:41.736440 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
drop table if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 14:52:41.740124 (Thread-4): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 14:52:41.741009 (Thread-4): finished collecting timing info
2022-10-06 14:52:41.741139 (Thread-4): On model.view_for_bi_guys.referencing: Close
2022-10-06 14:52:41.741398 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5964ceb5-18c7-4d45-bf18-6145a1bce086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a380a5970>]}
2022-10-06 14:52:41.741623 (Thread-4): 15:52:41 | 3 of 3 OK created table model public.referencing..................... [SELECT 3 in 0.04s]
2022-10-06 14:52:41.741735 (Thread-4): Finished running node model.view_for_bi_guys.referencing
2022-10-06 14:52:41.742425 (MainThread): Acquiring new postgres connection "master".
2022-10-06 14:52:41.742548 (MainThread): Using postgres connection "master".
2022-10-06 14:52:41.742651 (MainThread): On master: BEGIN
2022-10-06 14:52:41.742736 (MainThread): Opening a new connection, currently in state closed
2022-10-06 14:52:41.751731 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:41.751855 (MainThread): On master: COMMIT
2022-10-06 14:52:41.751948 (MainThread): Using postgres connection "master".
2022-10-06 14:52:41.752034 (MainThread): On master: COMMIT
2022-10-06 14:52:41.752287 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:41.752391 (MainThread): On master: Close
2022-10-06 14:52:41.752617 (MainThread): 15:52:41 | 
2022-10-06 14:52:41.752730 (MainThread): 15:52:41 | Finished running 2 view models, 1 table model in 0.28s.
2022-10-06 14:52:41.752834 (MainThread): Connection 'master' was properly closed.
2022-10-06 14:52:41.752922 (MainThread): Connection 'model.view_for_bi_guys.customer_cte' was properly closed.
2022-10-06 14:52:41.753008 (MainThread): Connection 'model.view_for_bi_guys.orders_cte' was properly closed.
2022-10-06 14:52:41.753090 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 14:52:41.756274 (MainThread): 
2022-10-06 14:52:41.756445 (MainThread): Completed successfully
2022-10-06 14:52:41.756555 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 14:52:41.756725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a5ac29e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a380833d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a484c4e20>]}
2022-10-06 14:52:41.756891 (MainThread): Flushing usage events
2022-10-06 14:52:50.149507 (MainThread): Running with dbt=0.21.1
2022-10-06 14:52:50.206282 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 14:52:50.211969 (MainThread): Tracking: tracking
2022-10-06 14:52:50.234772 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9223bbbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9223c7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe92247a1f0>]}
2022-10-06 14:52:50.243100 (MainThread): Partial parsing not enabled
2022-10-06 14:52:50.251460 (MainThread): Parsing macros/catalog.sql
2022-10-06 14:52:50.254037 (MainThread): Parsing macros/relations.sql
2022-10-06 14:52:50.255095 (MainThread): Parsing macros/adapters.sql
2022-10-06 14:52:50.271596 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 14:52:50.272740 (MainThread): Parsing macros/core.sql
2022-10-06 14:52:50.275249 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 14:52:50.279948 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 14:52:50.286811 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 14:52:50.287931 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 14:52:50.299756 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 14:52:50.325398 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 14:52:50.341948 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 14:52:50.343117 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 14:52:50.350363 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 14:52:50.365228 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 14:52:50.375422 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 14:52:50.381096 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 14:52:50.386427 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 14:52:50.389013 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 14:52:50.389980 (MainThread): Parsing macros/etc/query.sql
2022-10-06 14:52:50.390591 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 14:52:50.391598 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 14:52:50.397612 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 14:52:50.398810 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 14:52:50.400430 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 14:52:50.401456 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 14:52:50.442392 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 14:52:50.443519 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 14:52:50.444282 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 14:52:50.445168 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 14:52:50.559391 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.567244 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.569248 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.584478 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f286481-1a3b-43ac-8dd2-c8081c8cc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9102960d0>]}
2022-10-06 14:52:50.587600 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 14:52:50.587845 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f286481-1a3b-43ac-8dd2-c8081c8cc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9102723d0>]}
2022-10-06 14:52:50.588006 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 14:52:50.588807 (MainThread): 
2022-10-06 14:52:50.589044 (MainThread): Acquiring new postgres connection "master".
2022-10-06 14:52:50.589747 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 14:52:50.596715 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 14:52:50.596894 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 14:52:50.596999 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 14:52:50.608448 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.01 seconds
2022-10-06 14:52:50.609766 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 14:52:50.610484 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 14:52:50.614117 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 14:52:50.614231 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 14:52:50.614325 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 14:52:50.622846 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:50.623061 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 14:52:50.623149 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 14:52:50.626127 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 14:52:50.627011 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 14:52:50.627218 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 14:52:50.629856 (MainThread): Using postgres connection "master".
2022-10-06 14:52:50.629960 (MainThread): On master: BEGIN
2022-10-06 14:52:50.630048 (MainThread): Opening a new connection, currently in state init
2022-10-06 14:52:50.639023 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:50.639151 (MainThread): Using postgres connection "master".
2022-10-06 14:52:50.639248 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 14:52:50.663263 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 14:52:50.664385 (MainThread): On master: ROLLBACK
2022-10-06 14:52:50.664642 (MainThread): Using postgres connection "master".
2022-10-06 14:52:50.664745 (MainThread): On master: BEGIN
2022-10-06 14:52:50.665053 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 14:52:50.665188 (MainThread): On master: COMMIT
2022-10-06 14:52:50.665296 (MainThread): Using postgres connection "master".
2022-10-06 14:52:50.665390 (MainThread): On master: COMMIT
2022-10-06 14:52:50.665577 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:50.665698 (MainThread): On master: Close
2022-10-06 14:52:50.665929 (MainThread): 15:52:50 | Concurrency: 5 threads (target='dev')
2022-10-06 14:52:50.666059 (MainThread): 15:52:50 | 
2022-10-06 14:52:50.668206 (Thread-1): Began running node model.view_for_bi_guys.customer_cte
2022-10-06 14:52:50.668378 (Thread-2): Began running node model.view_for_bi_guys.orders_cte
2022-10-06 14:52:50.668593 (Thread-1): 15:52:50 | 1 of 3 START view model public.customer_cte.......................... [RUN]
2022-10-06 14:52:50.668773 (Thread-2): 15:52:50 | 2 of 3 START view model public.orders_cte............................ [RUN]
2022-10-06 14:52:50.669041 (Thread-1): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.669347 (Thread-2): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.669523 (Thread-1): Compiling model.view_for_bi_guys.customer_cte
2022-10-06 14:52:50.669652 (Thread-2): Compiling model.view_for_bi_guys.orders_cte
2022-10-06 14:52:50.670827 (Thread-1): Writing injected SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 14:52:50.671709 (Thread-2): Writing injected SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 14:52:50.672138 (Thread-1): finished collecting timing info
2022-10-06 14:52:50.672278 (Thread-2): finished collecting timing info
2022-10-06 14:52:50.689874 (Thread-1): Writing runtime SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 14:52:50.691732 (Thread-2): Writing runtime SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 14:52:50.692231 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.692368 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.692456 (Thread-1): On model.view_for_bi_guys.customer_cte: BEGIN
2022-10-06 14:52:50.692548 (Thread-2): On model.view_for_bi_guys.orders_cte: BEGIN
2022-10-06 14:52:50.692640 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 14:52:50.692727 (Thread-2): Opening a new connection, currently in state init
2022-10-06 14:52:50.701007 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:50.701134 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:50.701239 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.701343 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.701442 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 14:52:50.701544 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 14:52:50.706092 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 14:52:50.706312 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 14:52:50.710756 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.712126 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.712237 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 14:52:50.712337 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 14:52:50.712994 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:50.713097 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:50.714986 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.716236 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.716347 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 14:52:50.716439 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 14:52:50.716953 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:50.717051 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:50.721380 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 14:52:50.722382 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 14:52:50.722523 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.722618 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.722713 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 14:52:50.722796 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 14:52:50.723611 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:50.723715 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:50.726768 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:52:50.727666 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:52:50.727772 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 14:52:50.727863 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 14:52:50.729932 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 14:52:50.730637 (Thread-1): finished collecting timing info
2022-10-06 14:52:50.730748 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 14:52:50.730849 (Thread-1): On model.view_for_bi_guys.customer_cte: Close
2022-10-06 14:52:50.731486 (Thread-2): finished collecting timing info
2022-10-06 14:52:50.731630 (Thread-2): On model.view_for_bi_guys.orders_cte: Close
2022-10-06 14:52:50.731869 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f286481-1a3b-43ac-8dd2-c8081c8cc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9102d4ca0>]}
2022-10-06 14:52:50.732071 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f286481-1a3b-43ac-8dd2-c8081c8cc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9102fa310>]}
2022-10-06 14:52:50.732311 (Thread-1): 15:52:50 | 1 of 3 OK created view model public.customer_cte..................... [CREATE VIEW in 0.06s]
2022-10-06 14:52:50.732452 (Thread-1): Finished running node model.view_for_bi_guys.customer_cte
2022-10-06 14:52:50.732727 (Thread-2): 15:52:50 | 2 of 3 OK created view model public.orders_cte....................... [CREATE VIEW in 0.06s]
2022-10-06 14:52:50.732832 (Thread-2): Finished running node model.view_for_bi_guys.orders_cte
2022-10-06 14:52:50.733213 (Thread-4): Began running node model.view_for_bi_guys.referencing
2022-10-06 14:52:50.733410 (Thread-4): 15:52:50 | 3 of 3 START table model public.referencing.......................... [RUN]
2022-10-06 14:52:50.733612 (Thread-4): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.733715 (Thread-4): Compiling model.view_for_bi_guys.referencing
2022-10-06 14:52:50.735529 (Thread-4): Writing injected SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 14:52:50.736042 (Thread-4): finished collecting timing info
2022-10-06 14:52:50.748717 (Thread-4): Writing runtime SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 14:52:50.749124 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.749213 (Thread-4): On model.view_for_bi_guys.referencing: BEGIN
2022-10-06 14:52:50.749300 (Thread-4): Opening a new connection, currently in state init
2022-10-06 14:52:50.757596 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:50.757785 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.757871 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */


  create  table "postgres"."public"."referencing__dbt_tmp"
  as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.email,c.date_of_birth,c.current_job,o.order_name,o.order_qty,o.order_price
from customers c join orders o on o.order_id=c.order_id
  );
2022-10-06 14:52:50.760527 (Thread-4): SQL status: SELECT 3 in 0.00 seconds
2022-10-06 14:52:50.762061 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.762162 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing" rename to "referencing__dbt_backup"
2022-10-06 14:52:50.762706 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:50.763844 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.763942 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 14:52:50.764724 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:52:50.768139 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 14:52:50.768246 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.768328 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 14:52:50.768864 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:50.769674 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:52:50.769770 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
drop table if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 14:52:50.771885 (Thread-4): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 14:52:50.772938 (Thread-4): finished collecting timing info
2022-10-06 14:52:50.773070 (Thread-4): On model.view_for_bi_guys.referencing: Close
2022-10-06 14:52:50.773326 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f286481-1a3b-43ac-8dd2-c8081c8cc40e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe910209430>]}
2022-10-06 14:52:50.773543 (Thread-4): 15:52:50 | 3 of 3 OK created table model public.referencing..................... [SELECT 3 in 0.04s]
2022-10-06 14:52:50.773655 (Thread-4): Finished running node model.view_for_bi_guys.referencing
2022-10-06 14:52:50.774427 (MainThread): Acquiring new postgres connection "master".
2022-10-06 14:52:50.774562 (MainThread): Using postgres connection "master".
2022-10-06 14:52:50.774659 (MainThread): On master: BEGIN
2022-10-06 14:52:50.774752 (MainThread): Opening a new connection, currently in state closed
2022-10-06 14:52:50.783229 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:52:50.783340 (MainThread): On master: COMMIT
2022-10-06 14:52:50.783427 (MainThread): Using postgres connection "master".
2022-10-06 14:52:50.783503 (MainThread): On master: COMMIT
2022-10-06 14:52:50.783730 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:52:50.783823 (MainThread): On master: Close
2022-10-06 14:52:50.784021 (MainThread): 15:52:50 | 
2022-10-06 14:52:50.784124 (MainThread): 15:52:50 | Finished running 2 view models, 1 table model in 0.20s.
2022-10-06 14:52:50.784220 (MainThread): Connection 'master' was properly closed.
2022-10-06 14:52:50.784299 (MainThread): Connection 'model.view_for_bi_guys.customer_cte' was properly closed.
2022-10-06 14:52:50.784378 (MainThread): Connection 'model.view_for_bi_guys.orders_cte' was properly closed.
2022-10-06 14:52:50.784453 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 14:52:50.787314 (MainThread): 
2022-10-06 14:52:50.787458 (MainThread): Completed successfully
2022-10-06 14:52:50.787566 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 14:52:50.787744 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9102724f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f02e9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f02e9790>]}
2022-10-06 14:52:50.787912 (MainThread): Flushing usage events
2022-10-06 14:53:50.417777 (MainThread): Running with dbt=0.21.1
2022-10-06 14:53:50.486378 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 14:53:50.487599 (MainThread): Tracking: tracking
2022-10-06 14:53:50.506858 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb982683ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb982751a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb982751a00>]}
2022-10-06 14:53:50.515537 (MainThread): Partial parsing not enabled
2022-10-06 14:53:50.524361 (MainThread): Parsing macros/catalog.sql
2022-10-06 14:53:50.526978 (MainThread): Parsing macros/relations.sql
2022-10-06 14:53:50.528034 (MainThread): Parsing macros/adapters.sql
2022-10-06 14:53:50.544812 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 14:53:50.545969 (MainThread): Parsing macros/core.sql
2022-10-06 14:53:50.548497 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 14:53:50.553239 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 14:53:50.560175 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 14:53:50.561295 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 14:53:50.573247 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 14:53:50.599185 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 14:53:50.615976 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 14:53:50.617150 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 14:53:50.624459 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 14:53:50.639478 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 14:53:50.649783 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 14:53:50.655510 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 14:53:50.660859 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 14:53:50.663457 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 14:53:50.664429 (MainThread): Parsing macros/etc/query.sql
2022-10-06 14:53:50.665039 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 14:53:50.666053 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 14:53:50.672119 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 14:53:50.673314 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 14:53:50.674950 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 14:53:50.675994 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 14:53:50.717020 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 14:53:50.718127 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 14:53:50.718879 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 14:53:50.719755 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 14:53:50.832243 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:50.839974 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:50.841923 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:53:50.856928 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32cb2e0c-c770-4223-87c1-c6ecd61ae5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb97088c0d0>]}
2022-10-06 14:53:50.860030 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 14:53:50.860288 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32cb2e0c-c770-4223-87c1-c6ecd61ae5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb970868100>]}
2022-10-06 14:53:50.860442 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 14:53:50.861234 (MainThread): 
2022-10-06 14:53:50.861447 (MainThread): Acquiring new postgres connection "master".
2022-10-06 14:53:50.862088 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 14:53:50.869296 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 14:53:50.869480 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 14:53:50.869583 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 14:53:50.913479 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.04 seconds
2022-10-06 14:53:50.914969 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 14:53:50.915778 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 14:53:50.920218 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 14:53:50.920349 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 14:53:50.920460 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 14:53:50.929640 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:53:50.929755 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 14:53:50.929851 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 14:53:50.935192 (ThreadPoolExecutor-1_0): SQL status: SELECT 7 in 0.01 seconds
2022-10-06 14:53:50.936166 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 14:53:50.936452 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 14:53:50.939395 (MainThread): Using postgres connection "master".
2022-10-06 14:53:50.939516 (MainThread): On master: BEGIN
2022-10-06 14:53:50.939621 (MainThread): Opening a new connection, currently in state init
2022-10-06 14:53:50.948014 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:53:50.948127 (MainThread): Using postgres connection "master".
2022-10-06 14:53:50.948218 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 14:53:50.968801 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 14:53:50.969975 (MainThread): On master: ROLLBACK
2022-10-06 14:53:50.970226 (MainThread): Using postgres connection "master".
2022-10-06 14:53:50.970336 (MainThread): On master: BEGIN
2022-10-06 14:53:50.970649 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 14:53:50.970771 (MainThread): On master: COMMIT
2022-10-06 14:53:50.970874 (MainThread): Using postgres connection "master".
2022-10-06 14:53:50.970968 (MainThread): On master: COMMIT
2022-10-06 14:53:50.971168 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:53:50.971284 (MainThread): On master: Close
2022-10-06 14:53:50.971514 (MainThread): 15:53:50 | Concurrency: 5 threads (target='dev')
2022-10-06 14:53:50.971650 (MainThread): 15:53:50 | 
2022-10-06 14:53:50.973768 (Thread-1): Began running node model.view_for_bi_guys.customer_cte
2022-10-06 14:53:50.973963 (Thread-2): Began running node model.view_for_bi_guys.orders_cte
2022-10-06 14:53:50.974201 (Thread-1): 15:53:50 | 1 of 3 START view model public.customer_cte.......................... [RUN]
2022-10-06 14:53:50.974402 (Thread-2): 15:53:50 | 2 of 3 START view model public.orders_cte............................ [RUN]
2022-10-06 14:53:50.974744 (Thread-1): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:50.974995 (Thread-2): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:50.975170 (Thread-1): Compiling model.view_for_bi_guys.customer_cte
2022-10-06 14:53:50.975290 (Thread-2): Compiling model.view_for_bi_guys.orders_cte
2022-10-06 14:53:50.976433 (Thread-1): Writing injected SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 14:53:50.977398 (Thread-2): Writing injected SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 14:53:50.977879 (Thread-1): finished collecting timing info
2022-10-06 14:53:50.978042 (Thread-2): finished collecting timing info
2022-10-06 14:53:50.996446 (Thread-1): Writing runtime SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 14:53:50.997848 (Thread-2): Writing runtime SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 14:53:50.998232 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:50.998355 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:50.998455 (Thread-1): On model.view_for_bi_guys.customer_cte: BEGIN
2022-10-06 14:53:50.998551 (Thread-2): On model.view_for_bi_guys.orders_cte: BEGIN
2022-10-06 14:53:50.998646 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 14:53:50.998733 (Thread-2): Opening a new connection, currently in state init
2022-10-06 14:53:51.007094 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:53:51.007245 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:53:51.007370 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:51.007470 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:51.007565 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from orders
)
select * from orders
  );

2022-10-06 14:53:51.007658 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from customers 
)
select * from customer_cte
  );

2022-10-06 14:53:51.009415 (Thread-2): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 14:53:51.009511 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2022-10-06 14:53:51.013909 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:51.015267 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:51.015381 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 14:53:51.015475 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 14:53:51.016056 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:53:51.016155 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:53:51.018031 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:51.019356 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:51.019510 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 14:53:51.019610 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 14:53:51.020525 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:53:51.020640 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:53:51.025140 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 14:53:51.025853 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 14:53:51.025961 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:51.026058 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:51.026142 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 14:53:51.026225 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 14:53:51.026932 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:53:51.027029 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:53:51.029935 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 14:53:51.030819 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 14:53:51.030925 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 14:53:51.031015 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 14:53:51.032731 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 14:53:51.033454 (Thread-2): finished collecting timing info
2022-10-06 14:53:51.033568 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 14:53:51.033669 (Thread-2): On model.view_for_bi_guys.orders_cte: Close
2022-10-06 14:53:51.034301 (Thread-1): finished collecting timing info
2022-10-06 14:53:51.034450 (Thread-1): On model.view_for_bi_guys.customer_cte: Close
2022-10-06 14:53:51.034702 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32cb2e0c-c770-4223-87c1-c6ecd61ae5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9708a9ac0>]}
2022-10-06 14:53:51.034909 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32cb2e0c-c770-4223-87c1-c6ecd61ae5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9708caee0>]}
2022-10-06 14:53:51.035160 (Thread-2): 15:53:51 | 2 of 3 OK created view model public.orders_cte....................... [CREATE VIEW in 0.06s]
2022-10-06 14:53:51.035332 (Thread-1): 15:53:51 | 1 of 3 OK created view model public.customer_cte..................... [CREATE VIEW in 0.06s]
2022-10-06 14:53:51.035452 (Thread-2): Finished running node model.view_for_bi_guys.orders_cte
2022-10-06 14:53:51.035583 (Thread-1): Finished running node model.view_for_bi_guys.customer_cte
2022-10-06 14:53:51.036103 (Thread-4): Began running node model.view_for_bi_guys.referencing
2022-10-06 14:53:51.036296 (Thread-4): 15:53:51 | 3 of 3 START table model public.referencing.......................... [RUN]
2022-10-06 14:53:51.036493 (Thread-4): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:53:51.036591 (Thread-4): Compiling model.view_for_bi_guys.referencing
2022-10-06 14:53:51.038609 (Thread-4): Writing injected SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 14:53:51.038973 (Thread-4): finished collecting timing info
2022-10-06 14:53:51.051740 (Thread-4): Writing runtime SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 14:53:51.052268 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:53:51.052395 (Thread-4): On model.view_for_bi_guys.referencing: BEGIN
2022-10-06 14:53:51.052511 (Thread-4): Opening a new connection, currently in state init
2022-10-06 14:53:51.061781 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:53:51.061914 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:53:51.062004 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */


  create  table "postgres"."public"."referencing__dbt_tmp"
  as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.email,c.date_of_birth,c.current_job,o.order_name,o.order_qty,o.order_price
from customers c join orders o on o.order_id=c.order_id
  );
2022-10-06 14:53:51.067195 (Thread-4): SQL status: SELECT 3 in 0.01 seconds
2022-10-06 14:53:51.068930 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:53:51.069083 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 14:53:51.069971 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 14:53:51.073831 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 14:53:51.073959 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:53:51.074054 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 14:53:51.075043 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:53:51.076057 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 14:53:51.076160 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
drop table if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 14:53:51.076552 (Thread-4): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 14:53:51.077260 (Thread-4): finished collecting timing info
2022-10-06 14:53:51.077390 (Thread-4): On model.view_for_bi_guys.referencing: Close
2022-10-06 14:53:51.077649 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32cb2e0c-c770-4223-87c1-c6ecd61ae5e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9708974f0>]}
2022-10-06 14:53:51.077878 (Thread-4): 15:53:51 | 3 of 3 OK created table model public.referencing..................... [SELECT 3 in 0.04s]
2022-10-06 14:53:51.077998 (Thread-4): Finished running node model.view_for_bi_guys.referencing
2022-10-06 14:53:51.078744 (MainThread): Acquiring new postgres connection "master".
2022-10-06 14:53:51.078874 (MainThread): Using postgres connection "master".
2022-10-06 14:53:51.078968 (MainThread): On master: BEGIN
2022-10-06 14:53:51.079060 (MainThread): Opening a new connection, currently in state closed
2022-10-06 14:53:51.087551 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 14:53:51.087750 (MainThread): On master: COMMIT
2022-10-06 14:53:51.087851 (MainThread): Using postgres connection "master".
2022-10-06 14:53:51.087943 (MainThread): On master: COMMIT
2022-10-06 14:53:51.088145 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 14:53:51.088273 (MainThread): On master: Close
2022-10-06 14:53:51.088663 (MainThread): 15:53:51 | 
2022-10-06 14:53:51.088792 (MainThread): 15:53:51 | Finished running 2 view models, 1 table model in 0.23s.
2022-10-06 14:53:51.088908 (MainThread): Connection 'master' was properly closed.
2022-10-06 14:53:51.088990 (MainThread): Connection 'model.view_for_bi_guys.customer_cte' was properly closed.
2022-10-06 14:53:51.089068 (MainThread): Connection 'model.view_for_bi_guys.orders_cte' was properly closed.
2022-10-06 14:53:51.089144 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 14:53:51.092041 (MainThread): 
2022-10-06 14:53:51.092174 (MainThread): Completed successfully
2022-10-06 14:53:51.092277 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 14:53:51.092431 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb9708684c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb970840190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb970840af0>]}
2022-10-06 14:53:51.092590 (MainThread): Flushing usage events
2022-10-06 17:56:21.028372 (MainThread): Running with dbt=0.21.1
2022-10-06 17:56:21.106701 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 17:56:21.110015 (MainThread): Tracking: tracking
2022-10-06 17:56:21.137197 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e26c4c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e2782430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e2782640>]}
2022-10-06 17:56:21.146172 (MainThread): Partial parsing not enabled
2022-10-06 17:56:21.149599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e278e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e2782280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97e2782fa0>]}
2022-10-06 17:56:21.149791 (MainThread): Flushing usage events
2022-10-06 17:56:22.920250 (MainThread): Encountered an error:
2022-10-06 17:56:22.920863 (MainThread): Compilation Error
  The schema file at models/staging/src.yml is invalid because the value of 'sources' is not a list
2022-10-06 17:56:22.925139 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/staging/src.yml is invalid because the value of 'sources' is not a list

2022-10-06 17:56:48.318637 (MainThread): Running with dbt=0.21.1
2022-10-06 17:56:48.388151 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 17:56:48.389684 (MainThread): Tracking: tracking
2022-10-06 17:56:48.417265 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff709eebbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff709ef7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff709faa1f0>]}
2022-10-06 17:56:48.426025 (MainThread): Partial parsing not enabled
2022-10-06 17:56:48.429371 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff709fb1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff709fac130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff709fac460>]}
2022-10-06 17:56:48.429561 (MainThread): Flushing usage events
2022-10-06 17:56:49.620597 (MainThread): Encountered an error:
2022-10-06 17:56:49.621258 (MainThread): Compilation Error
  The schema file at models/staging/src.yml is invalid because the value of 'sources' is not a list
2022-10-06 17:56:49.625900 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/staging/src.yml is invalid because the value of 'sources' is not a list

2022-10-06 17:58:05.263312 (MainThread): Running with dbt=0.21.1
2022-10-06 17:58:05.338307 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 17:58:05.339846 (MainThread): Tracking: tracking
2022-10-06 17:58:05.368085 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff632b53b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6000bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6000bb370>]}
2022-10-06 17:58:05.384311 (MainThread): Partial parsing not enabled
2022-10-06 17:58:05.395355 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6000c7fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6000bb0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff6000bb3d0>]}
2022-10-06 17:58:05.411896 (MainThread): Flushing usage events
2022-10-06 17:58:06.951575 (MainThread): Encountered an error:
2022-10-06 17:58:06.952774 (MainThread): Compilation Error
  The schema file at models/staging/src.yml is invalid because the value of 'sources' is not a list
2022-10-06 17:58:06.956091 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/staging/src.yml is invalid because the value of 'sources' is not a list

2022-10-06 17:58:26.802575 (MainThread): Running with dbt=0.21.1
2022-10-06 17:58:26.873645 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 17:58:26.875254 (MainThread): Tracking: tracking
2022-10-06 17:58:26.899814 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5238bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5245abe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5245aa00>]}
2022-10-06 17:58:26.908262 (MainThread): Partial parsing not enabled
2022-10-06 17:58:26.911329 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce52457c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5245a3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fce5245af40>]}
2022-10-06 17:58:26.911508 (MainThread): Flushing usage events
2022-10-06 17:58:28.576242 (MainThread): Encountered an error:
2022-10-06 17:58:28.577890 (MainThread): Compilation Error
  Error reading view_for_bi_guys: staging/src.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   schema: public
    5  |   tables:
    6  |     - name: orders
    7  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3
2022-10-06 17:58:28.584814 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 3, column 3
did not find expected '-' indicator
  in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 4
  ------------------------------
  1  | version: 2
  2  | sources:
  3  |   - name: our_source 
  4  |   schema: public
  5  |   tables:
  6  |     - name: orders
  7  |     - name: customers
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 3, column 3
  did not find expected '-' indicator
    in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading view_for_bi_guys: staging/src.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   schema: public
    5  |   tables:
    6  |     - name: orders
    7  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3

2022-10-06 17:59:35.773427 (MainThread): Running with dbt=0.21.1
2022-10-06 17:59:35.844373 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 17:59:35.846018 (MainThread): Tracking: tracking
2022-10-06 17:59:35.865665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3b29c5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a00bae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a00ba1c0>]}
2022-10-06 17:59:35.874717 (MainThread): Partial parsing not enabled
2022-10-06 17:59:35.877577 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a00c5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a00bab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3a00baf10>]}
2022-10-06 17:59:35.877760 (MainThread): Flushing usage events
2022-10-06 17:59:37.930734 (MainThread): Encountered an error:
2022-10-06 17:59:37.931437 (MainThread): Compilation Error
  Error reading view_for_bi_guys: src.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   schema: public
    5  |   tables:
    6  |     - name: orders
    7  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3
2022-10-06 17:59:37.937651 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 3, column 3
did not find expected '-' indicator
  in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 4
  ------------------------------
  1  | version: 2
  2  | sources:
  3  |   - name: our_source 
  4  |   schema: public
  5  |   tables:
  6  |     - name: orders
  7  |     - name: customers
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 3, column 3
  did not find expected '-' indicator
    in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading view_for_bi_guys: src.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   schema: public
    5  |   tables:
    6  |     - name: orders
    7  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3

2022-10-06 18:00:16.199524 (MainThread): Running with dbt=0.21.1
2022-10-06 18:00:16.268246 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 18:00:16.271736 (MainThread): Tracking: tracking
2022-10-06 18:00:16.292347 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48a99cc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48aa671c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48aa67070>]}
2022-10-06 18:00:16.300998 (MainThread): Partial parsing not enabled
2022-10-06 18:00:16.308920 (MainThread): Parsing macros/catalog.sql
2022-10-06 18:00:16.311622 (MainThread): Parsing macros/relations.sql
2022-10-06 18:00:16.312684 (MainThread): Parsing macros/adapters.sql
2022-10-06 18:00:16.329204 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 18:00:16.330367 (MainThread): Parsing macros/core.sql
2022-10-06 18:00:16.332962 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 18:00:16.337652 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 18:00:16.344417 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 18:00:16.345536 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 18:00:16.357469 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 18:00:16.383400 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 18:00:16.399948 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 18:00:16.401118 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 18:00:16.408390 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 18:00:16.423422 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 18:00:16.433700 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 18:00:16.439393 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 18:00:16.444712 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 18:00:16.447285 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 18:00:16.448248 (MainThread): Parsing macros/etc/query.sql
2022-10-06 18:00:16.448857 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 18:00:16.449859 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 18:00:16.455880 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 18:00:16.457062 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 18:00:16.458663 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 18:00:16.459697 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 18:00:16.500701 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 18:00:16.501799 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 18:00:16.502548 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 18:00:16.503408 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 18:00:16.619381 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.view_for_bi_guys.marts
- models.view_for_bi_guys.staging

2022-10-06 18:00:16.622766 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c272daac-76ef-4469-b499-c726f3f32171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48ab4d0d0>]}
2022-10-06 18:00:16.626061 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 18:00:16.626397 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c272daac-76ef-4469-b499-c726f3f32171', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48ab4d520>]}
2022-10-06 18:00:16.626606 (MainThread): Found 0 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2022-10-06 18:00:16.627432 (MainThread): 
WARNING: Nothing to do. Try checking your model configs and model specification args
2022-10-06 18:00:16.630275 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48ab1a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48aa66c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb48ab4da00>]}
2022-10-06 18:00:16.630497 (MainThread): Flushing usage events
2022-10-06 18:00:48.604588 (MainThread): Running with dbt=0.21.1
2022-10-06 18:00:48.679848 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 18:00:48.687336 (MainThread): Tracking: tracking
2022-10-06 18:00:48.714077 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c826fbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c827bb550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c827bba00>]}
2022-10-06 18:00:48.723256 (MainThread): Partial parsing not enabled
2022-10-06 18:00:48.726399 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c827c8190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c827c3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c827c3eb0>]}
2022-10-06 18:00:48.726585 (MainThread): Flushing usage events
2022-10-06 18:00:49.981696 (MainThread): Encountered an error:
2022-10-06 18:00:49.982689 (MainThread): Compilation Error
  Error reading view_for_bi_guys: src.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   schema: public
    5  |   tables:
    6  |     - name: orders
    7  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3
2022-10-06 18:00:49.990140 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 3, column 3
did not find expected '-' indicator
  in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 4
  ------------------------------
  1  | version: 2
  2  | sources:
  3  |   - name: our_source 
  4  |   schema: public
  5  |   tables:
  6  |     - name: orders
  7  |     - name: customers
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 3, column 3
  did not find expected '-' indicator
    in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading view_for_bi_guys: src.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   schema: public
    5  |   tables:
    6  |     - name: orders
    7  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3

2022-10-06 18:04:07.485437 (MainThread): Running with dbt=0.21.1
2022-10-06 18:04:07.554507 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 18:04:07.556116 (MainThread): Tracking: tracking
2022-10-06 18:04:07.580059 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452b4cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452b563d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452c0a1f0>]}
2022-10-06 18:04:07.588999 (MainThread): Partial parsing not enabled
2022-10-06 18:04:07.592052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452c11190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452c0c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452c0ccd0>]}
2022-10-06 18:04:07.592243 (MainThread): Flushing usage events
2022-10-06 18:04:09.307779 (MainThread): Encountered an error:
2022-10-06 18:04:09.308450 (MainThread): Compilation Error
  Error reading view_for_bi_guys: sources.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   tables:
    5  |     - name: orders
    6  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3
2022-10-06 18:04:09.315981 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 890, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 774, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 853, in yaml._yaml.CParser._compose_sequence_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block collection
  in "<unicode string>", line 3, column 3
did not find expected '-' indicator
  in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 4
  ------------------------------
  1  | version: 2
  2  | sources:
  3  |   - name: our_source 
  4  |   tables:
  5  |     - name: orders
  6  |     - name: customers
  
  Raw Error:
  ------------------------------
  while parsing a block collection
    in "<unicode string>", line 3, column 3
  did not find expected '-' indicator
    in "<unicode string>", line 4, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading view_for_bi_guys: sources.yml - Runtime Error
    Syntax error near line 4
    ------------------------------
    1  | version: 2
    2  | sources:
    3  |   - name: our_source 
    4  |   tables:
    5  |     - name: orders
    6  |     - name: customers
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 3, column 3
    did not find expected '-' indicator
      in "<unicode string>", line 4, column 3

2022-10-06 18:05:11.230913 (MainThread): Running with dbt=0.21.1
2022-10-06 18:05:11.299622 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 18:05:11.301268 (MainThread): Tracking: tracking
2022-10-06 18:05:11.324977 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792363be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb79236e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792424e20>]}
2022-10-06 18:05:11.334280 (MainThread): Partial parsing not enabled
2022-10-06 18:05:11.343447 (MainThread): Parsing macros/catalog.sql
2022-10-06 18:05:11.346198 (MainThread): Parsing macros/relations.sql
2022-10-06 18:05:11.347281 (MainThread): Parsing macros/adapters.sql
2022-10-06 18:05:11.363657 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 18:05:11.364796 (MainThread): Parsing macros/core.sql
2022-10-06 18:05:11.367263 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 18:05:11.372234 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 18:05:11.379520 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 18:05:11.380688 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 18:05:11.392523 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 18:05:11.418900 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 18:05:11.435334 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 18:05:11.436502 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 18:05:11.443831 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 18:05:11.458696 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 18:05:11.468839 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 18:05:11.474711 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 18:05:11.480111 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 18:05:11.482663 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 18:05:11.483631 (MainThread): Parsing macros/etc/query.sql
2022-10-06 18:05:11.484240 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 18:05:11.485242 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 18:05:11.491189 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 18:05:11.492376 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 18:05:11.493960 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 18:05:11.494978 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 18:05:11.535061 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 18:05:11.536145 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 18:05:11.536887 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 18:05:11.537741 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 18:05:11.649341 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:11.657597 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:11.660081 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:11.686360 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '290eab4c-8507-4c06-955d-25a8bdcffb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792496e20>]}
2022-10-06 18:05:11.689229 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 18:05:11.689500 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '290eab4c-8507-4c06-955d-25a8bdcffb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7924d6130>]}
2022-10-06 18:05:11.689663 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 18:05:11.690506 (MainThread): 
2022-10-06 18:05:11.690717 (MainThread): Acquiring new postgres connection "master".
2022-10-06 18:05:11.691360 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 18:05:11.697454 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 18:05:11.697585 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 18:05:11.697685 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 18:05:11.805076 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.11 seconds
2022-10-06 18:05:11.807084 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 18:05:11.808011 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 18:05:11.812731 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 18:05:11.812866 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 18:05:11.812981 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 18:05:11.823019 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:11.823159 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 18:05:11.823270 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 18:05:11.831922 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2022-10-06 18:05:11.832955 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 18:05:11.833249 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 18:05:11.836491 (MainThread): Using postgres connection "master".
2022-10-06 18:05:11.836622 (MainThread): On master: BEGIN
2022-10-06 18:05:11.836739 (MainThread): Opening a new connection, currently in state init
2022-10-06 18:05:11.846366 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:11.846506 (MainThread): Using postgres connection "master".
2022-10-06 18:05:11.846616 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 18:05:11.876273 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 18:05:11.877489 (MainThread): On master: ROLLBACK
2022-10-06 18:05:11.877764 (MainThread): Using postgres connection "master".
2022-10-06 18:05:11.877883 (MainThread): On master: BEGIN
2022-10-06 18:05:11.878211 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 18:05:11.878353 (MainThread): On master: COMMIT
2022-10-06 18:05:11.878463 (MainThread): Using postgres connection "master".
2022-10-06 18:05:11.878568 (MainThread): On master: COMMIT
2022-10-06 18:05:11.878781 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:05:11.878910 (MainThread): On master: Close
2022-10-06 18:05:11.879164 (MainThread): 19:05:11 | Concurrency: 5 threads (target='dev')
2022-10-06 18:05:11.879311 (MainThread): 19:05:11 | 
2022-10-06 18:05:11.881815 (Thread-1): Began running node model.view_for_bi_guys.customer_cte
2022-10-06 18:05:11.882027 (Thread-2): Began running node model.view_for_bi_guys.orders_cte
2022-10-06 18:05:11.882315 (Thread-1): 19:05:11 | 1 of 3 START view model public.customer_cte.......................... [RUN]
2022-10-06 18:05:11.882542 (Thread-2): 19:05:11 | 2 of 3 START view model public.orders_cte............................ [RUN]
2022-10-06 18:05:11.882879 (Thread-1): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:11.883210 (Thread-2): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:11.883389 (Thread-1): Compiling model.view_for_bi_guys.customer_cte
2022-10-06 18:05:11.883574 (Thread-2): Compiling model.view_for_bi_guys.orders_cte
2022-10-06 18:05:11.885897 (Thread-1): Writing injected SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 18:05:11.887797 (Thread-2): Writing injected SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 18:05:11.888595 (Thread-2): finished collecting timing info
2022-10-06 18:05:11.895058 (Thread-1): finished collecting timing info
2022-10-06 18:05:11.910619 (Thread-1): Writing runtime SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 18:05:11.911277 (Thread-2): Writing runtime SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 18:05:11.911715 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:11.911865 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:11.911954 (Thread-2): On model.view_for_bi_guys.orders_cte: BEGIN
2022-10-06 18:05:11.912051 (Thread-1): On model.view_for_bi_guys.customer_cte: BEGIN
2022-10-06 18:05:11.912149 (Thread-2): Opening a new connection, currently in state init
2022-10-06 18:05:11.912234 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 18:05:11.920456 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:11.920614 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:11.920742 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:11.920843 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:11.920938 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from "postgres"."our_source"."orders" 
)
select * from orders
  );

2022-10-06 18:05:11.921032 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from "postgres"."our_source"."customers" 
)
select * from customer_cte
  );

2022-10-06 18:05:11.922343 (Thread-1): Postgres error: relation "our_source.customers" does not exist
LINE 5:     select * from "postgres"."our_source"."customers" 
                          ^

2022-10-06 18:05:11.922437 (Thread-2): Postgres error: relation "our_source.orders" does not exist
LINE 5:     select * from "postgres"."our_source"."orders" 
                          ^

2022-10-06 18:05:11.922527 (Thread-1): On model.view_for_bi_guys.customer_cte: ROLLBACK
2022-10-06 18:05:11.922618 (Thread-2): On model.view_for_bi_guys.orders_cte: ROLLBACK
2022-10-06 18:05:11.923077 (Thread-1): finished collecting timing info
2022-10-06 18:05:11.923209 (Thread-2): finished collecting timing info
2022-10-06 18:05:11.923313 (Thread-1): On model.view_for_bi_guys.customer_cte: Close
2022-10-06 18:05:11.923411 (Thread-2): On model.view_for_bi_guys.orders_cte: Close
2022-10-06 18:05:11.924001 (Thread-2): Database Error in model orders_cte (models/staging/orders_cte.sql)
  relation "our_source.orders" does not exist
  LINE 5:     select * from "postgres"."our_source"."orders" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/orders_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "our_source.orders" does not exist
LINE 5:     select * from "postgres"."our_source"."orders" 
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model orders_cte (models/staging/orders_cte.sql)
  relation "our_source.orders" does not exist
  LINE 5:     select * from "postgres"."our_source"."orders" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/orders_cte.sql
2022-10-06 18:05:11.923661 (Thread-1): Database Error in model customer_cte (models/staging/customer_cte.sql)
  relation "our_source.customers" does not exist
  LINE 5:     select * from "postgres"."our_source"."customers" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/customer_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "our_source.customers" does not exist
LINE 5:     select * from "postgres"."our_source"."customers" 
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_cte (models/staging/customer_cte.sql)
  relation "our_source.customers" does not exist
  LINE 5:     select * from "postgres"."our_source"."customers" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/customer_cte.sql
2022-10-06 18:05:11.928295 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '290eab4c-8507-4c06-955d-25a8bdcffb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb770575250>]}
2022-10-06 18:05:11.928452 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '290eab4c-8507-4c06-955d-25a8bdcffb38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb7705750a0>]}
2022-10-06 18:05:11.928755 (Thread-2): 19:05:11 | 2 of 3 ERROR creating view model public.orders_cte................... [ERROR in 0.05s]
2022-10-06 18:05:11.928980 (Thread-1): 19:05:11 | 1 of 3 ERROR creating view model public.customer_cte................. [ERROR in 0.05s]
2022-10-06 18:05:11.929128 (Thread-2): Finished running node model.view_for_bi_guys.orders_cte
2022-10-06 18:05:11.929402 (Thread-1): Finished running node model.view_for_bi_guys.customer_cte
2022-10-06 18:05:11.929764 (Thread-4): Began running node model.view_for_bi_guys.referencing
2022-10-06 18:05:11.929951 (Thread-4): 19:05:11 | 3 of 3 SKIP relation public.referencing.............................. [SKIP]
2022-10-06 18:05:11.930107 (Thread-4): Finished running node model.view_for_bi_guys.referencing
2022-10-06 18:05:11.930772 (MainThread): Acquiring new postgres connection "master".
2022-10-06 18:05:11.930920 (MainThread): Using postgres connection "master".
2022-10-06 18:05:11.931009 (MainThread): On master: BEGIN
2022-10-06 18:05:11.931107 (MainThread): Opening a new connection, currently in state closed
2022-10-06 18:05:11.940083 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:11.940247 (MainThread): On master: COMMIT
2022-10-06 18:05:11.940344 (MainThread): Using postgres connection "master".
2022-10-06 18:05:11.940432 (MainThread): On master: COMMIT
2022-10-06 18:05:11.940648 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:05:11.940752 (MainThread): On master: Close
2022-10-06 18:05:11.941009 (MainThread): 19:05:11 | 
2022-10-06 18:05:11.941127 (MainThread): 19:05:11 | Finished running 2 view models, 1 table model in 0.25s.
2022-10-06 18:05:11.941231 (MainThread): Connection 'master' was properly closed.
2022-10-06 18:05:11.941316 (MainThread): Connection 'model.view_for_bi_guys.customer_cte' was properly closed.
2022-10-06 18:05:11.941400 (MainThread): Connection 'model.view_for_bi_guys.orders_cte' was properly closed.
2022-10-06 18:05:11.944761 (MainThread): 
2022-10-06 18:05:11.944890 (MainThread): Completed with 2 errors and 0 warnings:
2022-10-06 18:05:11.944990 (MainThread): 
2022-10-06 18:05:11.945084 (MainThread): Database Error in model orders_cte (models/staging/orders_cte.sql)
2022-10-06 18:05:11.945176 (MainThread):   relation "our_source.orders" does not exist
2022-10-06 18:05:11.945262 (MainThread):   LINE 5:     select * from "postgres"."our_source"."orders" 
2022-10-06 18:05:11.945346 (MainThread):                             ^
2022-10-06 18:05:11.945429 (MainThread):   compiled SQL at target/run/view_for_bi_guys/models/staging/orders_cte.sql
2022-10-06 18:05:11.945514 (MainThread): 
2022-10-06 18:05:11.945604 (MainThread): Database Error in model customer_cte (models/staging/customer_cte.sql)
2022-10-06 18:05:11.945689 (MainThread):   relation "our_source.customers" does not exist
2022-10-06 18:05:11.945771 (MainThread):   LINE 5:     select * from "postgres"."our_source"."customers" 
2022-10-06 18:05:11.945853 (MainThread):                             ^
2022-10-06 18:05:11.945935 (MainThread):   compiled SQL at target/run/view_for_bi_guys/models/staging/customer_cte.sql
2022-10-06 18:05:11.946024 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2022-10-06 18:05:11.946181 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb770586b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb770586bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb792506a00>]}
2022-10-06 18:05:11.946343 (MainThread): Flushing usage events
2022-10-06 18:05:54.693750 (MainThread): Running with dbt=0.21.1
2022-10-06 18:05:54.764022 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 18:05:54.766849 (MainThread): Tracking: tracking
2022-10-06 18:05:54.789585 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd562c14ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd562cd38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd562cd3d00>]}
2022-10-06 18:05:54.798227 (MainThread): Partial parsing not enabled
2022-10-06 18:05:54.807055 (MainThread): Parsing macros/catalog.sql
2022-10-06 18:05:54.809688 (MainThread): Parsing macros/relations.sql
2022-10-06 18:05:54.810785 (MainThread): Parsing macros/adapters.sql
2022-10-06 18:05:54.827186 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 18:05:54.828339 (MainThread): Parsing macros/core.sql
2022-10-06 18:05:54.830852 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 18:05:54.835573 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 18:05:54.842462 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 18:05:54.843583 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 18:05:54.855441 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 18:05:54.881396 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 18:05:54.898045 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 18:05:54.899222 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 18:05:54.906499 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 18:05:54.921539 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 18:05:54.931830 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 18:05:54.937534 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 18:05:54.942871 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 18:05:54.945457 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 18:05:54.946432 (MainThread): Parsing macros/etc/query.sql
2022-10-06 18:05:54.947045 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 18:05:54.948053 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 18:05:54.954079 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 18:05:54.955269 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 18:05:54.956879 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 18:05:54.957911 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 18:05:54.998948 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 18:05:55.000052 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 18:05:55.000800 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 18:05:55.001663 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 18:05:55.113667 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.121908 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.124367 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.149421 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bc1148c-5676-4e47-aa5c-3e910baf3c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd55005bfd0>]}
2022-10-06 18:05:55.152781 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 18:05:55.153071 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bc1148c-5676-4e47-aa5c-3e910baf3c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd562cd69d0>]}
2022-10-06 18:05:55.153234 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 18:05:55.154050 (MainThread): 
2022-10-06 18:05:55.154267 (MainThread): Acquiring new postgres connection "master".
2022-10-06 18:05:55.154905 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 18:05:55.160900 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 18:05:55.161013 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 18:05:55.161109 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 18:05:55.218780 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.06 seconds
2022-10-06 18:05:55.220461 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 18:05:55.221255 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 18:05:55.225479 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 18:05:55.225616 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 18:05:55.225719 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 18:05:55.235081 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:55.235203 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 18:05:55.235299 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 18:05:55.240506 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2022-10-06 18:05:55.241507 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 18:05:55.241796 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 18:05:55.244865 (MainThread): Using postgres connection "master".
2022-10-06 18:05:55.244990 (MainThread): On master: BEGIN
2022-10-06 18:05:55.245095 (MainThread): Opening a new connection, currently in state init
2022-10-06 18:05:55.254587 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:55.254706 (MainThread): Using postgres connection "master".
2022-10-06 18:05:55.254801 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 18:05:55.279931 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 18:05:55.281193 (MainThread): On master: ROLLBACK
2022-10-06 18:05:55.281457 (MainThread): Using postgres connection "master".
2022-10-06 18:05:55.281577 (MainThread): On master: BEGIN
2022-10-06 18:05:55.281902 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 18:05:55.282040 (MainThread): On master: COMMIT
2022-10-06 18:05:55.282153 (MainThread): Using postgres connection "master".
2022-10-06 18:05:55.282257 (MainThread): On master: COMMIT
2022-10-06 18:05:55.282475 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:05:55.282607 (MainThread): On master: Close
2022-10-06 18:05:55.282863 (MainThread): 19:05:55 | Concurrency: 5 threads (target='dev')
2022-10-06 18:05:55.283011 (MainThread): 19:05:55 | 
2022-10-06 18:05:55.285307 (Thread-1): Began running node model.view_for_bi_guys.customer_cte
2022-10-06 18:05:55.285519 (Thread-2): Began running node model.view_for_bi_guys.orders_cte
2022-10-06 18:05:55.285776 (Thread-1): 19:05:55 | 1 of 3 START view model public.customer_cte.......................... [RUN]
2022-10-06 18:05:55.285984 (Thread-2): 19:05:55 | 2 of 3 START view model public.orders_cte............................ [RUN]
2022-10-06 18:05:55.286288 (Thread-1): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.286598 (Thread-2): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.286785 (Thread-1): Compiling model.view_for_bi_guys.customer_cte
2022-10-06 18:05:55.286918 (Thread-2): Compiling model.view_for_bi_guys.orders_cte
2022-10-06 18:05:55.288908 (Thread-1): Writing injected SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 18:05:55.291007 (Thread-2): Writing injected SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 18:05:55.291721 (Thread-2): finished collecting timing info
2022-10-06 18:05:55.291893 (Thread-1): finished collecting timing info
2022-10-06 18:05:55.312406 (Thread-1): Writing runtime SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 18:05:55.313601 (Thread-2): Writing runtime SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 18:05:55.313974 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.314104 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.314200 (Thread-1): On model.view_for_bi_guys.customer_cte: BEGIN
2022-10-06 18:05:55.314298 (Thread-2): On model.view_for_bi_guys.orders_cte: BEGIN
2022-10-06 18:05:55.314395 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 18:05:55.314482 (Thread-2): Opening a new connection, currently in state init
2022-10-06 18:05:55.324123 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:55.324282 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:55.324417 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.324528 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.324629 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from "postgres"."public"."orders" 
)
select * from orders
  );

2022-10-06 18:05:55.324729 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from "postgres"."public"."customers" 
)
select * from customer_cte
  );

2022-10-06 18:05:55.332485 (Thread-2): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 18:05:55.332688 (Thread-1): SQL status: CREATE VIEW in 0.01 seconds
2022-10-06 18:05:55.337164 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.338665 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.338791 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte" rename to "orders_cte__dbt_backup"
2022-10-06 18:05:55.338897 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte" rename to "customer_cte__dbt_backup"
2022-10-06 18:05:55.340573 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 18:05:55.340678 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 18:05:55.341973 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.343280 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.343398 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
alter table "postgres"."public"."orders_cte__dbt_tmp" rename to "orders_cte"
2022-10-06 18:05:55.343497 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
alter table "postgres"."public"."customer_cte__dbt_tmp" rename to "customer_cte"
2022-10-06 18:05:55.344022 (Thread-2): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 18:05:55.344125 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 18:05:55.348638 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 18:05:55.349389 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 18:05:55.349502 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.349601 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.349692 (Thread-2): On model.view_for_bi_guys.orders_cte: COMMIT
2022-10-06 18:05:55.349787 (Thread-1): On model.view_for_bi_guys.customer_cte: COMMIT
2022-10-06 18:05:55.351136 (Thread-1): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:05:55.351237 (Thread-2): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:05:55.354287 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:05:55.355237 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:05:55.355347 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */
drop view if exists "postgres"."public"."customer_cte__dbt_backup" cascade
2022-10-06 18:05:55.355446 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */
drop view if exists "postgres"."public"."orders_cte__dbt_backup" cascade
2022-10-06 18:05:55.358621 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 18:05:55.358721 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2022-10-06 18:05:55.359427 (Thread-2): finished collecting timing info
2022-10-06 18:05:55.360086 (Thread-1): finished collecting timing info
2022-10-06 18:05:55.360211 (Thread-2): On model.view_for_bi_guys.orders_cte: Close
2022-10-06 18:05:55.360319 (Thread-1): On model.view_for_bi_guys.customer_cte: Close
2022-10-06 18:05:55.360602 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc1148c-5676-4e47-aa5c-3e910baf3c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5483506d0>]}
2022-10-06 18:05:55.360827 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc1148c-5676-4e47-aa5c-3e910baf3c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5500e6640>]}
2022-10-06 18:05:55.361086 (Thread-2): 19:05:55 | 2 of 3 OK created view model public.orders_cte....................... [CREATE VIEW in 0.07s]
2022-10-06 18:05:55.361270 (Thread-1): 19:05:55 | 1 of 3 OK created view model public.customer_cte..................... [CREATE VIEW in 0.07s]
2022-10-06 18:05:55.361424 (Thread-2): Finished running node model.view_for_bi_guys.orders_cte
2022-10-06 18:05:55.361621 (Thread-1): Finished running node model.view_for_bi_guys.customer_cte
2022-10-06 18:05:55.362028 (Thread-4): Began running node model.view_for_bi_guys.referencing
2022-10-06 18:05:55.362229 (Thread-4): 19:05:55 | 3 of 3 START table model public.referencing.......................... [RUN]
2022-10-06 18:05:55.362442 (Thread-4): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.362553 (Thread-4): Compiling model.view_for_bi_guys.referencing
2022-10-06 18:05:55.364525 (Thread-4): Writing injected SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 18:05:55.364836 (Thread-4): finished collecting timing info
2022-10-06 18:05:55.377806 (Thread-4): Writing runtime SQL for node "model.view_for_bi_guys.referencing"
2022-10-06 18:05:55.378223 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.378322 (Thread-4): On model.view_for_bi_guys.referencing: BEGIN
2022-10-06 18:05:55.378414 (Thread-4): Opening a new connection, currently in state init
2022-10-06 18:05:55.386479 (Thread-4): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:55.386775 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.386875 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */


  create  table "postgres"."public"."referencing__dbt_tmp"
  as (
    -- with referencing as (
--     select * from "postgres"."public"."customer_cte" c
--     join "postgres"."public"."orders_cte" o
--     on c.order_id=o.order_id
-- )
-- select * from referencing
with customers as (
    select * from "postgres"."public"."customer_cte"
),
orders as (
    select * from "postgres"."public"."orders_cte"
)
select c.first_name,c.last_name,c.email,c.date_of_birth,c.current_job,o.order_name,o.order_qty,o.order_price
from customers c join orders o on o.order_id=c.order_id
  );
2022-10-06 18:05:55.390426 (Thread-4): SQL status: SELECT 3 in 0.00 seconds
2022-10-06 18:05:55.392057 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.392172 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing" rename to "referencing__dbt_backup"
2022-10-06 18:05:55.392547 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 18:05:55.393814 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.393926 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
alter table "postgres"."public"."referencing__dbt_tmp" rename to "referencing"
2022-10-06 18:05:55.395269 (Thread-4): SQL status: ALTER TABLE in 0.00 seconds
2022-10-06 18:05:55.399161 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 18:05:55.399474 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.399563 (Thread-4): On model.view_for_bi_guys.referencing: COMMIT
2022-10-06 18:05:55.400236 (Thread-4): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:05:55.401148 (Thread-4): Using postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:05:55.401243 (Thread-4): On model.view_for_bi_guys.referencing: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.referencing"} */
drop table if exists "postgres"."public"."referencing__dbt_backup" cascade
2022-10-06 18:05:55.405648 (Thread-4): SQL status: DROP TABLE in 0.00 seconds
2022-10-06 18:05:55.406422 (Thread-4): finished collecting timing info
2022-10-06 18:05:55.406555 (Thread-4): On model.view_for_bi_guys.referencing: Close
2022-10-06 18:05:55.406819 (Thread-4): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bc1148c-5676-4e47-aa5c-3e910baf3c2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd562d6bd30>]}
2022-10-06 18:05:55.407054 (Thread-4): 19:05:55 | 3 of 3 OK created table model public.referencing..................... [SELECT 3 in 0.04s]
2022-10-06 18:05:55.407174 (Thread-4): Finished running node model.view_for_bi_guys.referencing
2022-10-06 18:05:55.407941 (MainThread): Acquiring new postgres connection "master".
2022-10-06 18:05:55.408071 (MainThread): Using postgres connection "master".
2022-10-06 18:05:55.408161 (MainThread): On master: BEGIN
2022-10-06 18:05:55.408253 (MainThread): Opening a new connection, currently in state closed
2022-10-06 18:05:55.417266 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:05:55.417454 (MainThread): On master: COMMIT
2022-10-06 18:05:55.417549 (MainThread): Using postgres connection "master".
2022-10-06 18:05:55.417639 (MainThread): On master: COMMIT
2022-10-06 18:05:55.417818 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:05:55.417935 (MainThread): On master: Close
2022-10-06 18:05:55.418229 (MainThread): 19:05:55 | 
2022-10-06 18:05:55.418358 (MainThread): 19:05:55 | Finished running 2 view models, 1 table model in 0.26s.
2022-10-06 18:05:55.418470 (MainThread): Connection 'master' was properly closed.
2022-10-06 18:05:55.418558 (MainThread): Connection 'model.view_for_bi_guys.customer_cte' was properly closed.
2022-10-06 18:05:55.418643 (MainThread): Connection 'model.view_for_bi_guys.orders_cte' was properly closed.
2022-10-06 18:05:55.418728 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 18:05:55.422160 (MainThread): 
2022-10-06 18:05:55.422306 (MainThread): Completed successfully
2022-10-06 18:05:55.422410 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 18:05:55.422567 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5500e6640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54836f520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd562d6ba30>]}
2022-10-06 18:05:55.422727 (MainThread): Flushing usage events
2022-10-06 18:07:40.160997 (MainThread): Running with dbt=0.21.1
2022-10-06 18:07:40.229138 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 18:07:40.230724 (MainThread): Tracking: tracking
2022-10-06 18:07:40.253232 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0caa43be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0caa4e520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0cab15e20>]}
2022-10-06 18:07:40.262217 (MainThread): Partial parsing not enabled
2022-10-06 18:07:40.270487 (MainThread): Parsing macros/catalog.sql
2022-10-06 18:07:40.273141 (MainThread): Parsing macros/relations.sql
2022-10-06 18:07:40.274212 (MainThread): Parsing macros/adapters.sql
2022-10-06 18:07:40.290470 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 18:07:40.291606 (MainThread): Parsing macros/core.sql
2022-10-06 18:07:40.294105 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 18:07:40.298807 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 18:07:40.305621 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 18:07:40.306737 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 18:07:40.318541 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 18:07:40.345174 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 18:07:40.361727 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 18:07:40.362897 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 18:07:40.370271 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 18:07:40.385310 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 18:07:40.395531 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 18:07:40.401423 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 18:07:40.406854 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 18:07:40.409415 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 18:07:40.410377 (MainThread): Parsing macros/etc/query.sql
2022-10-06 18:07:40.410984 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 18:07:40.411993 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 18:07:40.417979 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 18:07:40.419168 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 18:07:40.420781 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 18:07:40.421808 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 18:07:40.462719 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 18:07:40.463850 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 18:07:40.464606 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 18:07:40.465468 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 18:07:40.577270 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:07:40.586654 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:07:40.589118 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 18:07:40.613520 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4001b69b-c347-4f2e-abb7-eacd5ddd4cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b80fee20>]}
2022-10-06 18:07:40.616280 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 18:07:40.616539 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4001b69b-c347-4f2e-abb7-eacd5ddd4cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b8157400>]}
2022-10-06 18:07:40.616696 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 18:07:40.617541 (MainThread): 
2022-10-06 18:07:40.617751 (MainThread): Acquiring new postgres connection "master".
2022-10-06 18:07:40.618379 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_postgres".
2022-10-06 18:07:40.625219 (ThreadPoolExecutor-0_0): Using postgres connection "list_postgres".
2022-10-06 18:07:40.625398 (ThreadPoolExecutor-0_0): On list_postgres: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres"} */

    select distinct nspname from pg_namespace
  
2022-10-06 18:07:40.625496 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2022-10-06 18:07:40.662336 (ThreadPoolExecutor-0_0): SQL status: SELECT 4 in 0.04 seconds
2022-10-06 18:07:40.664034 (ThreadPoolExecutor-0_0): On list_postgres: Close
2022-10-06 18:07:40.664780 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 18:07:40.668793 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 18:07:40.668908 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 18:07:40.669007 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2022-10-06 18:07:40.676931 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:07:40.677055 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 18:07:40.677148 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 18:07:40.681065 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 18:07:40.681981 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 18:07:40.682271 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 18:07:40.685045 (MainThread): Using postgres connection "master".
2022-10-06 18:07:40.685165 (MainThread): On master: BEGIN
2022-10-06 18:07:40.685262 (MainThread): Opening a new connection, currently in state init
2022-10-06 18:07:40.695371 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:07:40.695498 (MainThread): Using postgres connection "master".
2022-10-06 18:07:40.695587 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 18:07:40.721839 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 18:07:40.723107 (MainThread): On master: ROLLBACK
2022-10-06 18:07:40.723357 (MainThread): Using postgres connection "master".
2022-10-06 18:07:40.723482 (MainThread): On master: BEGIN
2022-10-06 18:07:40.723792 (MainThread): SQL status: BEGIN in 0.00 seconds
2022-10-06 18:07:40.723916 (MainThread): On master: COMMIT
2022-10-06 18:07:40.724022 (MainThread): Using postgres connection "master".
2022-10-06 18:07:40.724117 (MainThread): On master: COMMIT
2022-10-06 18:07:40.724308 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:07:40.724428 (MainThread): On master: Close
2022-10-06 18:07:40.724668 (MainThread): 19:07:40 | Concurrency: 5 threads (target='dev')
2022-10-06 18:07:40.724801 (MainThread): 19:07:40 | 
2022-10-06 18:07:40.727045 (Thread-1): Began running node model.view_for_bi_guys.customer_cte
2022-10-06 18:07:40.727233 (Thread-2): Began running node model.view_for_bi_guys.orders_cte
2022-10-06 18:07:40.727470 (Thread-1): 19:07:40 | 1 of 3 START view model public.customer_cte.......................... [RUN]
2022-10-06 18:07:40.727655 (Thread-2): 19:07:40 | 2 of 3 START view model public.orders_cte............................ [RUN]
2022-10-06 18:07:40.727990 (Thread-1): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:07:40.728276 (Thread-2): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:07:40.728442 (Thread-1): Compiling model.view_for_bi_guys.customer_cte
2022-10-06 18:07:40.728574 (Thread-2): Compiling model.view_for_bi_guys.orders_cte
2022-10-06 18:07:40.730587 (Thread-1): Writing injected SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 18:07:40.732718 (Thread-2): Writing injected SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 18:07:40.733329 (Thread-1): finished collecting timing info
2022-10-06 18:07:40.733477 (Thread-2): finished collecting timing info
2022-10-06 18:07:40.751639 (Thread-1): Writing runtime SQL for node "model.view_for_bi_guys.customer_cte"
2022-10-06 18:07:40.753011 (Thread-2): Writing runtime SQL for node "model.view_for_bi_guys.orders_cte"
2022-10-06 18:07:40.753379 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:07:40.753501 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:07:40.753596 (Thread-1): On model.view_for_bi_guys.customer_cte: BEGIN
2022-10-06 18:07:40.753691 (Thread-2): On model.view_for_bi_guys.orders_cte: BEGIN
2022-10-06 18:07:40.753786 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 18:07:40.753873 (Thread-2): Opening a new connection, currently in state init
2022-10-06 18:07:40.761599 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:07:40.761744 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:07:40.761890 (Thread-2): Using postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 18:07:40.762009 (Thread-1): Using postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 18:07:40.762121 (Thread-2): On model.view_for_bi_guys.orders_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.orders_cte"} */

  create view "postgres"."public"."orders_cte__dbt_tmp" as (
    with orders as (
    select * from "postgres"."staging"."orders" 
)
select * from orders
  );

2022-10-06 18:07:40.762230 (Thread-1): On model.view_for_bi_guys.customer_cte: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "model.view_for_bi_guys.customer_cte"} */

  create view "postgres"."public"."customer_cte__dbt_tmp" as (
    with customer_cte as (
    select * from "postgres"."staging"."customers" 
)
select * from customer_cte
  );

2022-10-06 18:07:40.762630 (Thread-2): Postgres error: relation "staging.orders" does not exist
LINE 5:     select * from "postgres"."staging"."orders" 
                          ^

2022-10-06 18:07:40.762721 (Thread-1): Postgres error: relation "staging.customers" does not exist
LINE 5:     select * from "postgres"."staging"."customers" 
                          ^

2022-10-06 18:07:40.762866 (Thread-2): On model.view_for_bi_guys.orders_cte: ROLLBACK
2022-10-06 18:07:40.762982 (Thread-1): On model.view_for_bi_guys.customer_cte: ROLLBACK
2022-10-06 18:07:40.763405 (Thread-2): finished collecting timing info
2022-10-06 18:07:40.763674 (Thread-1): finished collecting timing info
2022-10-06 18:07:40.763794 (Thread-2): On model.view_for_bi_guys.orders_cte: Close
2022-10-06 18:07:40.763908 (Thread-1): On model.view_for_bi_guys.customer_cte: Close
2022-10-06 18:07:40.764463 (Thread-1): Database Error in model customer_cte (models/staging/customer_cte.sql)
  relation "staging.customers" does not exist
  LINE 5:     select * from "postgres"."staging"."customers" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/customer_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "staging.customers" does not exist
LINE 5:     select * from "postgres"."staging"."customers" 
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model customer_cte (models/staging/customer_cte.sql)
  relation "staging.customers" does not exist
  LINE 5:     select * from "postgres"."staging"."customers" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/customer_cte.sql
2022-10-06 18:07:40.764178 (Thread-2): Database Error in model orders_cte (models/staging/orders_cte.sql)
  relation "staging.orders" does not exist
  LINE 5:     select * from "postgres"."staging"."orders" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/orders_cte.sql
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 56, in exception_handler
    yield
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: relation "staging.orders" does not exist
LINE 5:     select * from "postgres"."staging"."orders" 
                          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 348, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 291, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/base.py", line 393, in run
    return self.execute(compiled_node, manifest)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/run.py", line 249, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 68, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 333, in __call__
    return self.call_macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/jinja.py", line 260, in call_macro
    return macro(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/base/impl.py", line 226, in execute
    return self.connections.execute(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 131, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/opt/anaconda3/lib/python3.9/contextlib.py", line 137, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/adapters/postgres/connections.py", line 67, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model orders_cte (models/staging/orders_cte.sql)
  relation "staging.orders" does not exist
  LINE 5:     select * from "postgres"."staging"."orders" 
                            ^
  compiled SQL at target/run/view_for_bi_guys/models/staging/orders_cte.sql
2022-10-06 18:07:40.768188 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4001b69b-c347-4f2e-abb7-eacd5ddd4cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a854d0a0>]}
2022-10-06 18:07:40.768336 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4001b69b-c347-4f2e-abb7-eacd5ddd4cea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a855a7c0>]}
2022-10-06 18:07:40.768596 (Thread-1): 19:07:40 | 1 of 3 ERROR creating view model public.customer_cte................. [ERROR in 0.04s]
2022-10-06 18:07:40.768778 (Thread-2): 19:07:40 | 2 of 3 ERROR creating view model public.orders_cte................... [ERROR in 0.04s]
2022-10-06 18:07:40.768908 (Thread-1): Finished running node model.view_for_bi_guys.customer_cte
2022-10-06 18:07:40.769017 (Thread-2): Finished running node model.view_for_bi_guys.orders_cte
2022-10-06 18:07:40.769443 (Thread-4): Began running node model.view_for_bi_guys.referencing
2022-10-06 18:07:40.769614 (Thread-4): 19:07:40 | 3 of 3 SKIP relation public.referencing.............................. [SKIP]
2022-10-06 18:07:40.769774 (Thread-4): Finished running node model.view_for_bi_guys.referencing
2022-10-06 18:07:40.770538 (MainThread): Acquiring new postgres connection "master".
2022-10-06 18:07:40.770659 (MainThread): Using postgres connection "master".
2022-10-06 18:07:40.770738 (MainThread): On master: BEGIN
2022-10-06 18:07:40.770820 (MainThread): Opening a new connection, currently in state closed
2022-10-06 18:07:40.778152 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 18:07:40.778286 (MainThread): On master: COMMIT
2022-10-06 18:07:40.778370 (MainThread): Using postgres connection "master".
2022-10-06 18:07:40.778450 (MainThread): On master: COMMIT
2022-10-06 18:07:40.778604 (MainThread): SQL status: COMMIT in 0.00 seconds
2022-10-06 18:07:40.778699 (MainThread): On master: Close
2022-10-06 18:07:40.778944 (MainThread): 19:07:40 | 
2022-10-06 18:07:40.779057 (MainThread): 19:07:40 | Finished running 2 view models, 1 table model in 0.16s.
2022-10-06 18:07:40.779154 (MainThread): Connection 'master' was properly closed.
2022-10-06 18:07:40.779233 (MainThread): Connection 'model.view_for_bi_guys.customer_cte' was properly closed.
2022-10-06 18:07:40.779310 (MainThread): Connection 'model.view_for_bi_guys.orders_cte' was properly closed.
2022-10-06 18:07:40.782520 (MainThread): 
2022-10-06 18:07:40.782677 (MainThread): Completed with 2 errors and 0 warnings:
2022-10-06 18:07:40.782775 (MainThread): 
2022-10-06 18:07:40.782867 (MainThread): Database Error in model customer_cte (models/staging/customer_cte.sql)
2022-10-06 18:07:40.782955 (MainThread):   relation "staging.customers" does not exist
2022-10-06 18:07:40.783039 (MainThread):   LINE 5:     select * from "postgres"."staging"."customers" 
2022-10-06 18:07:40.783121 (MainThread):                             ^
2022-10-06 18:07:40.783203 (MainThread):   compiled SQL at target/run/view_for_bi_guys/models/staging/customer_cte.sql
2022-10-06 18:07:40.783287 (MainThread): 
2022-10-06 18:07:40.783374 (MainThread): Database Error in model orders_cte (models/staging/orders_cte.sql)
2022-10-06 18:07:40.783457 (MainThread):   relation "staging.orders" does not exist
2022-10-06 18:07:40.783537 (MainThread):   LINE 5:     select * from "postgres"."staging"."orders" 
2022-10-06 18:07:40.783618 (MainThread):                             ^
2022-10-06 18:07:40.783697 (MainThread):   compiled SQL at target/run/view_for_bi_guys/models/staging/orders_cte.sql
2022-10-06 18:07:40.783784 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2022-10-06 18:07:40.783934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a8565f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a84c51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0a84c5a00>]}
2022-10-06 18:07:40.784089 (MainThread): Flushing usage events
2022-10-06 18:11:05.341250 (MainThread): Running with dbt=0.21.1
2022-10-06 18:11:05.414323 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, fail_fast=False, threads=None, version_check=True, select=None, exclude=None, selector_name=None, state=None, defer=None, full_refresh=False, cls=<class 'dbt.task.run.RunTask'>, which='run', rpc_method='run')
2022-10-06 18:11:05.415778 (MainThread): Tracking: tracking
2022-10-06 18:11:05.444183 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75aa83d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75aa8e3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75ab50e20>]}
2022-10-06 18:11:05.453064 (MainThread): Partial parsing not enabled
2022-10-06 18:11:05.456032 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75ab492b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75ab44eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc75ab44c70>]}
2022-10-06 18:11:05.456227 (MainThread): Flushing usage events
2022-10-06 18:11:07.015256 (MainThread): Encountered an error:
2022-10-06 18:11:07.015856 (MainThread): Compilation Error
  The schema file at models/sources.yml is invalid because the value of 'sources' is not a list
2022-10-06 18:11:07.020306 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 39, in load_source_file
    validate_yaml(source_file.path.original_file_path, dfy)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 56, in validate_yaml
    raise CompilationException(msg)
dbt.exceptions.CompilationException: Compilation Error
  The schema file at models/sources.yml is invalid because the value of 'sources' is not a list

2022-10-06 21:39:46.171709 (MainThread): Running with dbt=0.21.1
2022-10-06 21:39:46.246258 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['customer_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:39:46.251184 (MainThread): Tracking: tracking
2022-10-06 21:39:46.279277 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866a920a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866a91d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f866a91df10>]}
2022-10-06 21:39:46.287895 (MainThread): Partial parsing not enabled
2022-10-06 21:39:46.298005 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:39:46.300581 (MainThread): Parsing macros/relations.sql
2022-10-06 21:39:46.301653 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:39:46.318942 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:39:46.320116 (MainThread): Parsing macros/core.sql
2022-10-06 21:39:46.322652 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:39:46.327503 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:39:46.334624 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:39:46.335772 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:39:46.347925 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:39:46.377532 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:39:46.394996 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:39:46.396178 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:39:46.403880 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:39:46.420175 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:39:46.431271 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:39:46.437698 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:39:46.443577 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:39:46.446206 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:39:46.447184 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:39:46.447797 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:39:46.448833 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:39:46.455115 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:39:46.456325 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:39:46.457956 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:39:46.459001 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:39:46.503108 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:39:46.504217 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:39:46.504971 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:39:46.505838 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:39:46.619594 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:39:46.627810 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:39:46.630269 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:39:46.647860 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:39:46.649029 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:39:46.666527 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2210c48-c33b-4e1d-9a51-aa6ae8b839f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f865000e070>]}
2022-10-06 21:39:46.669441 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 21:39:46.670456 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2210c48-c33b-4e1d-9a51-aa6ae8b839f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650067460>]}
2022-10-06 21:39:46.670620 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 21:39:46.671411 (MainThread): 
2022-10-06 21:39:46.671633 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:39:46.672332 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 21:39:46.679181 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:39:46.679380 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 21:39:46.679489 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 21:39:46.774695 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.10 seconds
2022-10-06 21:39:46.775473 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:39:46.775624 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 21:39:46.787732 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.01 seconds
2022-10-06 21:39:46.789600 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 21:39:46.790315 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 21:39:46.794589 (MainThread): Using postgres connection "master".
2022-10-06 21:39:46.794765 (MainThread): On master: BEGIN
2022-10-06 21:39:46.794908 (MainThread): Opening a new connection, currently in state init
2022-10-06 21:39:46.805434 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:39:46.805577 (MainThread): Using postgres connection "master".
2022-10-06 21:39:46.805690 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 21:39:46.837462 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 21:39:46.838900 (MainThread): On master: ROLLBACK
2022-10-06 21:39:46.839228 (MainThread): On master: Close
2022-10-06 21:39:46.839586 (MainThread): 22:39:46 | Concurrency: 5 threads (target='dev')
2022-10-06 21:39:46.839779 (MainThread): 22:39:46 | 
2022-10-06 21:39:46.842796 (Thread-1): Began running node test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf
2022-10-06 21:39:46.843008 (Thread-2): Began running node test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691
2022-10-06 21:39:46.843257 (Thread-1): 22:39:46 | 1 of 2 START test not_null_customer_cte_id........................... [RUN]
2022-10-06 21:39:46.843467 (Thread-2): 22:39:46 | 2 of 2 START test unique_customer_cte_id............................. [RUN]
2022-10-06 21:39:46.843863 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf".
2022-10-06 21:39:46.844141 (Thread-1): Compiling test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf
2022-10-06 21:39:46.844487 (Thread-2): Acquiring new postgres connection "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691".
2022-10-06 21:39:46.854445 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf"
2022-10-06 21:39:46.854667 (Thread-2): Compiling test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691
2022-10-06 21:39:46.860397 (Thread-2): Writing injected SQL for node "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691"
2022-10-06 21:39:46.860933 (Thread-1): finished collecting timing info
2022-10-06 21:39:46.861088 (Thread-2): finished collecting timing info
2022-10-06 21:39:46.874910 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf"
2022-10-06 21:39:46.876173 (Thread-2): Writing runtime SQL for node "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691"
2022-10-06 21:39:46.876764 (Thread-2): Using postgres connection "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691".
2022-10-06 21:39:46.876877 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: BEGIN
2022-10-06 21:39:46.876978 (Thread-2): Opening a new connection, currently in state init
2022-10-06 21:39:46.877196 (Thread-1): Using postgres connection "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf".
2022-10-06 21:39:46.877320 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: BEGIN
2022-10-06 21:39:46.877423 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 21:39:46.885758 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:39:46.885907 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:39:46.886019 (Thread-2): Using postgres connection "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691".
2022-10-06 21:39:46.886124 (Thread-1): Using postgres connection "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf".
2022-10-06 21:39:46.886219 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."customer_cte"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2022-10-06 21:39:46.886311 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."public"."customer_cte"
where id is null



      
    ) dbt_internal_test
2022-10-06 21:39:46.887829 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:39:46.889299 (Thread-1): finished collecting timing info
2022-10-06 21:39:46.889428 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:39:46.889534 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: ROLLBACK
2022-10-06 21:39:46.890384 (Thread-2): finished collecting timing info
2022-10-06 21:39:46.890540 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: ROLLBACK
2022-10-06 21:39:46.890655 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: Close
2022-10-06 21:39:46.890912 (Thread-1): 22:39:46 | 1 of 2 PASS not_null_customer_cte_id................................. [PASS in 0.05s]
2022-10-06 21:39:46.891006 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: Close
2022-10-06 21:39:46.891125 (Thread-1): Finished running node test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf
2022-10-06 21:39:46.891353 (Thread-2): 22:39:46 | 2 of 2 PASS unique_customer_cte_id................................... [PASS in 0.05s]
2022-10-06 21:39:46.891514 (Thread-2): Finished running node test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691
2022-10-06 21:39:46.892340 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:39:46.892557 (MainThread): 22:39:46 | 
2022-10-06 21:39:46.892670 (MainThread): 22:39:46 | Finished running 2 tests in 0.22s.
2022-10-06 21:39:46.892773 (MainThread): Connection 'master' was properly closed.
2022-10-06 21:39:46.892861 (MainThread): Connection 'test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf' was properly closed.
2022-10-06 21:39:46.892946 (MainThread): Connection 'test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691' was properly closed.
2022-10-06 21:39:46.896560 (MainThread): 
2022-10-06 21:39:46.896730 (MainThread): Completed successfully
2022-10-06 21:39:46.896842 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-10-06 21:39:46.897014 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650111f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650111d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8650111730>]}
2022-10-06 21:39:46.897192 (MainThread): Flushing usage events
2022-10-06 21:50:55.108874 (MainThread): Running with dbt=0.21.1
2022-10-06 21:50:55.185364 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:50:55.186817 (MainThread): Tracking: tracking
2022-10-06 21:50:55.210467 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc2aa2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc2aad6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9dc2aaddf0>]}
2022-10-06 21:50:55.219311 (MainThread): Partial parsing not enabled
2022-10-06 21:50:55.229767 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:50:55.232282 (MainThread): Parsing macros/relations.sql
2022-10-06 21:50:55.233262 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:50:55.249014 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:50:55.250135 (MainThread): Parsing macros/core.sql
2022-10-06 21:50:55.252608 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:50:55.257197 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:50:55.263873 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:50:55.264974 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:50:55.276582 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:50:55.301206 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:50:55.317218 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:50:55.318364 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:50:55.325443 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:50:55.339810 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:50:55.349626 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:50:55.355169 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:50:55.360329 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:50:55.362878 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:50:55.363832 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:50:55.364440 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:50:55.365437 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:50:55.371302 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:50:55.372485 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:50:55.374065 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:50:55.375082 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:50:55.414043 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:50:55.415128 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:50:55.415870 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:50:55.416722 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:50:55.528818 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:50:55.537046 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:50:55.539497 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:50:55.557856 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:50:55.559018 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:50:55.560138 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:50:55.561343 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:50:55.561635 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db0325c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db0343f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9db02a7670>]}
2022-10-06 21:50:55.561798 (MainThread): Flushing usage events
2022-10-06 21:50:57.570767 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 21:50:57.571841 (MainThread): Encountered an error:
2022-10-06 21:50:57.572321 (MainThread): Compilation Error
  Invalid test config given in models/test.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans', 'Egg'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2022-10-06 21:50:57.578748 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 293, in _parse_generic_test
    builder = TestBuilder(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schema_test_builders.py", line 206, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schema_test_builders.py", line 271, in extract_test_args
    raise_compiler_error(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans', 'Egg'])] instead (2 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 325, in load
    self.parse_project(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 414, in parse_project
    parser.parse_file(block, dct=dct)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 493, in parse_file
    self.parse_tests(test_block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 460, in parse_tests
    self.parse_column_tests(block, column)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 216, in parse_column_tests
    self.parse_test(block, test, column)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 456, in parse_test
    self.parse_node(block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 395, in parse_node
    node = self._parse_generic_test(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 307, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models/test.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans', 'Egg'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2022-10-06 21:54:27.159365 (MainThread): Running with dbt=0.21.1
2022-10-06 21:54:27.232986 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:54:27.234011 (MainThread): Tracking: tracking
2022-10-06 21:54:27.261871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8602b1fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f00941c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f0094100>]}
2022-10-06 21:54:27.270874 (MainThread): Partial parsing not enabled
2022-10-06 21:54:27.281097 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:54:27.283595 (MainThread): Parsing macros/relations.sql
2022-10-06 21:54:27.284643 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:54:27.301484 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:54:27.302649 (MainThread): Parsing macros/core.sql
2022-10-06 21:54:27.305182 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:54:27.309999 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:54:27.316925 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:54:27.318068 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:54:27.330124 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:54:27.358927 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:54:27.376013 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:54:27.377207 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:54:27.384867 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:54:27.400607 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:54:27.411223 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:54:27.417552 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:54:27.423324 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:54:27.425929 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:54:27.426906 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:54:27.427521 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:54:27.428553 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:54:27.434707 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:54:27.435910 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:54:27.437535 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:54:27.438573 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:54:27.480746 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:54:27.481847 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:54:27.482603 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:54:27.483468 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:54:27.596613 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:54:27.605970 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:54:27.608438 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:54:27.626884 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:54:27.628038 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:54:27.629162 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:54:27.630361 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:54:27.630648 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f0094040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85e0463f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f85f0108760>]}
2022-10-06 21:54:27.630818 (MainThread): Flushing usage events
2022-10-06 21:54:33.283586 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2022-10-06 21:54:33.284179 (MainThread): Error sending message, disabling tracking
2022-10-06 21:54:33.284621 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 21:54:33.284951 (MainThread): Encountered an error:
2022-10-06 21:54:33.285238 (MainThread): Compilation Error
  Invalid test config given in models/test.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2022-10-06 21:54:33.290418 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 293, in _parse_generic_test
    builder = TestBuilder(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schema_test_builders.py", line 206, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schema_test_builders.py", line 271, in extract_test_args
    raise_compiler_error(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans'])] instead (2 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 325, in load
    self.parse_project(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 414, in parse_project
    parser.parse_file(block, dct=dct)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 493, in parse_file
    self.parse_tests(test_block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 460, in parse_tests
    self.parse_column_tests(block, column)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 216, in parse_column_tests
    self.parse_test(block, test, column)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 456, in parse_test
    self.parse_node(block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 395, in parse_node
    node = self._parse_generic_test(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 307, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models/test.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2022-10-06 21:56:09.485405 (MainThread): Running with dbt=0.21.1
2022-10-06 21:56:09.562333 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:56:09.563541 (MainThread): Tracking: tracking
2022-10-06 21:56:09.585664 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6c29df880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b0233eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b0233fa0>]}
2022-10-06 21:56:09.594383 (MainThread): Partial parsing not enabled
2022-10-06 21:56:09.604094 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:56:09.606619 (MainThread): Parsing macros/relations.sql
2022-10-06 21:56:09.607675 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:56:09.623468 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:56:09.624594 (MainThread): Parsing macros/core.sql
2022-10-06 21:56:09.627109 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:56:09.631695 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:56:09.638362 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:56:09.639464 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:56:09.651565 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:56:09.676911 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:56:09.693026 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:56:09.694185 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:56:09.701304 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:56:09.715594 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:56:09.725486 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:56:09.731056 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:56:09.736234 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:56:09.738787 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:56:09.739748 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:56:09.740366 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:56:09.741366 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:56:09.747212 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:56:09.748394 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:56:09.749993 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:56:09.751019 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:56:09.789878 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:56:09.790968 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:56:09.791716 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:56:09.792580 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:56:09.910052 (MainThread): 1699: statically parsed staging/orders_cte.sql
2022-10-06 21:56:09.920081 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:56:09.921946 (MainThread): Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': '0d17d3c6-84ca-40f8-8754-c77092fc7f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b02a76d0>]}
2022-10-06 21:56:09.922675 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:56:09.924976 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:56:09.943627 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:09.944884 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:09.945972 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:09.947039 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:09.962849 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d17d3c6-84ca-40f8-8754-c77092fc7f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b02a76d0>]}
2022-10-06 21:56:09.966400 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 21:56:09.967079 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d17d3c6-84ca-40f8-8754-c77092fc7f72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6b02a3e20>]}
2022-10-06 21:56:09.967256 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 21:56:09.968153 (MainThread): 
2022-10-06 21:56:09.968387 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:56:09.969058 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 21:56:09.976239 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:56:09.976437 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 21:56:09.976543 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 21:56:10.023593 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.05 seconds
2022-10-06 21:56:10.023950 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:56:10.024063 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 21:56:10.027736 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 21:56:10.029073 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 21:56:10.029316 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 21:56:10.032460 (MainThread): Using postgres connection "master".
2022-10-06 21:56:10.032590 (MainThread): On master: BEGIN
2022-10-06 21:56:10.032702 (MainThread): Opening a new connection, currently in state init
2022-10-06 21:56:10.042036 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:56:10.042177 (MainThread): Using postgres connection "master".
2022-10-06 21:56:10.042269 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 21:56:10.067292 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 21:56:10.068400 (MainThread): On master: ROLLBACK
2022-10-06 21:56:10.068661 (MainThread): On master: Close
2022-10-06 21:56:10.068947 (MainThread): 22:56:10 | Concurrency: 5 threads (target='dev')
2022-10-06 21:56:10.069094 (MainThread): 22:56:10 | 
2022-10-06 21:56:10.072054 (Thread-1): Began running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:56:10.072250 (Thread-2): Began running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:56:10.072432 (Thread-1): 22:56:10 | 1 of 2 START test not_null_orders_cte_order_id....................... [RUN]
2022-10-06 21:56:10.072570 (Thread-2): 22:56:10 | 2 of 2 START test unique_orders_cte_order_id......................... [RUN]
2022-10-06 21:56:10.072926 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:56:10.073204 (Thread-2): Acquiring new postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:56:10.073387 (Thread-1): Compiling test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:56:10.073528 (Thread-2): Compiling test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:56:10.082644 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:56:10.086880 (Thread-2): Writing injected SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:56:10.087278 (Thread-2): finished collecting timing info
2022-10-06 21:56:10.087414 (Thread-1): finished collecting timing info
2022-10-06 21:56:10.099675 (Thread-2): Writing runtime SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:56:10.100806 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:56:10.101181 (Thread-2): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:56:10.101280 (Thread-2): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: BEGIN
2022-10-06 21:56:10.101398 (Thread-1): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:56:10.101495 (Thread-2): Opening a new connection, currently in state init
2022-10-06 21:56:10.101587 (Thread-1): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: BEGIN
2022-10-06 21:56:10.101775 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 21:56:10.113303 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:56:10.113487 (Thread-1): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:56:10.113573 (Thread-1): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."public"."orders_cte"
where order_id is null



      
    ) dbt_internal_test
2022-10-06 21:56:10.114195 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:56:10.114296 (Thread-2): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:56:10.114382 (Thread-2): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."orders_cte"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-10-06 21:56:10.114689 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:56:10.116347 (Thread-1): finished collecting timing info
2022-10-06 21:56:10.116477 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:56:10.116596 (Thread-1): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: ROLLBACK
2022-10-06 21:56:10.117429 (Thread-2): finished collecting timing info
2022-10-06 21:56:10.117578 (Thread-2): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: ROLLBACK
2022-10-06 21:56:10.117715 (Thread-1): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: Close
2022-10-06 21:56:10.117798 (Thread-2): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: Close
2022-10-06 21:56:10.118046 (Thread-1): 22:56:10 | 1 of 2 PASS not_null_orders_cte_order_id............................. [PASS in 0.05s]
2022-10-06 21:56:10.118236 (Thread-2): 22:56:10 | 2 of 2 PASS unique_orders_cte_order_id............................... [PASS in 0.05s]
2022-10-06 21:56:10.118389 (Thread-1): Finished running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:56:10.118524 (Thread-2): Finished running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:56:10.119288 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:56:10.119486 (MainThread): 22:56:10 | 
2022-10-06 21:56:10.119588 (MainThread): 22:56:10 | Finished running 2 tests in 0.15s.
2022-10-06 21:56:10.119682 (MainThread): Connection 'master' was properly closed.
2022-10-06 21:56:10.119764 (MainThread): Connection 'test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135' was properly closed.
2022-10-06 21:56:10.119843 (MainThread): Connection 'test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4' was properly closed.
2022-10-06 21:56:10.122820 (MainThread): 
2022-10-06 21:56:10.122945 (MainThread): Completed successfully
2022-10-06 21:56:10.123052 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-10-06 21:56:10.123216 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a035ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a035cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6a035cdc0>]}
2022-10-06 21:56:10.123386 (MainThread): Flushing usage events
2022-10-06 21:56:48.341907 (MainThread): Running with dbt=0.21.1
2022-10-06 21:56:48.412498 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:56:48.414058 (MainThread): Tracking: tracking
2022-10-06 21:56:48.435475 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34aa8ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34aa8d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb34aa8da00>]}
2022-10-06 21:56:48.444401 (MainThread): Partial parsing not enabled
2022-10-06 21:56:48.453232 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:56:48.455727 (MainThread): Parsing macros/relations.sql
2022-10-06 21:56:48.456767 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:56:48.472738 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:56:48.473863 (MainThread): Parsing macros/core.sql
2022-10-06 21:56:48.476327 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:56:48.480870 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:56:48.487465 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:56:48.488553 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:56:48.500074 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:56:48.524538 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:56:48.540393 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:56:48.541531 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:56:48.548562 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:56:48.562763 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:56:48.572548 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:56:48.578087 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:56:48.583236 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:56:48.585770 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:56:48.586728 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:56:48.587333 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:56:48.588323 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:56:48.594131 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:56:48.595307 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:56:48.596889 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:56:48.597901 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:56:48.636492 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:56:48.637571 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:56:48.638311 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:56:48.639159 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:56:48.750602 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:56:48.759785 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:56:48.762244 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:56:48.782041 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:48.783286 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:48.784420 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:48.785623 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:56:48.785921 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3384bdc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb328243f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3281e88e0>]}
2022-10-06 21:56:48.786089 (MainThread): Flushing usage events
2022-10-06 21:56:49.958823 (MainThread): Connection 'model.view_for_bi_guys.referencing' was properly closed.
2022-10-06 21:56:49.959431 (MainThread): Encountered an error:
2022-10-06 21:56:49.959802 (MainThread): Compilation Error
  Invalid test config given in models/test.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans', 'Spag', 'Pizza', 'Shawarma'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)
2022-10-06 21:56:49.966002 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 293, in _parse_generic_test
    builder = TestBuilder(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schema_test_builders.py", line 206, in __init__
    test_name, test_args = self.extract_test_args(test, column_name)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schema_test_builders.py", line 271, in extract_test_args
    raise_compiler_error(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/exceptions.py", line 447, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans', 'Spag', 'Pizza', 'Shawarma'])] instead (2 keys)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 325, in load
    self.parse_project(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 414, in parse_project
    parser.parse_file(block, dct=dct)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 493, in parse_file
    self.parse_tests(test_block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 460, in parse_tests
    self.parse_column_tests(block, column)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 216, in parse_column_tests
    self.parse_test(block, test, column)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 456, in parse_test
    self.parse_node(block)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 395, in parse_node
    node = self._parse_generic_test(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 307, in _parse_generic_test
    raise CompilationException(msg) from exc
dbt.exceptions.CompilationException: Compilation Error
  Invalid test config given in models/test.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', ['Rice', 'Beans', 'Spag', 'Pizza', 'Shawarma'])] instead (2 keys)
  	@: UnparsedNodeUpdate(original_file_path='model...ne)

2022-10-06 21:58:57.217423 (MainThread): Running with dbt=0.21.1
2022-10-06 21:58:57.292539 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:58:57.293938 (MainThread): Tracking: tracking
2022-10-06 21:58:57.323223 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0295fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b02a2c1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b02a2c0a0>]}
2022-10-06 21:58:57.336033 (MainThread): Partial parsing not enabled
2022-10-06 21:58:57.347493 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:58:57.350415 (MainThread): Parsing macros/relations.sql
2022-10-06 21:58:57.351552 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:58:57.368362 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:58:57.369577 (MainThread): Parsing macros/core.sql
2022-10-06 21:58:57.372061 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:58:57.376705 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:58:57.383375 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:58:57.384470 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:58:57.396258 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:58:57.420868 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:58:57.436997 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:58:57.438171 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:58:57.445265 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:58:57.459558 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:58:57.469393 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:58:57.474961 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:58:57.480150 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:58:57.482710 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:58:57.483671 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:58:57.484284 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:58:57.485285 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:58:57.491128 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:58:57.492310 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:58:57.493901 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:58:57.494920 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:58:57.533720 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:58:57.534805 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:58:57.535552 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:58:57.536406 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:58:57.648827 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:58:57.657133 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:58:57.659569 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:58:57.677679 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:58:57.678829 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:58:57.679958 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:58:57.681157 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:58:57.690282 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:58:57.690474 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:58:57.706284 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64606ce0-3398-4ff8-9d24-db0d40b75518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae858f970>]}
2022-10-06 21:58:57.709774 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 21:58:57.710497 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64606ce0-3398-4ff8-9d24-db0d40b75518', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae85bdeb0>]}
2022-10-06 21:58:57.710678 (MainThread): Found 3 models, 5 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 21:58:57.711635 (MainThread): 
2022-10-06 21:58:57.711866 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:58:57.712743 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 21:58:57.719631 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:58:57.719811 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 21:58:57.719911 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 21:58:57.777615 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.06 seconds
2022-10-06 21:58:57.778152 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:58:57.778276 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 21:58:57.781649 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 21:58:57.783157 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 21:58:57.783451 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 21:58:57.786872 (MainThread): Using postgres connection "master".
2022-10-06 21:58:57.787012 (MainThread): On master: BEGIN
2022-10-06 21:58:57.787123 (MainThread): Opening a new connection, currently in state init
2022-10-06 21:58:57.796755 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:58:57.796889 (MainThread): Using postgres connection "master".
2022-10-06 21:58:57.796991 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 21:58:57.822264 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 21:58:57.823351 (MainThread): On master: ROLLBACK
2022-10-06 21:58:57.823596 (MainThread): On master: Close
2022-10-06 21:58:57.823871 (MainThread): 22:58:57 | Concurrency: 5 threads (target='dev')
2022-10-06 21:58:57.824023 (MainThread): 22:58:57 | 
2022-10-06 21:58:57.826540 (Thread-1): Began running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e
2022-10-06 21:58:57.826738 (Thread-2): Began running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:58:57.826887 (Thread-3): Began running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:58:57.827038 (Thread-1): 22:58:57 | 1 of 3 START test accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma [RUN]
2022-10-06 21:58:57.827192 (Thread-2): 22:58:57 | 2 of 3 START test not_null_orders_cte_order_id....................... [RUN]
2022-10-06 21:58:57.827326 (Thread-3): 22:58:57 | 3 of 3 START test unique_orders_cte_order_id......................... [RUN]
2022-10-06 21:58:57.828250 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e".
2022-10-06 21:58:57.828558 (Thread-2): Acquiring new postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:58:57.828823 (Thread-3): Acquiring new postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:58:57.828994 (Thread-1): Compiling test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e
2022-10-06 21:58:57.829136 (Thread-2): Compiling test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:58:57.829267 (Thread-3): Compiling test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:58:57.834172 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e"
2022-10-06 21:58:57.838663 (Thread-2): Writing injected SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:58:57.842787 (Thread-3): Writing injected SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:58:57.843259 (Thread-2): finished collecting timing info
2022-10-06 21:58:57.849748 (Thread-1): finished collecting timing info
2022-10-06 21:58:57.849927 (Thread-3): finished collecting timing info
2022-10-06 21:58:57.856213 (Thread-2): Writing runtime SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:58:57.857348 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e"
2022-10-06 21:58:57.858290 (Thread-3): Writing runtime SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:58:57.858712 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e".
2022-10-06 21:58:57.858849 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:58:57.858956 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: BEGIN
2022-10-06 21:58:57.859082 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: BEGIN
2022-10-06 21:58:57.859210 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:58:57.859300 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 21:58:57.859392 (Thread-2): Opening a new connection, currently in state init
2022-10-06 21:58:57.859483 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: BEGIN
2022-10-06 21:58:57.859743 (Thread-3): Opening a new connection, currently in state init
2022-10-06 21:58:57.869995 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:58:57.870165 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:58:57.870270 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:58:57.870356 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."public"."orders_cte"
where order_id is null



      
    ) dbt_internal_test
2022-10-06 21:58:57.870452 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:58:57.870567 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."orders_cte"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-10-06 21:58:57.872401 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:58:57.873799 (Thread-2): finished collecting timing info
2022-10-06 21:58:57.873927 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:58:57.874046 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: ROLLBACK
2022-10-06 21:58:57.874845 (Thread-3): finished collecting timing info
2022-10-06 21:58:57.875028 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: ROLLBACK
2022-10-06 21:58:57.875146 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: Close
2022-10-06 21:58:57.875419 (Thread-2): 22:58:57 | 2 of 3 PASS not_null_orders_cte_order_id............................. [PASS in 0.05s]
2022-10-06 21:58:57.875516 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: Close
2022-10-06 21:58:57.875634 (Thread-2): Finished running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:58:57.875744 (Thread-1): SQL status: BEGIN in 0.02 seconds
2022-10-06 21:58:57.875992 (Thread-3): 22:58:57 | 3 of 3 PASS unique_orders_cte_order_id............................... [PASS in 0.05s]
2022-10-06 21:58:57.876094 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e".
2022-10-06 21:58:57.876260 (Thread-3): Finished running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:58:57.876360 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_name as value_field,
        count(*) as n_records

    from "postgres"."public"."orders_cte"
    group by order_name

)

select *
from all_values
where value_field not in (
    'Rice','Beans','Spag','Pizza','Shawarma'
)



      
    ) dbt_internal_test
2022-10-06 21:58:57.881260 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:58:57.882269 (Thread-1): finished collecting timing info
2022-10-06 21:58:57.882405 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: ROLLBACK
2022-10-06 21:58:57.882685 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: Close
2022-10-06 21:58:57.882952 (Thread-1): 22:58:57 | 1 of 3 PASS accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma [PASS in 0.06s]
2022-10-06 21:58:57.883062 (Thread-1): Finished running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e
2022-10-06 21:58:57.883825 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:58:57.884033 (MainThread): 22:58:57 | 
2022-10-06 21:58:57.884141 (MainThread): 22:58:57 | Finished running 3 tests in 0.17s.
2022-10-06 21:58:57.884240 (MainThread): Connection 'master' was properly closed.
2022-10-06 21:58:57.884323 (MainThread): Connection 'test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e' was properly closed.
2022-10-06 21:58:57.884401 (MainThread): Connection 'test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135' was properly closed.
2022-10-06 21:58:57.884480 (MainThread): Connection 'test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4' was properly closed.
2022-10-06 21:58:57.887977 (MainThread): 
2022-10-06 21:58:57.888099 (MainThread): Completed successfully
2022-10-06 21:58:57.888207 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 21:58:57.888359 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae864d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae8580f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ae85eda90>]}
2022-10-06 21:58:57.888520 (MainThread): Flushing usage events
2022-10-06 21:59:03.611363 (MainThread): The 'warn' method is deprecated, use 'warning' instead
2022-10-06 21:59:03.612765 (MainThread): Error sending message, disabling tracking
2022-10-06 21:59:13.747713 (MainThread): Running with dbt=0.21.1
2022-10-06 21:59:13.804667 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:59:13.805663 (MainThread): Tracking: tracking
2022-10-06 21:59:13.824747 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53a486a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53a514f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53a5142e0>]}
2022-10-06 21:59:13.833114 (MainThread): Partial parsing not enabled
2022-10-06 21:59:13.841769 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:59:13.844267 (MainThread): Parsing macros/relations.sql
2022-10-06 21:59:13.845314 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:59:13.861314 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:59:13.862453 (MainThread): Parsing macros/core.sql
2022-10-06 21:59:13.864952 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:59:13.869570 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:59:13.876258 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:59:13.877371 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:59:13.889036 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:59:13.913713 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:59:13.929757 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:59:13.930919 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:59:13.938058 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:59:13.952440 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:59:13.962297 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:59:13.967885 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:59:13.973082 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:59:13.975643 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:59:13.976605 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:59:13.977217 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:59:13.978222 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:59:13.984106 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:59:13.985290 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:59:13.986874 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:59:13.987897 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:59:14.026795 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:59:14.027881 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:59:14.028646 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:59:14.029517 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:59:14.143448 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:59:14.152265 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:59:14.154912 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:59:14.173926 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:14.175169 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:14.176331 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:14.177573 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:14.186402 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:14.202734 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6368f6d1-331c-46fa-abf3-dd71a2f99e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53a531280>]}
2022-10-06 21:59:14.205914 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 21:59:14.206261 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6368f6d1-331c-46fa-abf3-dd71a2f99e20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5081f2eb0>]}
2022-10-06 21:59:14.206425 (MainThread): Found 3 models, 5 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 21:59:14.207335 (MainThread): 
2022-10-06 21:59:14.207562 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:59:14.208396 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 21:59:14.215551 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:59:14.215836 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 21:59:14.215944 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 21:59:14.253249 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.04 seconds
2022-10-06 21:59:14.253714 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:59:14.253824 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 21:59:14.257052 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 21:59:14.259081 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 21:59:14.259454 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 21:59:14.262405 (MainThread): Using postgres connection "master".
2022-10-06 21:59:14.262526 (MainThread): On master: BEGIN
2022-10-06 21:59:14.262620 (MainThread): Opening a new connection, currently in state init
2022-10-06 21:59:14.270040 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:14.270162 (MainThread): Using postgres connection "master".
2022-10-06 21:59:14.270247 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 21:59:14.295835 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 21:59:14.296797 (MainThread): On master: ROLLBACK
2022-10-06 21:59:14.297037 (MainThread): On master: Close
2022-10-06 21:59:14.297271 (MainThread): 22:59:14 | Concurrency: 5 threads (target='dev')
2022-10-06 21:59:14.297384 (MainThread): 22:59:14 | 
2022-10-06 21:59:14.299347 (Thread-1): Began running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c
2022-10-06 21:59:14.299487 (Thread-2): Began running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:14.299608 (Thread-3): Began running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:14.299723 (Thread-1): 22:59:14 | 1 of 3 START test accepted_values_orders_cte_order_name__Rice__Beans. [RUN]
2022-10-06 21:59:14.299830 (Thread-2): 22:59:14 | 2 of 3 START test not_null_orders_cte_order_id....................... [RUN]
2022-10-06 21:59:14.299941 (Thread-3): 22:59:14 | 3 of 3 START test unique_orders_cte_order_id......................... [RUN]
2022-10-06 21:59:14.300624 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c".
2022-10-06 21:59:14.300848 (Thread-2): Acquiring new postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:14.301058 (Thread-3): Acquiring new postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:14.301181 (Thread-1): Compiling test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c
2022-10-06 21:59:14.301282 (Thread-2): Compiling test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:14.301401 (Thread-3): Compiling test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:14.304182 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c"
2022-10-06 21:59:14.307761 (Thread-2): Writing injected SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:59:14.312336 (Thread-3): Writing injected SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:59:14.313014 (Thread-1): finished collecting timing info
2022-10-06 21:59:14.325561 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c"
2022-10-06 21:59:14.325757 (Thread-2): finished collecting timing info
2022-10-06 21:59:14.325879 (Thread-3): finished collecting timing info
2022-10-06 21:59:14.327183 (Thread-2): Writing runtime SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:59:14.328383 (Thread-3): Writing runtime SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:59:14.328895 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c".
2022-10-06 21:59:14.329096 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c: BEGIN
2022-10-06 21:59:14.329303 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 21:59:14.329456 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:14.329836 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: BEGIN
2022-10-06 21:59:14.329933 (Thread-3): Opening a new connection, currently in state init
2022-10-06 21:59:14.330224 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:14.330326 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: BEGIN
2022-10-06 21:59:14.330415 (Thread-2): Opening a new connection, currently in state init
2022-10-06 21:59:14.339117 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:14.339237 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c".
2022-10-06 21:59:14.339338 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:14.339431 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_name as value_field,
        count(*) as n_records

    from "postgres"."public"."orders_cte"
    group by order_name

)

select *
from all_values
where value_field not in (
    'Rice','Beans'
)



      
    ) dbt_internal_test
2022-10-06 21:59:14.339514 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:14.339616 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:14.339731 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:14.339825 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."orders_cte"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-10-06 21:59:14.339915 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."public"."orders_cte"
where order_id is null



      
    ) dbt_internal_test
2022-10-06 21:59:14.342462 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:14.344048 (Thread-2): finished collecting timing info
2022-10-06 21:59:14.344299 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:14.344393 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:14.344554 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: ROLLBACK
2022-10-06 21:59:14.345482 (Thread-3): finished collecting timing info
2022-10-06 21:59:14.346199 (Thread-1): finished collecting timing info
2022-10-06 21:59:14.346362 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: ROLLBACK
2022-10-06 21:59:14.346471 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: Close
2022-10-06 21:59:14.346574 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c: ROLLBACK
2022-10-06 21:59:14.346907 (Thread-2): 22:59:14 | 2 of 3 PASS not_null_orders_cte_order_id............................. [PASS in 0.05s]
2022-10-06 21:59:14.347019 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: Close
2022-10-06 21:59:14.347133 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c: Close
2022-10-06 21:59:14.347249 (Thread-2): Finished running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:14.347461 (Thread-3): 22:59:14 | 3 of 3 PASS unique_orders_cte_order_id............................... [PASS in 0.05s]
2022-10-06 21:59:14.347660 (Thread-1): 22:59:14 | 1 of 3 FAIL 3 accepted_values_orders_cte_order_name__Rice__Beans..... [FAIL 3 in 0.05s]
2022-10-06 21:59:14.347859 (Thread-3): Finished running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:14.347976 (Thread-1): Finished running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c
2022-10-06 21:59:14.348916 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:59:14.349125 (MainThread): 22:59:14 | 
2022-10-06 21:59:14.349227 (MainThread): 22:59:14 | Finished running 3 tests in 0.14s.
2022-10-06 21:59:14.349325 (MainThread): Connection 'master' was properly closed.
2022-10-06 21:59:14.349407 (MainThread): Connection 'test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans.01d9f8c74c' was properly closed.
2022-10-06 21:59:14.349486 (MainThread): Connection 'test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135' was properly closed.
2022-10-06 21:59:14.349563 (MainThread): Connection 'test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4' was properly closed.
2022-10-06 21:59:14.352450 (MainThread): 
2022-10-06 21:59:14.352577 (MainThread): Completed with 1 error and 0 warnings:
2022-10-06 21:59:14.352678 (MainThread): 
2022-10-06 21:59:14.352779 (MainThread): Failure in test accepted_values_orders_cte_order_name__Rice__Beans (models/test.yml)
2022-10-06 21:59:14.352870 (MainThread):   Got 3 results, configured to fail if != 0
2022-10-06 21:59:14.352958 (MainThread): 
2022-10-06 21:59:14.353047 (MainThread):   compiled SQL at target/compiled/view_for_bi_guys/models/test.yml/schema_test/accepted_values_orders_cte_order_name__Rice__Beans.sql
2022-10-06 21:59:14.353147 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2022-10-06 21:59:14.353299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa53a504640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa508286e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa5081d03a0>]}
2022-10-06 21:59:14.353459 (MainThread): Flushing usage events
2022-10-06 21:59:32.503989 (MainThread): Running with dbt=0.21.1
2022-10-06 21:59:32.671522 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:59:32.674220 (MainThread): Tracking: tracking
2022-10-06 21:59:32.732731 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf923ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf92ccfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbf92cc190>]}
2022-10-06 21:59:32.748457 (MainThread): Partial parsing not enabled
2022-10-06 21:59:32.759511 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:59:32.762539 (MainThread): Parsing macros/relations.sql
2022-10-06 21:59:32.763878 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:59:32.783299 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:59:32.788540 (MainThread): Parsing macros/core.sql
2022-10-06 21:59:32.793619 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:59:32.799173 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:59:32.813210 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:59:32.814685 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:59:32.828009 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:59:32.855735 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:59:32.874091 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:59:32.875478 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:59:32.883562 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:59:32.899396 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:59:32.910078 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:59:32.917956 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:59:32.923651 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:59:32.926473 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:59:32.927550 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:59:32.928227 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:59:32.929298 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:59:32.936048 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:59:32.937392 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:59:32.939202 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:59:32.940339 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:59:32.982485 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:59:32.983744 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:59:32.984534 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:59:32.985453 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:59:33.107446 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:59:33.117673 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:59:33.120896 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:59:33.142448 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:33.143862 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:33.145128 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:33.146493 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:33.156503 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:33.156762 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:33.174381 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd9b552d-e43b-4237-984b-469546a8dd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc18a0a6d0>]}
2022-10-06 21:59:33.180767 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 21:59:33.181204 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd9b552d-e43b-4237-984b-469546a8dd47', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc18a9ad60>]}
2022-10-06 21:59:33.181394 (MainThread): Found 3 models, 5 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 21:59:33.182436 (MainThread): 
2022-10-06 21:59:33.182716 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:59:33.183577 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 21:59:33.190529 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:59:33.190731 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 21:59:33.190835 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 21:59:33.250758 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.06 seconds
2022-10-06 21:59:33.251211 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:59:33.251330 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 21:59:33.254658 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 21:59:33.256236 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 21:59:33.256475 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 21:59:33.259638 (MainThread): Using postgres connection "master".
2022-10-06 21:59:33.259824 (MainThread): On master: BEGIN
2022-10-06 21:59:33.259925 (MainThread): Opening a new connection, currently in state init
2022-10-06 21:59:33.268281 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:33.268455 (MainThread): Using postgres connection "master".
2022-10-06 21:59:33.268546 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 21:59:33.296446 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 21:59:33.297435 (MainThread): On master: ROLLBACK
2022-10-06 21:59:33.297694 (MainThread): On master: Close
2022-10-06 21:59:33.297927 (MainThread): 22:59:33 | Concurrency: 5 threads (target='dev')
2022-10-06 21:59:33.298037 (MainThread): 22:59:33 | 
2022-10-06 21:59:33.299958 (Thread-1): Began running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e
2022-10-06 21:59:33.300128 (Thread-2): Began running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:33.300255 (Thread-1): 22:59:33 | 1 of 3 START test accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma [RUN]
2022-10-06 21:59:33.300347 (Thread-3): Began running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:33.300469 (Thread-2): 22:59:33 | 2 of 3 START test not_null_orders_cte_order_id....................... [RUN]
2022-10-06 21:59:33.301508 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e".
2022-10-06 21:59:33.301660 (Thread-3): 22:59:33 | 3 of 3 START test unique_orders_cte_order_id......................... [RUN]
2022-10-06 21:59:33.301960 (Thread-2): Acquiring new postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:33.302108 (Thread-1): Compiling test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e
2022-10-06 21:59:33.302246 (Thread-2): Compiling test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:33.302471 (Thread-3): Acquiring new postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:33.306783 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e"
2022-10-06 21:59:33.310670 (Thread-2): Writing injected SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:59:33.310886 (Thread-3): Compiling test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:33.315949 (Thread-3): Writing injected SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:59:33.316355 (Thread-1): finished collecting timing info
2022-10-06 21:59:33.323246 (Thread-2): finished collecting timing info
2022-10-06 21:59:33.323405 (Thread-3): finished collecting timing info
2022-10-06 21:59:33.327873 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e"
2022-10-06 21:59:33.329399 (Thread-2): Writing runtime SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:59:33.330604 (Thread-3): Writing runtime SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:59:33.331148 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e".
2022-10-06 21:59:33.331248 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: BEGIN
2022-10-06 21:59:33.331344 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 21:59:33.331558 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:33.331666 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: BEGIN
2022-10-06 21:59:33.331758 (Thread-3): Opening a new connection, currently in state init
2022-10-06 21:59:33.331884 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:33.332085 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: BEGIN
2022-10-06 21:59:33.332173 (Thread-2): Opening a new connection, currently in state init
2022-10-06 21:59:33.339327 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:33.339471 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:33.339578 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:33.339667 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e".
2022-10-06 21:59:33.339772 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:33.339868 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:33.339964 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_name as value_field,
        count(*) as n_records

    from "postgres"."public"."orders_cte"
    group by order_name

)

select *
from all_values
where value_field not in (
    'Rice','Beans','Spag','Pizza','Shawarma'
)



      
    ) dbt_internal_test
2022-10-06 21:59:33.340059 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."public"."orders_cte"
where order_id is null



      
    ) dbt_internal_test
2022-10-06 21:59:33.340147 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."orders_cte"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-10-06 21:59:33.341300 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:33.342784 (Thread-2): finished collecting timing info
2022-10-06 21:59:33.342924 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:33.343036 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: ROLLBACK
2022-10-06 21:59:33.343118 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:33.343992 (Thread-3): finished collecting timing info
2022-10-06 21:59:33.344894 (Thread-1): finished collecting timing info
2022-10-06 21:59:33.345026 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: Close
2022-10-06 21:59:33.345180 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: ROLLBACK
2022-10-06 21:59:33.345302 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: ROLLBACK
2022-10-06 21:59:33.345705 (Thread-2): 22:59:33 | 2 of 3 PASS not_null_orders_cte_order_id............................. [PASS in 0.04s]
2022-10-06 21:59:33.345911 (Thread-2): Finished running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:33.346049 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e: Close
2022-10-06 21:59:33.346388 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: Close
2022-10-06 21:59:33.346702 (Thread-1): 22:59:33 | 1 of 3 PASS accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma [PASS in 0.05s]
2022-10-06 21:59:33.346912 (Thread-3): 22:59:33 | 3 of 3 PASS unique_orders_cte_order_id............................... [PASS in 0.04s]
2022-10-06 21:59:33.347032 (Thread-1): Finished running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e
2022-10-06 21:59:33.347163 (Thread-3): Finished running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:33.348257 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:59:33.348478 (MainThread): 22:59:33 | 
2022-10-06 21:59:33.348586 (MainThread): 22:59:33 | Finished running 3 tests in 0.17s.
2022-10-06 21:59:33.348685 (MainThread): Connection 'master' was properly closed.
2022-10-06 21:59:33.348766 (MainThread): Connection 'test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma.f1b703584e' was properly closed.
2022-10-06 21:59:33.348845 (MainThread): Connection 'test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135' was properly closed.
2022-10-06 21:59:33.348922 (MainThread): Connection 'test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4' was properly closed.
2022-10-06 21:59:33.352165 (MainThread): 
2022-10-06 21:59:33.352314 (MainThread): Completed successfully
2022-10-06 21:59:33.352426 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 21:59:33.352591 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc18acd0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbc18a9a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbbe8790ee0>]}
2022-10-06 21:59:33.352755 (MainThread): Flushing usage events
2022-10-06 21:59:42.052180 (MainThread): Running with dbt=0.21.1
2022-10-06 21:59:42.108682 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 21:59:42.115288 (MainThread): Tracking: tracking
2022-10-06 21:59:42.135293 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73a0bea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73a18b1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe73a18be20>]}
2022-10-06 21:59:42.143648 (MainThread): Partial parsing not enabled
2022-10-06 21:59:42.152311 (MainThread): Parsing macros/catalog.sql
2022-10-06 21:59:42.154990 (MainThread): Parsing macros/relations.sql
2022-10-06 21:59:42.156088 (MainThread): Parsing macros/adapters.sql
2022-10-06 21:59:42.173016 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 21:59:42.174185 (MainThread): Parsing macros/core.sql
2022-10-06 21:59:42.176728 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 21:59:42.181541 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 21:59:42.188509 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 21:59:42.189646 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 21:59:42.201619 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 21:59:42.229058 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 21:59:42.246111 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 21:59:42.247279 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 21:59:42.254727 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 21:59:42.270277 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 21:59:42.280821 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 21:59:42.286806 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 21:59:42.292361 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 21:59:42.294951 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 21:59:42.295912 (MainThread): Parsing macros/etc/query.sql
2022-10-06 21:59:42.296520 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 21:59:42.297529 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 21:59:42.303663 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 21:59:42.304861 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 21:59:42.306471 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 21:59:42.307504 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 21:59:42.349793 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 21:59:42.350889 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 21:59:42.351639 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 21:59:42.352505 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 21:59:42.464248 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 21:59:42.472431 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 21:59:42.474869 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 21:59:42.492959 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:42.494113 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:42.495227 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:42.496420 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:42.505689 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:42.505886 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 21:59:42.521197 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c3699f3-1a68-48f8-ad95-3f7a879c9f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe76860ab20>]}
2022-10-06 21:59:42.524240 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 21:59:42.524559 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c3699f3-1a68-48f8-ad95-3f7a879c9f5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe76861adc0>]}
2022-10-06 21:59:42.524716 (MainThread): Found 3 models, 5 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 21:59:42.525566 (MainThread): 
2022-10-06 21:59:42.525792 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:59:42.526821 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 21:59:42.533470 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:59:42.533642 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 21:59:42.533740 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 21:59:42.551343 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.02 seconds
2022-10-06 21:59:42.551694 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 21:59:42.551788 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 21:59:42.556723 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 21:59:42.557929 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 21:59:42.558204 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 21:59:42.561279 (MainThread): Using postgres connection "master".
2022-10-06 21:59:42.561477 (MainThread): On master: BEGIN
2022-10-06 21:59:42.561587 (MainThread): Opening a new connection, currently in state init
2022-10-06 21:59:42.570747 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:42.570873 (MainThread): Using postgres connection "master".
2022-10-06 21:59:42.570960 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 21:59:42.595957 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 21:59:42.596970 (MainThread): On master: ROLLBACK
2022-10-06 21:59:42.597233 (MainThread): On master: Close
2022-10-06 21:59:42.597505 (MainThread): 22:59:42 | Concurrency: 5 threads (target='dev')
2022-10-06 21:59:42.597631 (MainThread): 22:59:42 | 
2022-10-06 21:59:42.599704 (Thread-1): Began running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c
2022-10-06 21:59:42.599891 (Thread-2): Began running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:42.600019 (Thread-3): Began running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:42.600158 (Thread-1): 22:59:42 | 1 of 3 START test accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg [RUN]
2022-10-06 21:59:42.600293 (Thread-2): 22:59:42 | 2 of 3 START test not_null_orders_cte_order_id....................... [RUN]
2022-10-06 21:59:42.600418 (Thread-3): 22:59:42 | 3 of 3 START test unique_orders_cte_order_id......................... [RUN]
2022-10-06 21:59:42.601314 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c".
2022-10-06 21:59:42.601603 (Thread-2): Acquiring new postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:42.601855 (Thread-3): Acquiring new postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:42.602013 (Thread-1): Compiling test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c
2022-10-06 21:59:42.602146 (Thread-2): Compiling test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:42.602267 (Thread-3): Compiling test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:42.607320 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c"
2022-10-06 21:59:42.611743 (Thread-2): Writing injected SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:59:42.616357 (Thread-3): Writing injected SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:59:42.616852 (Thread-1): finished collecting timing info
2022-10-06 21:59:42.617015 (Thread-2): finished collecting timing info
2022-10-06 21:59:42.623330 (Thread-3): finished collecting timing info
2022-10-06 21:59:42.628761 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c"
2022-10-06 21:59:42.630222 (Thread-2): Writing runtime SQL for node "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"
2022-10-06 21:59:42.631206 (Thread-3): Writing runtime SQL for node "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"
2022-10-06 21:59:42.631643 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c".
2022-10-06 21:59:42.631742 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c: BEGIN
2022-10-06 21:59:42.631866 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:42.631962 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 21:59:42.632052 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:42.632142 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: BEGIN
2022-10-06 21:59:42.632329 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: BEGIN
2022-10-06 21:59:42.632427 (Thread-2): Opening a new connection, currently in state init
2022-10-06 21:59:42.632541 (Thread-3): Opening a new connection, currently in state init
2022-10-06 21:59:42.640196 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:42.640297 (Thread-3): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:42.640397 (Thread-1): Using postgres connection "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c".
2022-10-06 21:59:42.640490 (Thread-3): Using postgres connection "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4".
2022-10-06 21:59:42.640606 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        order_name as value_field,
        count(*) as n_records

    from "postgres"."public"."orders_cte"
    group by order_name

)

select *
from all_values
where value_field not in (
    'Rice','Beans','Spag','Pizza','Shawarma','Egg'
)



      
    ) dbt_internal_test
2022-10-06 21:59:42.640698 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "postgres"."public"."orders_cte"
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
2022-10-06 21:59:42.640891 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 21:59:42.640977 (Thread-2): Using postgres connection "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135".
2022-10-06 21:59:42.641050 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."public"."orders_cte"
where order_id is null



      
    ) dbt_internal_test
2022-10-06 21:59:42.643323 (Thread-3): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:42.644809 (Thread-3): finished collecting timing info
2022-10-06 21:59:42.644985 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:42.645089 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 21:59:42.645207 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: ROLLBACK
2022-10-06 21:59:42.646181 (Thread-2): finished collecting timing info
2022-10-06 21:59:42.646905 (Thread-1): finished collecting timing info
2022-10-06 21:59:42.647059 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: ROLLBACK
2022-10-06 21:59:42.647168 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c: ROLLBACK
2022-10-06 21:59:42.647273 (Thread-3): On test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4: Close
2022-10-06 21:59:42.647389 (Thread-2): On test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135: Close
2022-10-06 21:59:42.647696 (Thread-3): 22:59:42 | 3 of 3 PASS unique_orders_cte_order_id............................... [PASS in 0.05s]
2022-10-06 21:59:42.647814 (Thread-3): Finished running node test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4
2022-10-06 21:59:42.648016 (Thread-2): 22:59:42 | 2 of 3 PASS not_null_orders_cte_order_id............................. [PASS in 0.05s]
2022-10-06 21:59:42.648101 (Thread-1): On test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c: Close
2022-10-06 21:59:42.648232 (Thread-2): Finished running node test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135
2022-10-06 21:59:42.648441 (Thread-1): 22:59:42 | 1 of 3 PASS accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg [PASS in 0.05s]
2022-10-06 21:59:42.648642 (Thread-1): Finished running node test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c
2022-10-06 21:59:42.649399 (MainThread): Acquiring new postgres connection "master".
2022-10-06 21:59:42.649592 (MainThread): 22:59:42 | 
2022-10-06 21:59:42.649690 (MainThread): 22:59:42 | Finished running 3 tests in 0.12s.
2022-10-06 21:59:42.649785 (MainThread): Connection 'master' was properly closed.
2022-10-06 21:59:42.649867 (MainThread): Connection 'test.view_for_bi_guys.accepted_values_orders_cte_order_name__Rice__Beans__Spag__Pizza__Shawarma__Egg.9d305f341c' was properly closed.
2022-10-06 21:59:42.649946 (MainThread): Connection 'test.view_for_bi_guys.not_null_orders_cte_order_id.c9b0bcd135' was properly closed.
2022-10-06 21:59:42.650023 (MainThread): Connection 'test.view_for_bi_guys.unique_orders_cte_order_id.13903e5db4' was properly closed.
2022-10-06 21:59:42.653115 (MainThread): 
2022-10-06 21:59:42.653240 (MainThread): Completed successfully
2022-10-06 21:59:42.653350 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2022-10-06 21:59:42.653498 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe76861a6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe768630160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7686234f0>]}
2022-10-06 21:59:42.653654 (MainThread): Flushing usage events
2022-10-06 22:07:29.791358 (MainThread): Running with dbt=0.21.1
2022-10-06 22:07:29.868507 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['customer_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 22:07:29.871973 (MainThread): Tracking: tracking
2022-10-06 22:07:29.893660 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb832b12a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb832b1e6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb832b1ea00>]}
2022-10-06 22:07:29.902406 (MainThread): Partial parsing not enabled
2022-10-06 22:07:29.912375 (MainThread): Parsing macros/catalog.sql
2022-10-06 22:07:29.914901 (MainThread): Parsing macros/relations.sql
2022-10-06 22:07:29.915944 (MainThread): Parsing macros/adapters.sql
2022-10-06 22:07:29.931591 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 22:07:29.932711 (MainThread): Parsing macros/core.sql
2022-10-06 22:07:29.935187 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 22:07:29.939763 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 22:07:29.946393 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 22:07:29.947489 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 22:07:29.959075 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 22:07:29.983585 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 22:07:29.999524 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 22:07:30.000671 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 22:07:30.007757 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 22:07:30.022053 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 22:07:30.031945 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 22:07:30.037523 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 22:07:30.042682 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 22:07:30.045226 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 22:07:30.046192 (MainThread): Parsing macros/etc/query.sql
2022-10-06 22:07:30.046805 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 22:07:30.047814 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 22:07:30.053649 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 22:07:30.054830 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 22:07:30.056412 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 22:07:30.057428 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 22:07:30.096119 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 22:07:30.097199 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 22:07:30.097939 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 22:07:30.098784 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 22:07:30.210510 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 22:07:30.218818 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 22:07:30.221272 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 22:07:30.229597 (MainThread): Acquiring new postgres connection "test.view_for_bi_guys.test_orders_positive".
2022-10-06 22:07:30.231167 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:07:30.246783 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:07:30.247893 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:07:30.248972 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:07:30.250164 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:07:30.258863 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:07:30.259057 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:07:30.275674 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c74d10eb-6408-4f6f-94e9-80d62a7a9885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8200d9fa0>]}
2022-10-06 22:07:30.279529 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 22:07:30.280426 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c74d10eb-6408-4f6f-94e9-80d62a7a9885', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb820149c70>]}
2022-10-06 22:07:30.280598 (MainThread): Found 3 models, 6 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 22:07:30.281478 (MainThread): 
2022-10-06 22:07:30.281706 (MainThread): Acquiring new postgres connection "master".
2022-10-06 22:07:30.282721 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 22:07:30.289688 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 22:07:30.289890 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 22:07:30.289988 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 22:07:30.350852 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.06 seconds
2022-10-06 22:07:30.351404 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 22:07:30.351530 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 22:07:30.354559 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 22:07:30.356005 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 22:07:30.356303 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 22:07:30.359766 (MainThread): Using postgres connection "master".
2022-10-06 22:07:30.359901 (MainThread): On master: BEGIN
2022-10-06 22:07:30.360009 (MainThread): Opening a new connection, currently in state init
2022-10-06 22:07:30.369647 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 22:07:30.369784 (MainThread): Using postgres connection "master".
2022-10-06 22:07:30.369882 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 22:07:30.395593 (MainThread): SQL status: SELECT 3 in 0.03 seconds
2022-10-06 22:07:30.396667 (MainThread): On master: ROLLBACK
2022-10-06 22:07:30.396913 (MainThread): On master: Close
2022-10-06 22:07:30.397181 (MainThread): 23:07:30 | Concurrency: 5 threads (target='dev')
2022-10-06 22:07:30.397348 (MainThread): 23:07:30 | 
2022-10-06 22:07:30.399565 (Thread-1): Began running node test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf
2022-10-06 22:07:30.399754 (Thread-2): Began running node test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691
2022-10-06 22:07:30.399960 (Thread-1): 23:07:30 | 1 of 2 START test not_null_customer_cte_id........................... [RUN]
2022-10-06 22:07:30.400113 (Thread-2): 23:07:30 | 2 of 2 START test unique_customer_cte_id............................. [RUN]
2022-10-06 22:07:30.400428 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf".
2022-10-06 22:07:30.400837 (Thread-2): Acquiring new postgres connection "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691".
2022-10-06 22:07:30.401003 (Thread-1): Compiling test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf
2022-10-06 22:07:30.401153 (Thread-2): Compiling test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691
2022-10-06 22:07:30.406411 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf"
2022-10-06 22:07:30.410997 (Thread-2): Writing injected SQL for node "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691"
2022-10-06 22:07:30.412164 (Thread-2): finished collecting timing info
2022-10-06 22:07:30.412311 (Thread-1): finished collecting timing info
2022-10-06 22:07:30.424845 (Thread-2): Writing runtime SQL for node "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691"
2022-10-06 22:07:30.425988 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf"
2022-10-06 22:07:30.426602 (Thread-2): Using postgres connection "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691".
2022-10-06 22:07:30.426728 (Thread-1): Using postgres connection "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf".
2022-10-06 22:07:30.426825 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: BEGIN
2022-10-06 22:07:30.426922 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: BEGIN
2022-10-06 22:07:30.427016 (Thread-2): Opening a new connection, currently in state init
2022-10-06 22:07:30.427100 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 22:07:30.437400 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 22:07:30.437579 (Thread-2): SQL status: BEGIN in 0.01 seconds
2022-10-06 22:07:30.437686 (Thread-1): Using postgres connection "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf".
2022-10-06 22:07:30.437784 (Thread-2): Using postgres connection "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691".
2022-10-06 22:07:30.437878 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select *
from "postgres"."public"."customer_cte"
where id is null



      
    ) dbt_internal_test
2022-10-06 22:07:30.437972 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "postgres"."public"."customer_cte"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
2022-10-06 22:07:30.439075 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 22:07:30.439191 (Thread-2): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 22:07:30.440708 (Thread-1): finished collecting timing info
2022-10-06 22:07:30.441542 (Thread-2): finished collecting timing info
2022-10-06 22:07:30.441685 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: ROLLBACK
2022-10-06 22:07:30.441796 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: ROLLBACK
2022-10-06 22:07:30.442074 (Thread-1): On test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf: Close
2022-10-06 22:07:30.442174 (Thread-2): On test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691: Close
2022-10-06 22:07:30.442442 (Thread-1): 23:07:30 | 1 of 2 PASS not_null_customer_cte_id................................. [PASS in 0.04s]
2022-10-06 22:07:30.442651 (Thread-2): 23:07:30 | 2 of 2 PASS unique_customer_cte_id................................... [PASS in 0.04s]
2022-10-06 22:07:30.442777 (Thread-1): Finished running node test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf
2022-10-06 22:07:30.443023 (Thread-2): Finished running node test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691
2022-10-06 22:07:30.443756 (MainThread): Acquiring new postgres connection "master".
2022-10-06 22:07:30.443960 (MainThread): 23:07:30 | 
2022-10-06 22:07:30.444068 (MainThread): 23:07:30 | Finished running 2 tests in 0.16s.
2022-10-06 22:07:30.444164 (MainThread): Connection 'master' was properly closed.
2022-10-06 22:07:30.444245 (MainThread): Connection 'test.view_for_bi_guys.not_null_customer_cte_id.34f5093faf' was properly closed.
2022-10-06 22:07:30.444324 (MainThread): Connection 'test.view_for_bi_guys.unique_customer_cte_id.1f8a32b691' was properly closed.
2022-10-06 22:07:30.447412 (MainThread): 
2022-10-06 22:07:30.447536 (MainThread): Completed successfully
2022-10-06 22:07:30.447642 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2022-10-06 22:07:30.447799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb8201e8250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb820149d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb820117a00>]}
2022-10-06 22:07:30.447961 (MainThread): Flushing usage events
2022-10-06 22:08:34.468566 (MainThread): Running with dbt=0.21.1
2022-10-06 22:08:34.543829 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['customer_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 22:08:34.545824 (MainThread): Tracking: tracking
2022-10-06 22:08:34.569348 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa82cafa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa82d7b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa82d7b190>]}
2022-10-06 22:08:34.578335 (MainThread): Partial parsing not enabled
2022-10-06 22:08:34.581147 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa82d7b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa82d68070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa82d68490>]}
2022-10-06 22:08:34.581329 (MainThread): Flushing usage events
2022-10-06 22:08:35.791976 (MainThread): Encountered an error:
2022-10-06 22:08:35.792985 (MainThread): Compilation Error
  Error reading view_for_bi_guys: test.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  | #           - unique
    8  | #           - not_null
    9  | 
    10 |   - name: orders_cte
    11 |     columns: 
    12 |       - name: order_id
    13 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 10, column 3
2022-10-06 22:08:35.800375 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 1, column 1
did not find expected key
  in "<unicode string>", line 10, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 10
  ------------------------------
  7  | #           - unique
  8  | #           - not_null
  9  | 
  10 |   - name: orders_cte
  11 |     columns: 
  12 |       - name: order_id
  13 |         tests:
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 10, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading view_for_bi_guys: test.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  | #           - unique
    8  | #           - not_null
    9  | 
    10 |   - name: orders_cte
    11 |     columns: 
    12 |       - name: order_id
    13 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 10, column 3

2022-10-06 22:08:48.767707 (MainThread): Running with dbt=0.21.1
2022-10-06 22:08:48.846000 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['customer_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 22:08:48.847061 (MainThread): Tracking: tracking
2022-10-06 22:08:48.866609 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b24dda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b2495790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b24dc9d0>]}
2022-10-06 22:08:48.875066 (MainThread): Partial parsing not enabled
2022-10-06 22:08:48.878215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b249fa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b24ed280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96b24edf10>]}
2022-10-06 22:08:48.878407 (MainThread): Flushing usage events
2022-10-06 22:08:50.048466 (MainThread): Encountered an error:
2022-10-06 22:08:50.049197 (MainThread): Compilation Error
  Error reading view_for_bi_guys: test.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  | #           - unique
    8  | #           - not_null
    9  | 
    10 |   - name: orders_cte
    11 |     columns: 
    12 |       - name: order_id
    13 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 10, column 3
2022-10-06 22:08:50.055319 (MainThread): Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 65, in load_yaml_text
    return safe_load(contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 60, in safe_load
    return yaml.load(contents, Loader=SafeLoader)
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/__init__.py", line 114, in load
    return loader.get_single_data()
  File "/opt/anaconda3/lib/python3.9/site-packages/yaml/constructor.py", line 49, in get_single_data
    node = self.get_single_node()
  File "yaml/_yaml.pyx", line 707, in yaml._yaml.CParser.get_single_node
  File "yaml/_yaml.pyx", line 725, in yaml._yaml.CParser._compose_document
  File "yaml/_yaml.pyx", line 776, in yaml._yaml.CParser._compose_node
  File "yaml/_yaml.pyx", line 892, in yaml._yaml.CParser._compose_mapping_node
  File "yaml/_yaml.pyx", line 905, in yaml._yaml.CParser._parse_next_event
yaml.parser.ParserError: while parsing a block mapping
  in "<unicode string>", line 1, column 1
did not find expected key
  in "<unicode string>", line 10, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 108, in yaml_from_file
    return load_yaml_text(source_file.contents)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/clients/yaml_helper.py", line 72, in load_yaml_text
    raise dbt.exceptions.ValidationException(error)
dbt.exceptions.ValidationException: Runtime Error
  Syntax error near line 10
  ------------------------------
  7  | #           - unique
  8  | #           - not_null
  9  | 
  10 |   - name: orders_cte
  11 |     columns: 
  12 |       - name: order_id
  13 |         tests:
  
  Raw Error:
  ------------------------------
  while parsing a block mapping
    in "<unicode string>", line 1, column 1
  did not find expected key
    in "<unicode string>", line 10, column 3

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 127, in main
    results, succeeded = handle_and_check(args)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 205, in handle_and_check
    task, res = run_from_args(parsed)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/main.py", line 258, in run_from_args
    results = task.run()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 438, in run
    self._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 154, in _runtime_initialize
    super()._runtime_initialize()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 92, in _runtime_initialize
    self.load_manifest()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/task/runnable.py", line 79, in load_manifest
    self.manifest = ManifestLoader.get_full_manifest(self.config)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 182, in get_full_manifest
    manifest = loader.load()
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/manifest.py", line 210, in load
    read_files(project, self.manifest.files, project_parser_files, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 151, in read_files
    project_files['SchemaParser'] = read_files_for_parser(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 106, in read_files_for_parser
    source_files = get_source_files(
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 97, in get_source_files
    file = load_source_file(fp, parse_file_type, project.project_name, saved_files)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/read_files.py", line 37, in load_source_file
    dfy = yaml_from_file(source_file)
  File "/opt/anaconda3/lib/python3.9/site-packages/dbt/parser/schemas.py", line 111, in yaml_from_file
    raise CompilationException(
dbt.exceptions.CompilationException: Compilation Error
  Error reading view_for_bi_guys: test.yml - Runtime Error
    Syntax error near line 10
    ------------------------------
    7  | #           - unique
    8  | #           - not_null
    9  | 
    10 |   - name: orders_cte
    11 |     columns: 
    12 |       - name: order_id
    13 |         tests:
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 1, column 1
    did not find expected key
      in "<unicode string>", line 10, column 3

2022-10-06 22:11:04.250344 (MainThread): Running with dbt=0.21.1
2022-10-06 22:11:04.321036 (MainThread): running dbt with arguments Namespace(record_timing_info=None, debug=False, log_format='default', write_json=True, use_colors=None, strict=False, warn_error=False, partial_parse=None, single_threaded=False, test_new_parser=False, use_experimental_parser=False, project_dir=None, profiles_dir='/Users/OFFISONG/.dbt', profile=None, target=None, vars='{}', log_cache_events=False, use_cache=True, data=False, schema=False, fail_fast=False, store_failures=False, greedy=False, threads=None, version_check=True, select=['orders_cte'], exclude=None, selector_name=None, state=None, defer=None, cls=<class 'dbt.task.test.TestTask'>, which='test', rpc_method='test')
2022-10-06 22:11:04.322564 (MainThread): Tracking: tracking
2022-10-06 22:11:04.349525 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe76ab37a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe76aa74790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe76ab3ca30>]}
2022-10-06 22:11:04.359002 (MainThread): Partial parsing not enabled
2022-10-06 22:11:04.369172 (MainThread): Parsing macros/catalog.sql
2022-10-06 22:11:04.371838 (MainThread): Parsing macros/relations.sql
2022-10-06 22:11:04.372906 (MainThread): Parsing macros/adapters.sql
2022-10-06 22:11:04.389134 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2022-10-06 22:11:04.390288 (MainThread): Parsing macros/core.sql
2022-10-06 22:11:04.392804 (MainThread): Parsing macros/materializations/test.sql
2022-10-06 22:11:04.397510 (MainThread): Parsing macros/materializations/helpers.sql
2022-10-06 22:11:04.404318 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2022-10-06 22:11:04.405450 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2022-10-06 22:11:04.417348 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2022-10-06 22:11:04.443967 (MainThread): Parsing macros/materializations/seed/seed.sql
2022-10-06 22:11:04.460540 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2022-10-06 22:11:04.461715 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2022-10-06 22:11:04.469067 (MainThread): Parsing macros/materializations/incremental/on_schema_change.sql
2022-10-06 22:11:04.484116 (MainThread): Parsing macros/materializations/common/merge.sql
2022-10-06 22:11:04.494365 (MainThread): Parsing macros/materializations/table/table.sql
2022-10-06 22:11:04.500257 (MainThread): Parsing macros/materializations/view/view.sql
2022-10-06 22:11:04.505729 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2022-10-06 22:11:04.508297 (MainThread): Parsing macros/etc/get_custom_alias.sql
2022-10-06 22:11:04.509269 (MainThread): Parsing macros/etc/query.sql
2022-10-06 22:11:04.509888 (MainThread): Parsing macros/etc/is_incremental.sql
2022-10-06 22:11:04.510900 (MainThread): Parsing macros/etc/datetime.sql
2022-10-06 22:11:04.516903 (MainThread): Parsing macros/etc/where_subquery.sql
2022-10-06 22:11:04.518093 (MainThread): Parsing macros/etc/get_custom_schema.sql
2022-10-06 22:11:04.519693 (MainThread): Parsing macros/etc/get_custom_database.sql
2022-10-06 22:11:04.520727 (MainThread): Parsing macros/adapters/common.sql
2022-10-06 22:11:04.561173 (MainThread): Parsing macros/schema_tests/relationships.sql
2022-10-06 22:11:04.562271 (MainThread): Parsing macros/schema_tests/not_null.sql
2022-10-06 22:11:04.563023 (MainThread): Parsing macros/schema_tests/unique.sql
2022-10-06 22:11:04.563884 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2022-10-06 22:11:04.676419 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.orders_cte".
2022-10-06 22:11:04.684733 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.customer_cte".
2022-10-06 22:11:04.687199 (MainThread): Acquiring new postgres connection "model.view_for_bi_guys.referencing".
2022-10-06 22:11:04.695519 (MainThread): Acquiring new postgres connection "test.view_for_bi_guys.test_orders_positive".
2022-10-06 22:11:04.697106 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:11:04.711838 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:11:04.712941 (MainThread): 'soft_unicode' has been renamed to 'soft_str'. The old name will be removed in MarkupSafe 2.1.
2022-10-06 22:11:04.728900 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '085483d2-b440-485d-a838-d8657e910e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe76ab3c1f0>]}
2022-10-06 22:11:04.732819 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2022-10-06 22:11:04.733561 (MainThread): Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '085483d2-b440-485d-a838-d8657e910e13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7880d4340>]}
2022-10-06 22:11:04.733753 (MainThread): Found 3 models, 3 tests, 0 snapshots, 0 analyses, 162 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2022-10-06 22:11:04.734624 (MainThread): 
2022-10-06 22:11:04.734865 (MainThread): Acquiring new postgres connection "master".
2022-10-06 22:11:04.735622 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_postgres_public".
2022-10-06 22:11:04.742736 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 22:11:04.742914 (ThreadPoolExecutor-1_0): On list_postgres_public: BEGIN
2022-10-06 22:11:04.743008 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2022-10-06 22:11:04.802723 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.06 seconds
2022-10-06 22:11:04.803077 (ThreadPoolExecutor-1_0): Using postgres connection "list_postgres_public".
2022-10-06 22:11:04.803187 (ThreadPoolExecutor-1_0): On list_postgres_public: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "list_postgres_public"} */
select
      'postgres' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'postgres' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2022-10-06 22:11:04.807104 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2022-10-06 22:11:04.808540 (ThreadPoolExecutor-1_0): On list_postgres_public: ROLLBACK
2022-10-06 22:11:04.808851 (ThreadPoolExecutor-1_0): On list_postgres_public: Close
2022-10-06 22:11:04.812115 (MainThread): Using postgres connection "master".
2022-10-06 22:11:04.812256 (MainThread): On master: BEGIN
2022-10-06 22:11:04.812369 (MainThread): Opening a new connection, currently in state init
2022-10-06 22:11:04.821544 (MainThread): SQL status: BEGIN in 0.01 seconds
2022-10-06 22:11:04.821670 (MainThread): Using postgres connection "master".
2022-10-06 22:11:04.821765 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2022-10-06 22:11:04.846718 (MainThread): SQL status: SELECT 3 in 0.02 seconds
2022-10-06 22:11:04.847807 (MainThread): On master: ROLLBACK
2022-10-06 22:11:04.848058 (MainThread): On master: Close
2022-10-06 22:11:04.848327 (MainThread): 23:11:04 | Concurrency: 5 threads (target='dev')
2022-10-06 22:11:04.848476 (MainThread): 23:11:04 | 
2022-10-06 22:11:04.851381 (Thread-1): Began running node test.view_for_bi_guys.test_orders_positive
2022-10-06 22:11:04.851607 (Thread-1): 23:11:04 | 1 of 1 START test test_orders_positive............................... [RUN]
2022-10-06 22:11:04.851901 (Thread-1): Acquiring new postgres connection "test.view_for_bi_guys.test_orders_positive".
2022-10-06 22:11:04.852065 (Thread-1): Compiling test.view_for_bi_guys.test_orders_positive
2022-10-06 22:11:04.853947 (Thread-1): Writing injected SQL for node "test.view_for_bi_guys.test_orders_positive"
2022-10-06 22:11:04.854478 (Thread-1): finished collecting timing info
2022-10-06 22:11:04.867566 (Thread-1): Writing runtime SQL for node "test.view_for_bi_guys.test_orders_positive"
2022-10-06 22:11:04.868070 (Thread-1): Using postgres connection "test.view_for_bi_guys.test_orders_positive".
2022-10-06 22:11:04.868177 (Thread-1): On test.view_for_bi_guys.test_orders_positive: BEGIN
2022-10-06 22:11:04.868280 (Thread-1): Opening a new connection, currently in state closed
2022-10-06 22:11:04.879302 (Thread-1): SQL status: BEGIN in 0.01 seconds
2022-10-06 22:11:04.879512 (Thread-1): Using postgres connection "test.view_for_bi_guys.test_orders_positive".
2022-10-06 22:11:04.879613 (Thread-1): On test.view_for_bi_guys.test_orders_positive: /* {"app": "dbt", "dbt_version": "0.21.1", "profile_name": "default", "target_name": "dev", "node_id": "test.view_for_bi_guys.test_orders_positive"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with payments as (
    select * from "postgres"."public"."orders_cte"
)
select * from payments where order_price<0
      
    ) dbt_internal_test
2022-10-06 22:11:04.881243 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2022-10-06 22:11:04.882821 (Thread-1): finished collecting timing info
2022-10-06 22:11:04.882976 (Thread-1): On test.view_for_bi_guys.test_orders_positive: ROLLBACK
2022-10-06 22:11:04.883224 (Thread-1): On test.view_for_bi_guys.test_orders_positive: Close
2022-10-06 22:11:04.883515 (Thread-1): 23:11:04 | 1 of 1 PASS test_orders_positive..................................... [PASS in 0.03s]
2022-10-06 22:11:04.883643 (Thread-1): Finished running node test.view_for_bi_guys.test_orders_positive
2022-10-06 22:11:04.884412 (MainThread): Acquiring new postgres connection "master".
2022-10-06 22:11:04.884621 (MainThread): 23:11:04 | 
2022-10-06 22:11:04.884742 (MainThread): 23:11:04 | Finished running 1 test in 0.15s.
2022-10-06 22:11:04.884845 (MainThread): Connection 'master' was properly closed.
2022-10-06 22:11:04.884935 (MainThread): Connection 'test.view_for_bi_guys.test_orders_positive' was properly closed.
2022-10-06 22:11:04.888386 (MainThread): 
2022-10-06 22:11:04.888597 (MainThread): Completed successfully
2022-10-06 22:11:04.888711 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2022-10-06 22:11:04.888887 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7882343a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe788234280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7882340a0>]}
2022-10-06 22:11:04.889064 (MainThread): Flushing usage events
